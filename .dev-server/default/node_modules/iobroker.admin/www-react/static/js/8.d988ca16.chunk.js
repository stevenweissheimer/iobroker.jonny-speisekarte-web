(this["webpackJsonpsrc-rx"]=this["webpackJsonpsrc-rx"]||[]).push([[8],{1577:function(e,t,s){"use strict";s.d(t,"b",(function(){return c})),s.d(t,"a",(function(){return l}));var o=s(279),r=s(496),n=s(558),a=s.n(n),i=s(3);function c(e){var t=e.icon;return Object(i.jsxs)("div",{className:e.classes.formContainer,children:[t?Object(i.jsx)(t,{className:e.classes.formIcon}):null,Object(i.jsx)(r.a,{className:e.classes.formControl,children:Object(i.jsx)(o.a,{label:e.t(e.label),autoComplete:e.autoComplete,error:!!e.error,helperText:e.error||"",value:e.value,onChange:e.onChange,disabled:e.disabled,InputLabelProps:{readOnly:!1,shrink:!0},type:e.type})})]})}var l=function(e){var t=e.icon;return Object(i.jsxs)("div",{style:{width:"100%"},children:[t?Object(i.jsx)(t,{className:e.classes.formIcon}):null,Object(i.jsx)(a.a,{style:{width:t?"calc(100% - 45px)":"100%",display:"inline-block",verticalAlign:"top"},name:e.t(e.label),onChange:e.onChange,openAbove:!0,color:e.value||""})]})}},1608:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/user1.24fa2b07.svg"},1609:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/user2.c6b253a8.svg"},1610:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/user3.e838132e.svg"},1611:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/user4.f66996c0.svg"},1612:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/user5.842fb6e5.svg"},1613:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/user6.f1589fc9.svg"},1614:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/user7.773f25cf.svg"},1615:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/user8.43bbbecc.svg"},1616:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/user9.2a94bc8f.svg"},1617:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/user10.7b8712e8.svg"},1618:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/user11.dfec7022.svg"},1619:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/user12.67a70d90.svg"},1625:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/group1.e4d9dfc6.svg"},1626:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/group2.005a7b0a.svg"},1627:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/group3.ee5e28d2.svg"},1628:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/group4.d6b392ff.svg"},1629:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/group5.68fdb9e9.svg"},1630:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/group6.c7f286d1.svg"},1631:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/group7.066f78d6.svg"},1632:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/group8.25d573e5.svg"},1633:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/group9.b7aae7b7.svg"},1634:function(e,t,s){"use strict";s.r(t),t.default=s.p+"static/media/group10.250fd49c.svg"},1686:function(e,t,s){"use strict";var o=s(19),r=s(25);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(s(0)),a=(0,o(s(27)).default)(n.createElement("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"}),"Group");t.default=a},1687:function(e,t,s){var o={"./Anteroom.svg":1688,"./Attic.svg":1689,"./Balcony.svg":1690,"./Barn.svg":1691,"./Basement.svg":1692,"./Bathroom.svg":1693,"./Bedroom.svg":1694,"./Boiler Room.svg":1695,"./Carport.svg":1696,"./Cellar.svg":1697,"./Chamber.svg":1698,"./Corridor.svg":1699,"./Dining Area.svg":1700,"./Dining Room.svg":1701,"./Dining.svg":1702,"./Dressing Room.svg":1703,"./Driveway.svg":1704,"./Entrance.svg":1705,"./Equipment Room.svg":1706,"./Front Yard.svg":1707,"./Gallery.svg":1708,"./Garage.svg":1709,"./Garden.svg":1710,"./Ground Floor.svg":1711,"./Guest Bathroom.svg":1712,"./Guest Room.svg":1713,"./Gym.svg":1714,"./Hall.svg":1715,"./Home Theater.svg":1716,"./Kitchen.svg":1717,"./Laundry Room.svg":1718,"./Living Area.svg":1719,"./Living Room.svg":1720,"./Locker Room.svg":1721,"./Nursery.svg":1722,"./Office.svg":1723,"./Outdoors.svg":1724,"./Playroom.svg":1725,"./Pool.svg":1726,"./Rear Wall.svg":1727,"./Second Floor.svg":1728,"./Shed.svg":1729,"./Sleeping Area.svg":1730,"./Stairway.svg":1731,"./Stairwell.svg":1732,"./Storeroom.svg":1733,"./Summer House.svg":1734,"./Swimming Pool.svg":1735,"./Terrace.svg":1736,"./Toilet.svg":1737,"./Upstairs.svg":1738,"./Wardrobe.svg":1739,"./Washroom.svg":1740,"./Wc.svg":1741,"./Windscreen.svg":1742,"./Workshop.svg":1743,"./Workspace.svg":1744,"./list":1560,"./list.json":1560,"./names.txt":1745,"./parseNames":1575,"./parseNames.d.ts":1746,"./parseNames.js":1575};function r(e){var t=n(e);return s(t)}function n(e){if(!s.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=n,e.exports=r,r.id=1687},1747:function(e,t,s){var o={"./Alarm Systems.svg":1748,"./Amplifier.svg":1749,"./Awnings.svg":1750,"./Battery Status.svg":1751,"./Ceiling Spotlights.svg":1752,"./Chandelier.svg":1753,"./Climate.svg":1754,"./Coffee Makers.svg":1755,"./Cold Water.svg":1756,"./Computer.svg":1757,"./Consumption.svg":1758,"./Curtains.svg":1759,"./Dishwashers.svg":1760,"./Doors.svg":1761,"./Doorstep.svg":1762,"./Dryer.svg":1763,"./Fan.svg":1764,"./Floor Lamps.svg":1765,"./Garage Doors.svg":1766,"./Gates.svg":1767,"./Hairdryer.svg":1768,"./Handle.svg":1769,"./Hanging Lamps.svg":1770,"./Heater.svg":1771,"./Hoods.svg":1772,"./Hot Water.svg":1773,"./Humidity.svg":1774,"./Iron.svg":1775,"./Irrigation.svg":1776,"./Led Strip.svg":1777,"./Light.svg":1778,"./Lightings.svg":1779,"./Lock.svg":1780,"./Louvre.svg":1781,"./Mowing Machine.svg":1782,"./Music.svg":1783,"./Outdoor Blinds.svg":1784,"./People.svg":1785,"./Pool.svg":1786,"./Power Consumption.svg":1787,"./Printer.svg":1788,"./Pump.svg":1789,"./Receiver.svg":1790,"./Sconces.svg":1791,"./Security.svg":1792,"./Shading.svg":1793,"./Shutters.svg":1794,"./SmokeDetector.svg":1795,"./Sockets.svg":1796,"./Speaker.svg":1797,"./Stove.svg":1798,"./Table Lamps.svg":1799,"./Temperature Sensors.svg":1800,"./Tv.svg":1801,"./Vacuum Cleaner.svg":1802,"./Ventilation.svg":1803,"./Washing Machines.svg":1804,"./Water Consumption.svg":1805,"./Water Heater.svg":1806,"./Water.svg":1807,"./Weather.svg":1808,"./Window.svg":1809,"./list":1559,"./list.json":1559,"./names.txt":1810,"./parseNames":1576,"./parseNames.d.ts":1811,"./parseNames.js":1576};function r(e){var t=n(e);return s(t)}function n(e){if(!s.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=n,e.exports=r,r.id=1747},1864:function(e,t,s){"use strict";var o=s(19),r=s(25);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(s(0)),a=(0,o(s(27)).default)(n.createElement("path",{d:"M12.65 10C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H17v4h4v-4h2v-4H12.65zM7 14c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"}),"VpnKey");t.default=a},1865:function(e,t,s){"use strict";var o=s(19),r=s(25);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(s(0)),a=(0,o(s(27)).default)(n.createElement("path",{d:"M8 10H5V7H3v3H0v2h3v3h2v-3h3v-2zm10 1c1.66 0 2.99-1.34 2.99-3S19.66 5 18 5c-.32 0-.63.05-.91.14.57.81.9 1.79.9 2.86s-.34 2.04-.9 2.86c.28.09.59.14.91.14zm-5 0c1.66 0 2.99-1.34 2.99-3S14.66 5 13 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm6.62 2.16c.83.73 1.38 1.66 1.38 2.84v2h3v-2c0-1.54-2.37-2.49-4.38-2.84zM13 13c-2 0-6 1-6 3v2h12v-2c0-2-4-3-6-3z"}),"GroupAdd");t.default=a},1866:function(e,t,s){"use strict";var o=s(19),r=s(25);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(s(0)),a=(0,o(s(27)).default)(n.createElement("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"PersonAdd");t.default=a},2016:function(e,t,s){"use strict";s.r(t);var o=s(17),r=s(11),n=s(12),a=s(14),i=s(15),c=s(0),l=s(8),u=s(6),d=s(1489),m=s(428),p=s(562),g=s(1828),v=s(747),h=s(92),j=s(80),f=s(633),b=s(1866),O=s.n(b),x=s(1865),w=s.n(x),C=s(26),D=s(1497),N=s(609),y=s(1473),_=s(1474),k=s(181),S=s(677),G=s(560),E=s.n(G),U=s(1686),W=s.n(U),I=s(1539),P=s.n(I),R=s(426),F=s.n(R),T=s(185),M=s.n(T),H=s(78),L=s.n(H),z=s(60),B=s.n(z),A=s(3);function J(e){var t=e.isDragging?0:1,s=B.a.getInvertedColor(e.user.common.color,e.themeType,!0),o={cursor:"grab",opacity:t,overflow:"hidden",color:s};return e.user.common.color&&(o.backgroundColor=e.user.common.color),Object(A.jsx)(y.a,{style:o,className:e.classes.userGroupCard2,children:Object(A.jsxs)("div",{className:e.classes.userCardContent,children:[Object(A.jsxs)("div",{className:e.classes.right,children:[Object(A.jsx)(S.a,{checked:e.user.common.enabled,style:{color:s},disabled:e.user.common.dontDelete,onChange:function(t){e.socket.extendObject(e.user._id,{common:{enabled:!e.user.common.enabled}}).then((function(){return e.updateData()}))}}),Object(A.jsx)(k.a,{size:"small",onClick:function(){return e.showUserEditDialog(e.user,!1)},children:Object(A.jsx)(F.a,{style:{color:s}})}),Object(A.jsx)(k.a,{size:"small",onClick:function(){return e.showUserDeleteDialog(e.user)},disabled:e.user.common.dontDelete,children:Object(A.jsx)(M.a,{style:e.user.common.dontDelete?null:{color:s}})})]}),Object(A.jsxs)(_.a,{children:[Object(A.jsxs)(j.a,{gutterBottom:!0,component:"div",className:e.classes.userGroupTitle,children:[e.user.common.icon?Object(A.jsx)(L.a,{className:e.classes.icon,src:e.user.common.icon}):Object(A.jsx)(E.a,{className:e.classes.icon}),Object(A.jsxs)("div",{children:[Object(A.jsxs)("div",{children:[Object(A.jsx)("span",{className:e.classes.userGroupUserName,children:e.getName(e.user.common.name)}),Object(A.jsx)("span",{className:e.classes.userGroupUserID,children:e.getName(e.user._id)})]}),Object(A.jsx)("span",{children:e.user.common.desc?Object(A.jsx)("div",{className:e.classes.userName,children:e.user.common.desc}):null})]})]}),e.groups.find((function(t){return t.common.members&&t.common.members.includes(e.user._id)}))?Object(A.jsxs)("div",{children:[e.t("In groups"),":"]}):null,Object(A.jsx)("div",{children:e.groups.map((function(t){var o,r;if(!t.common.members||!t.common.members.includes(e.user._id))return null;var n=t&&(null===(o=t.common)||void 0===o?void 0:o.color)?B.a.getInvertedColor(t.common.color,e.themeType,!0):s;return Object(A.jsxs)(y.a,{variant:"outlined",className:e.classes.userGroupMember,style:{color:n,borderColor:n+"80",background:(null===(r=t.common)||void 0===r?void 0:r.color)||"inherit"},children:[t.common.icon?Object(A.jsx)(L.a,{className:e.classes.icon,src:t.common.icon}):Object(A.jsx)(W.a,{className:e.classes.icon}),e.getName(t.common.name),Object(A.jsx)(k.a,{size:"small",onClick:function(){return e.removeUserFromGroup(e.user._id,t._id)},children:Object(A.jsx)(P.a,{style:{color:n}})})]},t._id)}))})]})]})})}var q=function(e){var t=Object(c.useRef)(),s=Object(D.a)({type:"user",item:function(){return{userId:e.user._id,preview:Object(A.jsx)("div",{style:{width:t.current.offsetWidth},children:Object(A.jsx)(J,Object(o.a)({},e))})}},end:function(t,s){var o=s.getDropResult();t&&o&&e.addUserToGroup(t.userId,o.groupId)},collect:function(e){return{isDragging:e.isDragging(),handlerId:e.getHandlerId()}}}),r=Object(C.a)(s,3),n=r[0].isDragging,a=r[1],i=r[2];return Object(c.useEffect)((function(){i(Object(N.a)(),{captureDraggingState:!0})}),[]),Object(A.jsx)("div",{ref:a,children:Object(A.jsx)("div",{ref:t,children:Object(A.jsx)(J,Object(o.a)({isDragging:n,widthRef:t},e))})})},V=s(1496);var Y=function(e){var t,s=Object(V.a)((function(){return{accept:"user",drop:function(){return{groupId:e.group._id}},canDrop:function(t,s){return function(e,t){return!t.group.common.members||!t.group.common.members.includes(e.getItem().userId)}(s,e)},collect:function(e,t){return{isOver:e.isOver(),CanDrop:e.canDrop()}}}}),[e.group.common.members]),o=Object(C.a)(s,2),r=o[0],n=r.CanDrop,a=r.isOver,i=r.isCanDrop,c=o[1],l=.7,d="";n&&a?(l=i?1:.125,d=e.classes.userGroupCardSecondary):n&&(l=i?.75:.25);var m=B.a.getInvertedColor(e.group.common.color,e.themeType,!0),p={opacity:l,overflow:"hidden",color:m};return e.group.common.color&&(p.backgroundColor=e.group.common.color),Object(A.jsxs)(y.a,{style:p,ref:c,className:Object(u.default)(e.classes.userGroupCard2,d),children:[Object(A.jsxs)("div",{className:e.classes.right,children:[Object(A.jsx)(k.a,{size:"small",onClick:function(){return e.showGroupEditDialog(e.group,!1)},children:Object(A.jsx)(F.a,{style:{color:m}})}),Object(A.jsx)(k.a,{size:"small",onClick:function(){return e.showGroupDeleteDialog(e.group)},disabled:e.group.common.dontDelete,children:Object(A.jsx)(M.a,{style:e.group.common.dontDelete?null:{color:m}})})]}),Object(A.jsxs)(_.a,{children:[Object(A.jsxs)(j.a,{gutterBottom:!0,component:"div",className:e.classes.userGroupTitle,children:[e.group.common.icon?Object(A.jsx)(L.a,{className:e.classes.icon,src:e.group.common.icon}):Object(A.jsx)(W.a,{className:e.classes.icon}),Object(A.jsxs)("div",{children:[Object(A.jsxs)("div",{children:[Object(A.jsx)("span",{className:e.classes.userGroupUserName,children:e.getName(e.group.common.name)}),Object(A.jsx)("span",{children:e.getName(e.group._id)})]}),""!==e.group.common.desc?Object(A.jsx)("span",{children:e.group.common.desc}):null]})]}),(null===(t=e.group.common.members)||void 0===t?void 0:t.length)?Object(A.jsxs)("div",{children:[e.t("Group members"),":"]}):null,Object(A.jsx)("div",{children:(e.group.common.members||[]).map((function(t,s){var o,r,n=e.users.find((function(e){return e._id===t})),a=n&&(null===(o=n.common)||void 0===o?void 0:o.color)?B.a.getInvertedColor(n.common.color,e.themeType,!0):m;return n?Object(A.jsxs)(y.a,{variant:"outlined",className:e.classes.userGroupMember,style:{color:a,borderColor:a+"40",background:(null===(r=n.common)||void 0===r?void 0:r.color)||"inherit"},children:[n.common.icon?Object(A.jsx)(L.a,{className:e.classes.icon,src:n.common.icon}):Object(A.jsx)(E.a,{className:e.classes.icon}),e.getName(n.common.name),Object(A.jsx)(k.a,{size:"small",onClick:function(){return e.removeUserFromGroup(t,e.group._id)},children:Object(A.jsx)(P.a,{style:{color:a}})})]},s):null}))})]})]})};var K=s(226),X=s(277),Q=s(228),Z=s(227),$=s(113),ee=s(1620),te=s.n(ee),se=s(522),oe=s.n(se),re=s(1621),ne=s.n(re),ae=s(1622),ie=s.n(ae),ce=s(1864),le=s.n(ce),ue=s(1624),de=s.n(ue),me=s(1623),pe=s.n(me),ge=s(48),ve=s.n(ge),he=s(53),je=s.n(he),fe=s(1607),be=s.n(fe),Oe=s(1577),xe=s(1608),we=s(1609),Ce=s(1610),De=s(1611),Ne=s(1612),ye=s(1613),_e=s(1614),ke=s(1615),Se=s(1616),Ge=s(1617),Ee=s(1618),Ue=s(1619),We=[xe.default,we.default,Ce.default,De.default,Ne.default,ye.default,_e.default,ke.default,Se.default,Ge.default,Ee.default,Ue.default];var Ie=Object(l.a)((function(e){return{contentRoot:{padding:"16px 24px"}}}))((function(e){var t=Object(c.useState)(null),s=Object(C.a)(t,2),o=s[0],r=s[1];if(Object(c.useEffect)((function(){if(r(e.user._id),e.isNew){var t=We[Math.round(Math.random()*(We.length-1))];t&&B.a.getSvg(t).then((function(t){var s=B.a.clone(e.user);s.common.icon=t,e.onChange(s)}))}}),[e.open]),!e.open)return null;var n=e.users.find((function(t){return t._id===e.user._id})),a=e.user._id!==o,i="system.user."!==e.user._id&&e.user.common.password===e.user.common.passwordRepeat&&e.user.common.password;(e.isNew&&n||n&&a)&&(i=!1);var l=function(t){return t&&"object"===typeof t?t[e.lang]||t.en:t||""},d=function(e){return e.replace(B.a.FORBIDDEN_CHARS,"_").replace(/\s/g,"_").replace(/\./g,"_").toLowerCase()},m=function(e,t){var s=e.split(".");return s[s.length-1]=t,s.join(".")},p=l(e.user.common.desc),g=l(e.user.common.name);return Object(A.jsxs)(K.a,{fullWidth:e.innerWidth<500,open:e.open,onClose:e.onClose,disableEscapeKeyDown:!0,disableBackdropClick:!0,children:[Object(A.jsx)(X.a,{className:e.classes.dialogTitle,style:{padding:12},children:e.t("User parameters")}),Object(A.jsx)(Q.a,{classes:{root:Object(u.default)(e.innerWidth<500&&e.classes.narrowContent,e.classes.contentRoot)},children:Object(A.jsxs)(h.a,{container:!0,spacing:e.innerWidth<500?1:4,className:e.classes.dialog,children:[Object(A.jsx)(h.a,{item:!0,xs:12,md:6,children:Object(A.jsx)(Oe.b,{label:"Name",t:e.t,value:g,onChange:function(t){var s=B.a.clone(e.user);e.user.common.dontDelete||d(s.common.name)!==s._id.split(".").pop()||(s._id=m(s._id,d(t.target.value))),s.common.name=t.target.value,e.onChange(s)},autoComplete:"new-password",icon:te.a,classes:e.classes})}),Object(A.jsx)(h.a,{item:!0,xs:12,md:6,children:Object(A.jsx)(Oe.b,{label:"ID edit",t:e.t,disabled:e.user.common.dontDelete,value:e.user._id.split(".")[e.user._id.split(".").length-1],onChange:function(t){var s=B.a.clone(e.user);s._id=m(s._id,d(t.target.value)),e.onChange(s)},icon:ne.a,classes:e.classes})}),Object(A.jsx)(h.a,{item:!0,xs:12,md:6,children:Object(A.jsx)(Oe.b,{label:"ID preview",t:e.t,disabled:!0,value:e.user._id,icon:ie.a,classes:e.classes})}),Object(A.jsx)(h.a,{item:!0,xs:12,md:6,children:Object(A.jsx)(Oe.b,{label:"Description",t:e.t,value:p,onChange:function(t){var s=B.a.clone(e.user);s.common.desc=t.target.value,e.onChange(s)},icon:oe.a,classes:e.classes})}),Object(A.jsx)(h.a,{item:!0,xs:12,md:6,children:Object(A.jsx)(Oe.b,{label:"Password",t:e.t,value:e.user.common.password,error:e.user.common.passwordRepeat!==e.user.common.password?e.t("Repeat password is not equal with password"):(e.user.common.password||"").trim()?"":e.t("Empty password is not allowed"),onChange:function(t){var s=B.a.clone(e.user);s.common.password=t.target.value,e.onChange(s)},type:"password",autoComplete:"new-password",icon:le.a,classes:e.classes})}),Object(A.jsx)(h.a,{item:!0,xs:12,md:6,children:Object(A.jsx)(Oe.b,{label:"Password repeat",t:e.t,value:e.user.common.passwordRepeat,error:e.user.common.passwordRepeat!==e.user.common.password?e.t("Repeat password is not equal with password"):"",onChange:function(t){var s=B.a.clone(e.user);s.common.passwordRepeat=t.target.value,e.onChange(s)},type:"password",autoComplete:"new-password",icon:le.a,classes:e.classes})}),Object(A.jsx)(h.a,{item:!0,xs:12,md:6,children:Object(A.jsx)(be.a,{icons:We,label:"Icon",t:e.t,lang:e.lang,value:e.user.common.icon,onChange:function(t){var s=B.a.clone(e.user);s.common.icon=t,e.onChange(s)},previewClassName:e.classes.iconPreview,icon:pe.a,classes:e.classes})}),Object(A.jsx)(h.a,{item:!0,xs:12,md:6,children:Object(A.jsx)(Oe.a,{label:"Color",t:e.t,value:e.user.common.color,previewClassName:e.classes.iconPreview,onChange:function(t){var s=B.a.clone(e.user);s.common.color=t,e.onChange(s)},icon:de.a,className:e.classes.colorPicker,classes:e.classes})})]})}),Object(A.jsxs)(Z.a,{className:e.classes.dialogActions,children:[Object(A.jsx)($.a,{variant:"contained",color:"primary",autoFocus:!0,onClick:function(){return e.saveData(e.isNew?null:o)},disabled:!i,startIcon:Object(A.jsx)(je.a,{}),children:e.t("Save")}),Object(A.jsx)($.a,{variant:"contained",onClick:e.onClose,startIcon:Object(A.jsx)(ve.a,{}),children:e.t("Cancel")})]})]})})),Pe=s(607),Re=s(676),Fe=s(635),Te=s(1625),Me=s(1626),He=s(1627),Le=s(1628),ze=s(1629),Be=s(1630),Ae=s(1631),Je=s(1632),qe=s(1633),Ve=s(1634),Ye=[Te.default,Me.default,He.default,Le.default,ze.default,Be.default,Ae.default,Je.default,qe.default,Ve.default];function Ke(e){var t=function(e,t){return Object.values(e).map((function(s,o){var r=Object.keys(e)[o];return t(s,r)}))},s=e.group.common.acl;return(s=s||{}).object=s.object||{read:!0,list:!0,write:!0,delete:!1},s.object=Object.assign({},{read:!0,list:!0,write:!0,delete:!1},s.object),s.state=s.state||{read:!0,list:!0,write:!0,delete:!1},s.state=Object.assign({},{read:!0,list:!0,write:!0,delete:!1},s.state),s.users=s.users||{write:!1,delete:!1,create:!1},s.users=Object.assign({},{write:!1,delete:!1,create:!1},s.users),s.other=s.other||{http:!1,execute:!1,sendto:!0},s.other=Object.assign({},{http:!1,execute:!1,sendto:!0},s.other),s.file=s.file||{read:!0,list:!0,write:!1,delete:!1,create:!1},s.file=Object.assign({},{read:!0,list:!0,write:!1,delete:!1,create:!1},s.file),Object(A.jsx)(h.a,{container:!0,spacing:e.innerWidth<500?1:4,className:e.classes.dialog,children:t(e.group.common.acl||{},(function(s,o){return Object(A.jsxs)(h.a,{item:!0,xs:12,md:12,children:[Object(A.jsx)("h2",{className:e.classes.permHeaders,children:e.t("group_acl_"+o)}),t(s,(function(t,s){return Object(A.jsx)(Pe.a,{control:Object(A.jsx)(S.a,{disabled:"system.group.administrator"===e.group._id,checked:t,onChange:function(t){var r=B.a.clone(e.group);r.common.acl[o][s]=t.target.checked,e.onChange(r)}}),label:e.t("group_acl_"+s),labelPlacement:"top"},s)}))]},o)}))},"PermissionsTab")}var Xe=Object(l.a)((function(e){return{contentRoot:{padding:"16px 24px"}}}))((function(e){var t=Object(c.useState)(0),s=Object(C.a)(t,2),o=s[0],r=s[1],n=Object(c.useState)(null),a=Object(C.a)(n,2),i=a[0],l=a[1];if(Object(c.useEffect)((function(){if(l(e.group._id),e.isNew){var t=Ye[Math.round(Math.random()*(Ye.length-1))];t&&B.a.getSvg(t).then((function(t){var s=B.a.clone(e.group);s.common.icon=t,e.onChange(s)}))}}),[e.open]),!e.open)return null;var d=e.groups.find((function(t){return t._id===e.group._id})),m=e.group._id!==i,p="system.group."!==e.group._id&&e.group.common.password===e.group.common.passwordRepeat,g=function(t){return t&&"object"===typeof t?t[e.lang]||t.en:t||""},v=function(e){return e.replace(B.a.FORBIDDEN_CHARS,"_").replace(/\s/g,"_").replace(/\./g,"_").toLowerCase()},j=function(e,t){var s=e.split(".");return s[s.length-1]=t,s.join(".")};e.isNew?d&&(p=!1):d&&m&&(p=!1);var f=g(e.group.common.description),b=g(e.group.common.name),O=[Object(A.jsxs)(h.a,{container:!0,spacing:e.innerWidth<500?1:4,className:e.classes.dialog,children:[Object(A.jsx)(h.a,{item:!0,xs:12,md:6,children:Object(A.jsx)(Oe.b,{label:"Name",t:e.t,value:b,onChange:function(t){var s=B.a.clone(e.group);e.group.common.dontDelete||v(s.common.name)!==s._id.split(".").pop()||(s._id=j(s._id,v(t.target.value))),s.common.name=t.target.value,e.onChange(s)},autoComplete:"off",icon:te.a,classes:e.classes})}),Object(A.jsx)(h.a,{item:!0,xs:12,md:6,children:Object(A.jsx)(Oe.b,{label:"ID edit",t:e.t,disabled:e.group.common.dontDelete,value:e.group._id.split(".")[e.group._id.split(".").length-1],onChange:function(t){var s=B.a.clone(e.group);s._id=j(s._id,v(t.target.value)),e.onChange(s)},icon:ne.a,classes:e.classes})}),Object(A.jsx)(h.a,{item:!0,xs:12,md:6,children:Object(A.jsx)(Oe.b,{label:"ID preview",t:e.t,disabled:!0,value:e.group._id,icon:ie.a,classes:e.classes})}),Object(A.jsx)(h.a,{item:!0,xs:12,md:6,children:Object(A.jsx)(Oe.b,{label:"Description",t:e.t,value:f,onChange:function(t){var s=B.a.clone(e.group);s.common.description=t.target.value,e.onChange(s)},icon:oe.a,classes:e.classes})}),Object(A.jsx)(h.a,{item:!0,xs:12,md:6,children:Object(A.jsx)(be.a,{label:"Icon",icons:Ye,t:e.t,lang:e.lang,value:e.group.common.icon,onChange:function(t){var s=B.a.clone(e.group);s.common.icon=t,e.onChange(s)},previewClassName:e.classes.iconPreview,icon:pe.a,classes:e.classes})}),Object(A.jsx)(h.a,{item:!0,xs:12,md:6,children:Object(A.jsx)(Oe.a,{label:"Color",t:e.t,value:e.group.common.color,previewClassName:e.classes.iconPreview,onChange:function(t){var s=B.a.clone(e.group);s.common.color=t,e.onChange(s)},icon:de.a,className:e.classes.colorPicker,classes:e.classes})})]}),Ke(e)][o];return Object(A.jsxs)(K.a,{open:e.open,onClose:e.onClose,fullWidth:e.innerWidth<500,disableEscapeKeyDown:!0,disableBackdropClick:!0,children:[Object(A.jsx)(X.a,{className:e.classes.dialogTitle,children:Object(A.jsxs)(Re.a,{variant:"fullWidth",value:o,onChange:function(e,t){return r(t)},children:[Object(A.jsx)(Fe.a,{label:e.t("Main"),value:0}),Object(A.jsx)(Fe.a,{label:e.t("Permissions"),value:1})]})}),Object(A.jsx)(Q.a,{classes:{root:Object(u.default)(e.innerWidth<500?e.classes.narrowContent:"",e.classes.contentRoot)},children:O}),Object(A.jsxs)(Z.a,{className:e.classes.dialogActions,children:[Object(A.jsx)($.a,{variant:"contained",color:"primary",autoFocus:!0,onClick:function(){return e.saveData(e.isNew?null:i)},disabled:!p,startIcon:Object(A.jsx)(je.a,{}),children:e.t("Save")}),Object(A.jsx)($.a,{variant:"contained",onClick:e.onClose,startIcon:Object(A.jsx)(ve.a,{}),children:e.t("Cancel")})]})]})})),Qe=s(490);var Ze=function(e){return e.open?Object(A.jsxs)(K.a,{open:e.open,onClose:e.onClose,children:[Object(A.jsx)(X.a,{children:e.t("Please confirm")}),Object(A.jsx)(Q.a,{children:Object(A.jsx)(Qe.a,{children:e.t("Do you want to delete user %s?",e.user.common.name)})}),Object(A.jsxs)(Z.a,{children:[Object(A.jsx)($.a,{variant:"contained",color:"primary",onClick:function(){return e.deleteUser(e.user._id)},startIcon:Object(A.jsx)(M.a,{}),children:e.t("Delete")}),Object(A.jsx)($.a,{variant:"contained",autoFocus:!0,onClick:e.onClose,startIcon:Object(A.jsx)(ve.a,{}),children:e.t("Cancel")})]})]}):null};var $e=function(e){return e.open?Object(A.jsxs)(K.a,{open:e.open,onClose:e.onClose,children:[Object(A.jsx)(X.a,{children:e.t("Please confirm")}),Object(A.jsx)(Q.a,{children:Object(A.jsx)(Qe.a,{children:e.t("Do you want to delete group %s?",e.group.common.name)})}),Object(A.jsxs)(Z.a,{className:e.classes.dialogActions,children:[Object(A.jsx)($.a,{variant:"contained",color:"primary",onClick:function(){return e.deleteGroup(e.group._id)},startIcon:Object(A.jsx)(M.a,{}),children:e.t("Delete")}),Object(A.jsx)($.a,{variant:"contained",autoFocus:!0,onClick:e.onClose,startIcon:Object(A.jsx)(ve.a,{}),children:e.t("Cancel")})]})]}):null},et="***********",tt=function(){var e=Object(g.a)(),t=e.display,s=e.item,o=e.style;return t?Object(A.jsx)("div",{style:o,children:s.preview}):null};var st={type:"user",common:{name:"",password:"",dontDelete:!1,enabled:!0,color:!1,desc:""},native:{},enums:{}},ot={type:"group",common:{name:"",description:"",members:[],dontDelete:!1,acl:{object:{list:!1,read:!1,write:!1,delete:!1},state:{list:!1,read:!1,write:!1,create:!1,delete:!1},users:{list:!1,read:!1,write:!1,create:!1,delete:!1},other:{execute:!1,http:!1,sendto:!1},file:{list:!1,read:!1,write:!1,create:!1,delete:!1}},icon:"",color:!1,desc:""}},rt=function(e){Object(a.a)(s,e);var t=Object(i.a)(s);function s(e){var o;return Object(r.a)(this,s),(o=t.call(this,e)).getName=function(e){return e&&"object"===typeof e?e[o.props.lang]||e.en||"":e||""},o.showUserEditDialog=function(e,t){(e=JSON.parse(JSON.stringify(e))).common.password=e.common.password?et:"",e.common.passwordRepeat=e.common.password,o.setState({userEditDialog:e,userEditDialogNew:t})},o.showGroupEditDialog=function(e,t){e=JSON.parse(JSON.stringify(e)),o.setState({groupEditDialog:e,groupEditDialogNew:t})},o.updateData=function(){var e;return o.props.socket.getForeignObjects("system.user.*","user").then((function(t){return e=Object.values(t).sort((function(e,t){return e._id>t._id?1:-1})),o.props.socket.getForeignObjects("system.group.*","group")})).then((function(t){t=Object.values(t).sort((function(e,t){return e._id>t._id?1:-1})),o.setState({groups:t,users:e})}))},o.changeUserFormData=function(e){return o.setState({userEditDialog:e})},o.changeGroupFormData=function(e){return o.setState({groupEditDialog:e})},o.saveUser=function(e){var t=JSON.parse(JSON.stringify(o.state.userEditDialog)),s=o.state.users.find((function(e){return e._id===t._id})),r=t.common.password&&t.common.password!==et?t.common.password:"";t.common.password=s?s.common.password:"",delete t.common.passwordRepeat,o.props.socket.setObject(t._id,t).then((function(){if(e&&e!==o.state.userEditDialog._id)return o.props.socket.delObject(e).then((function(){return Promise.all(o.state.groups.map((function(s){if(s.common.members.includes(e)){var r=JSON.parse(JSON.stringify(s));return r.common.members[r.common.members.indexOf(e)]=t._id,o.props.socket.setObject(r._id,r)}return Promise.resolve(null)})))})).catch((function(e){return window.alert("Cannot delete user: "+e)}))})).then((function(){if(r)return o.props.socket.changePassword(t._id,r).catch((function(e){return window.alert("Cannot change password: "+e)}))})).then((function(){return o.setState({userEditDialog:!1},(function(){return o.updateData()}))}))},o.saveGroup=function(e){o.props.socket.setObject(o.state.groupEditDialog._id,o.state.groupEditDialog).then((function(){if(e&&e!==o.state.groupEditDialog._id)return o.props.socket.delObject(e).catch((function(e){return window.alert("Cannot delete user: "+e)}))})).then((function(){return o.setState({groupEditDialog:!1},(function(){return o.updateData()}))}))},o.showUserDeleteDialog=function(e){return o.setState({userDeleteDialog:e})},o.showGroupDeleteDialog=function(e){return o.setState({groupDeleteDialog:e})},o.deleteUser=function(e){o.props.socket.delObject(e).then((function(){return Promise.all(o.state.groups.map((function(t){if(t.common.members.includes(e)){var s=JSON.parse(JSON.stringify(t));return s.common.members.splice(s.common.members.indexOf(e),1),o.props.socket.setObject(s._id,s)}return Promise.resolve(null)})))})).catch((function(e){return window.alert("Cannot delete user: "+e)})).then((function(){o.setState({userDeleteDialog:!1},(function(){return o.updateData()}))}))},o.deleteGroup=function(e){return o.props.socket.delObject(e).then((function(){return o.setState({groupDeleteDialog:!1},(function(){return o.updateData()}))})).catch((function(e){return window.alert("Cannot delete user: "+e)}))},o.addUserToGroup=function(e,t){var s=o.state.groups.find((function(e){return e._id===t})),r=s.common.members;r.includes(e)||(r.push(e),o.props.socket.setObject(s._id,s).then((function(){return o.updateData()})).catch((function(e){return window.alert("Cannot delete user: "+e)})))},o.removeUserFromGroup=function(e,t){var s=o.state.groups.find((function(e){return e._id===t})),r=s.common.members;r.includes(e)&&(r.splice(r.indexOf(e),1),o.props.socket.setObject(s._id,s).then((function(){return o.updateData()})))},o.state={users:null,groups:null,userEditDialog:!1,userEditDialogNew:null,groupEditDialog:!1,groupEditDialogNew:null,userDeleteDialog:!1,groupDeleteDialog:!1},o}return Object(n.a)(s,[{key:"componentDidMount",value:function(){var e=this;this.setState({innerWidth:window.innerWidth},(function(){return e.updateData()}))}},{key:"componentDidUpdate",value:function(e,t,s){var o=this;!window.innerWidth!==this.state.innerWidth&&setTimeout((function(){return o.setState({innerWidth:window.innerWidth})}),100)}},{key:"render",value:function(){var e=this;return this.state.users&&this.state.groups?Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)(d.a,{backend:"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?p.a:m.a,children:[Object(A.jsx)(tt,{}),Object(A.jsx)("div",{className:this.props.classes.descriptionPanel,children:this.props.t("You can drag users to groups.")}),Object(A.jsxs)(h.a,{container:!0,spacing:2,className:this.props.classes.mainGridCont,children:[Object(A.jsxs)(h.a,{item:!0,xs:12,md:6,className:Object(u.default)(this.props.classes.childGridCont,this.state.innerWidth>600&&this.props.classes.childGridContWide),children:[Object(A.jsxs)("div",{className:this.props.classes.headContainer,children:[Object(A.jsx)(f.a,{size:"small",className:this.props.classes.right,onClick:function(){var t=s.findNewUniqueName(!0,e.state.groups,e.props.t("Group")),o=t._id,r=t.name,n=JSON.parse(JSON.stringify(ot));n._id=o,n.common.name=r,e.showGroupEditDialog(n,!0)},children:Object(A.jsx)(w.a,{})}),Object(A.jsx)(j.a,{gutterBottom:!0,variant:"h4",component:"h4",children:this.props.t("Groups")})]}),Object(A.jsx)("div",{className:this.props.classes.blocksContainer,children:this.state.groups.sort((function(t,s){var o,r,n=(e.getName(null===t||void 0===t||null===(o=t.common)||void 0===o?void 0:o.name)||t._id).toLowerCase(),a=(e.getName(null===s||void 0===s||null===(r=s.common)||void 0===r?void 0:r.name)||s._id).toLowerCase();return n>a?1:n<a?-1:0})).map((function(t){return Object(A.jsx)(Y,Object(o.a)({themeType:e.props.themeType,group:t,users:e.state.users,showGroupEditDialog:e.showGroupEditDialog,showGroupDeleteDialog:e.showGroupDeleteDialog,removeUserFromGroup:e.removeUserFromGroup,getName:e.getName},e.props),t._id)}))})]}),Object(A.jsxs)(h.a,{item:!0,xs:12,md:6,className:Object(u.default)(this.props.classes.childGridCont,this.state.innerWidth>600&&this.props.classes.childGridContWide),children:[Object(A.jsxs)("div",{className:this.props.classes.headContainer,children:[Object(A.jsx)(f.a,{size:"small",className:this.props.classes.right,onClick:function(){var t=s.findNewUniqueName(!1,e.state.users,e.props.t("User")),o=t._id,r=t.name,n=JSON.parse(JSON.stringify(st));n._id=o,n.common.name=r,e.showUserEditDialog(n,!0)},children:Object(A.jsx)(O.a,{})}),Object(A.jsx)(j.a,{gutterBottom:!0,variant:"h4",component:"h4",children:this.props.t("Users")})]}),Object(A.jsx)("div",{className:this.props.classes.blocksContainer,children:this.state.users.sort((function(t,s){var o,r,n=(e.getName(null===t||void 0===t||null===(o=t.common)||void 0===o?void 0:o.name)||t._id).toLowerCase(),a=(e.getName(null===s||void 0===s||null===(r=s.common)||void 0===r?void 0:r.name)||s._id).toLowerCase();return n>a?1:n<a?-1:0})).map((function(t){return Object(A.jsx)(q,Object(o.a)({themeType:e.props.themeType,user:t,groups:e.state.groups,showUserEditDialog:e.showUserEditDialog,showUserDeleteDialog:e.showUserDeleteDialog,updateData:e.updateData,addUserToGroup:e.addUserToGroup,removeUserFromGroup:e.removeUserFromGroup,getName:e.getName},e.props),t._id)}))})]})]}),this.state.userEditDialog?Object(A.jsx)(Ie,{open:!0,onClose:function(){return e.setState({userEditDialog:!1})},users:this.state.users,user:this.state.userEditDialog,isNew:this.state.userEditDialogNew,t:this.props.t,lang:this.props.lang,classes:this.props.classes,onChange:this.changeUserFormData,saveData:this.saveUser,innerWidth:this.state.innerWidth}):null,this.state.groupEditDialog?Object(A.jsx)(Xe,{open:!0,onClose:function(){return e.setState({groupEditDialog:!1})},groups:this.state.groups,group:this.state.groupEditDialog,isNew:this.state.groupEditDialogNew,t:this.props.t,lang:this.props.lang,classes:this.props.classes,onChange:this.changeGroupFormData,innerWidth:this.state.innerWidth,saveData:this.saveGroup}):null,this.state.userDeleteDialog?Object(A.jsx)(Ze,{open:!0,onClose:function(){return e.setState({userDeleteDialog:!1})},user:this.state.userDeleteDialog,t:this.props.t,classes:this.props.classes,deleteUser:this.deleteUser}):null,this.state.groupDeleteDialog?Object(A.jsx)($e,{open:!0,onClose:function(){return e.setState({groupDeleteDialog:!1})},group:this.state.groupDeleteDialog,t:this.props.t,classes:this.props.classes,deleteGroup:this.deleteGroup}):null]})}):Object(A.jsx)(v.a,{})}}],[{key:"_isUniqueName",value:function(e,t,s){return!e.find((function(e){return e._id==="system.user."+t.toLowerCase()+"_"+s||e.common.name===t+" "+s}))}},{key:"findNewUniqueName",value:function(e,t,o){for(var r=1;!s._isUniqueName(t,o,r);)r++;return{_id:"system.".concat(e?"group":"user",".").concat(o.toLowerCase(),"_").concat(r),name:o+" "+r}}}]),s}(c.Component),nt=Object(l.a)((function(e){return{mainGridCont:{height:"calc(100% - 55px)",overflowY:"auto"},childGridCont:{display:"flex",flexDirection:"column"},childGridContWide:{height:"100%"},canDrop:{backgroundColor:e.palette.background.default},headContainer:{margin:10},blocksContainer:{overflowY:"auto",overflowX:"hidden"},userGroupCard2:{border:"1px solid #FFF",borderColor:e.palette.divider,margin:10,minHeight:150,backgroundColor:e.palette.background.default,color:e.palette.text.primary,transition:"all 200ms ease-out",opacity:1,overflow:"hidden","&:hover":{overflowY:"auto",boxShadow:"0 1px 1px 0 rgba(0, 0, 0, .4),0 6px 6px 0 rgba(0, 0, 0, .2)"}},userGroupCardSecondary:{color:e.palette.text.primary,backgroundColor:e.palette.success.light},permHeaders:{backgroundColor:"dark"===e.palette.type?e.palette.background.default:e.palette.primary.main,padding:4,borderRadius:2,color:"#EEE"},userCardContent:{height:"100%",opacity:1},userGroupTitle:{display:"inline-flex",alignItems:"center"},userGroupUserName:{fontWeight:900,padding:5},userGroupUserID:{opacity:.7,padding:5},userName:{fontSize:12,fontWeight:700,marginLeft:30,opacity:.7},userGroupMember:{display:"inline-flex",margin:4,padding:4,backgroundColor:"#00000010",border:"1px solid #FFF",borderColor:e.palette.text.hint,color:e.palette.text.primary,alignItems:"center"},icon:{height:32,width:32,marginRight:5,backgroundSize:"cover",backgroundPosition:"center"},right:{float:"right"},left:{float:"left",marginRight:10},dialog:{},flex:{display:"flex"},formControl:{display:"flex",padding:24,flexGrow:1e3},formContainer:{display:"flex",justifyContent:"center",alignItems:"center"},formIcon:{margin:10,opacity:.6},descriptionPanel:{width:"100%",backgroundColor:"transparent",marginBottom:20,marginTop:20,marginLeft:20,opacity:.75,border:"none",display:"flex",alignItems:"center","& a":{paddingLeft:3,color:"dark"===e.palette.type?"#EEE":"#111"}},dialogTitle:{borderBottom:"1px solid #00000020",padding:0,width:"100%"},dialogActions:{borderTop:"1px solid #00000020",width:"100%"},dialogPaper:{overflowY:"initial",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"calc(100% - 100px)",height:"calc(100% - 100px)",maxWidth:800,maxHeight:"100%"},dialogPaperMini:{maxHeight:300},colorPicker:{},iconPreview:{height:40,width:40},mainDescription:{fontSize:"200%"},deleteDialog:{padding:20},narrowContent:{padding:"8px 8px 8px 8px"}}}))(rt),at=s(427),it=s(521),ct=function(e){Object(a.a)(s,e);var t=Object(i.a)(s);function s(){return Object(r.a)(this,s),t.apply(this,arguments)}return Object(n.a)(s,[{key:"render",value:function(){return Object(A.jsx)(at.a,{children:Object(A.jsx)(it.a,{style:{display:"flex",flexDirection:"column",overflow:"auto"},children:Object(A.jsx)(nt,Object(o.a)({},this.props))})})}}]),s}(c.Component);t.default=ct}}]);
//# sourceMappingURL=8.d988ca16.chunk.js.map
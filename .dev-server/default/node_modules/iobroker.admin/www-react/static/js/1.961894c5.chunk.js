(this["webpackJsonpsrc-rx"]=this["webpackJsonpsrc-rx"]||[]).push([[1],{1548:function(t,e,n){"use strict";var a=n(19),s=n(25);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s(n(0)),r=(0,a(n(27)).default)(o.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save");e.default=r},1639:function(t,e,n){"use strict";var a=n(17),s=n(11),o=n(12),r=n(14),i=n(15),c=n(0),p=n(8),l=n(747),d=n(9),u=n.n(d),h=n(4),f=n.n(h),m=n(676),g=n(635),b=n(16),v=n(532),j=n(3),O=function(t){Object(r.a)(n,t);var e=Object(i.a)(n);function n(t){var a;Object(s.a)(this,n),a=e.call(this,t);var o=window.localStorage.getItem((a.props.dialogName||"App")+"."+a.props.adapterName)||Object.keys(a.props.schema.items)[0];return Object.keys(a.props.schema.items).includes(o)||(o=Object.keys(a.props.schema.items)[0]),a.state={tab:o},a}return Object(o.a)(n,[{key:"render",value:function(){var t=this,e=this.props.schema.items;return Object(j.jsxs)("div",{className:this.props.classes.tabs,children:[Object(j.jsx)(m.a,{value:this.state.tab,onChange:function(e,n){window.localStorage.setItem((t.props.dialogName||"App")+"."+t.props.adapterName,n),t.setState({tab:n})},children:Object.keys(e).map((function(n){var a=t.execute(e[n].disabled,!1);return Object(j.jsx)(g.a,{wrapped:!0,disabled:a,value:n,label:t.getText(e[n].label)},n)}))}),Object(j.jsx)(v.a,{isParentTab:!0,onCommandRunning:this.props.onCommandRunning,commandRunning:this.props.commandRunning,className:this.props.classes.panel,socket:this.props.socket,adapterName:this.props.adapterName,instance:this.props.instance,common:this.props.common,customs:this.props.customs,alive:this.props.alive,themeType:this.props.themeType,themeName:this.props.themeName,data:this.props.data,originalData:this.props.originalData,systemConfig:this.props.systemConfig,onError:this.props.onError,onChange:this.props.onChange,multiEdit:this.props.multiEdit,forceUpdate:this.props.forceUpdate,registerOnForceUpdate:this.props.registerOnForceUpdate,customObj:this.props.customObj,instanceObj:this.props.instanceObj,custom:this.props.custom,schema:e[this.state.tab]},this.state.tab)]})}}]),n}(b.a);O.propTypes={socket:f.a.object.isRequired,themeType:f.a.string,themeName:f.a.string,style:f.a.object,className:f.a.string,data:f.a.object.isRequired,originalData:f.a.object,schema:f.a.object,onError:f.a.func,onChange:f.a.func,customs:f.a.object,adapterName:f.a.string,instance:f.a.number,commandRunning:f.a.bool,onCommandRunning:f.a.func,dateFormat:f.a.string,isFloatComma:f.a.bool,multiEdit:f.a.bool,customObj:f.a.object,instanceObj:f.a.object,custom:f.a.bool,registerOnForceUpdate:f.a.func.isRequired,forceUpdate:f.a.func.isRequired,systemConfig:f.a.object,alive:f.a.bool,common:f.a.object};var y=Object(p.a)((function(t){return{tabs:{height:"100%",width:"100%"},panel:{height:"calc(100% - 48px)",width:"100%",display:"block"}}}))(O);u.a.extendTranslations=u.a.extendTranslations||function(t,e){try{e?(u.a.translations[e]||console.warn("Used unknown language: ".concat(e)),u.a.translations[e]=u.a.translations[e]||{},Object.keys(t).forEach((function(n){u.a.translations[e][n]?u.a.translations[e][n]!==t[n]&&console.warn('Translation for word "'.concat(n,'" in "').concat(e,'" was ignored: existing = "').concat(u.a.translations[e][n],'", new = ').concat(t[n])):u.a.translations[e][n]=t[n]}))):Object.keys(t).forEach((function(e){Object.keys(t[e]).forEach((function(n){u.a.translations[n]||console.warn("Used unknown language: ".concat(n)),u.a.translations[n][e]?u.a.translations[n][e]!==t[e][n]&&console.warn('Translation for word "'.concat(e,'" in "').concat(n,'" was ignored: existing = "').concat(u.a.translations[n][e],'", new = ').concat(t[e][n])):u.a.translations[n][e]=t[e][n]}))}))}catch(n){console.error("Cannot apply translations: ".concat(n))}};var C=function(t){Object(r.a)(n,t);var e=Object(i.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).onCommandRunning=function(t){return a.setState({commandRunning:t})},a.onAlive=function(t,e){((null===e||void 0===e?void 0:e.val)||!1)!==a.state.alive&&a.setState({alive:(null===e||void 0===e?void 0:e.val)||!1})},a.onChange=function(t,e,n){if(a.props.onValueChange)a.props.onValueChange(t,e),n&&n();else{var s={data:t},o={};Object.keys(t).forEach((function(e){return!e.startsWith("_")&&(o[e]=t[e])})),s.changed=JSON.stringify(o)!==a.state.originalData,a.setState({state:s},(function(){a.props.onChange(o,s.changed),n&&n()}))}},a.onError=function(t,e){var n=JSON.parse(JSON.stringify(a.state.errors));e?n[t]=e:delete n[t],JSON.stringify(n)!==JSON.parse(JSON.stringify(a.state.errors))&&a.setState({errors:n},(function(){return a.props.onError(!!Object.keys(a.state.errors).length)}))},a.forceUpdate=function(t,e){Array.isArray(t)?t.forEach((function(t){return a.forceUpdateHandlers[t]&&a.forceUpdateHandlers[t](e)})):a.forceUpdateHandlers[t]&&a.forceUpdateHandlers[t](e)},a.registerOnForceUpdate=function(t,e){e?a.forceUpdateHandlers[t]=e:a.forceUpdateHandlers[t]&&delete a.forceUpdateHandlers[t]},a.state={originalData:JSON.stringify(a.props.data),changed:!1,errors:{},updateData:a.props.updateData,systemConfig:null,alive:!1,commandRunning:!1},a.forceUpdateHandlers={},a.schema=JSON.parse(JSON.stringify(a.props.schema)),a.buildDependencies(a.schema),a.readData(),a}return Object(o.a)(n,[{key:"readSettings",value:function(){var t=this;return(this.props.custom||this.props.common)&&this.props.data?Promise.resolve():this.props.socket.getObject("system.adapter.".concat(this.props.adapterName,".").concat(this.props.instance)).then((function(e){return t.setState({common:e.common,data:t.props.data||e.native})}))}},{key:"readData",value:function(){var t=this;this.readSettings().then((function(){return t.props.socket.getCompactSystemConfig()})).then((function(e){return t.props.socket.getState("system.adapter.".concat(t.props.adapterName,".").concat(t.props.instance,".alive")).then((function(n){t.props.custom?t.setState({systemConfig:e.common,alive:!(!n||!n.val)}):t.setState({systemConfig:e.common,alive:!(!n||!n.val)},(function(){return t.props.socket.subscribeState("system.adapter.".concat(t.props.adapterName,".").concat(t.props.instance,".alive"),t.onAlive)}))}))}))}},{key:"flatten",value:function(t,e){var n=this;return e=e||{},t.items&&Object.keys(t.items).forEach((function(a){e[a]=t.items[a],n.flatten(t.items[a],e)})),e}},{key:"buildDependencies",value:function(t){var e=this.flatten(t);Object.keys(e).forEach((function(t){var n,s,o,r,i,c,p,l,d,u;(null===(n=e[t].confirm)||void 0===n?void 0:n.alsoDependsOn)&&(null===(c=e[t].confirm)||void 0===c||c.alsoDependsOn.forEach((function(n){if(e[n]){e[n].confirmDependsOn=e[n].confirmDependsOn||[];var s=Object(a.a)(Object(a.a)({},e[t]),{},{attr:t});s.confirm&&(s.confirm.cancel="Undo"),e[n].confirmDependsOn.push(s)}else console.error("[JsonConfigComponent] Attribute ".concat(n," does not exist!")),n.startsWith("data.")&&console.warn('[JsonConfigComponent] please use "'.concat(n.replace(/^data\./,""),'" instead of "').concat(n,'"'))})));(null===(s=e[t].onChange)||void 0===s?void 0:s.alsoDependsOn)&&(null===(p=e[t].onChange)||void 0===p||p.alsoDependsOn.forEach((function(n){if(e[n]){e[n].onChangeDependsOn=e[n].onChangeDependsOn||[];var s=Object(a.a)(Object(a.a)({},e[t]),{},{attr:t});e[n].onChangeDependsOn.push(s)}else console.error("[JsonConfigComponent] Attribute ".concat(n," does not exist!")),n.startsWith("data.")&&console.warn('[JsonConfigComponent] please use "'.concat(n.replace(/^data\./,""),'" instead of "').concat(n,'"'))})));(null===(o=e[t].hidden)||void 0===o?void 0:o.alsoDependsOn)&&(null===(l=e[t].hidden)||void 0===l||l.alsoDependsOn.forEach((function(n){if(e[n]){e[n].hiddenDependsOn=e[n].hiddenDependsOn||[];var s=Object(a.a)(Object(a.a)({},e[t]),{},{attr:t});e[n].hiddenDependsOn.push(s)}else console.error("[JsonConfigComponent] Attribute ".concat(n," does not exist!")),n.startsWith("data.")&&console.warn('[JsonConfigComponent] please use "'.concat(n.replace(/^data\./,""),'" instead of "').concat(n,'"'))})));(null===(r=e[t].label)||void 0===r?void 0:r.alsoDependsOn)&&(null===(d=e[t].label)||void 0===d||d.alsoDependsOn.forEach((function(n){if(e[n]){e[n].labelDependsOn=e[n].labelDependsOn||[];var s=Object(a.a)(Object(a.a)({},e[t]),{},{attr:t});e[n].labelDependsOn.push(s)}else console.error("[JsonConfigComponent] Attribute ".concat(n," does not exist!")),n.startsWith("data.")&&console.warn('[JsonConfigComponent] please use "'.concat(n.replace(/^data\./,""),'" instead of "').concat(n,'"'))})));(null===(i=e[t].help)||void 0===i?void 0:i.alsoDependsOn)&&(null===(u=e[t].help)||void 0===u||u.alsoDependsOn.forEach((function(n){if(e[n]){e[n].helpDependsOn=e[n].helpDependsOn||[];var s=Object(a.a)(Object(a.a)({},e[t]),{},{attr:t});e[n].helpDependsOn.push(s)}else console.error("[JsonConfigComponent] Attribute ".concat(n," does not exist!")),n.startsWith("data.")&&console.warn('[JsonConfigComponent] please use "'.concat(n.replace(/^data\./,""),'" instead of "').concat(n,'"'))})))}))}},{key:"renderItem",value:function(t){var e=this;return"tabs"===t.type?Object(j.jsx)(y,{onCommandRunning:this.onCommandRunning,commandRunning:this.state.commandRunning,socket:this.props.socket,adapterName:this.props.adapterName,instance:this.props.instance,common:this.props.common,alive:this.state.alive,themeType:this.props.themeType,themeName:this.props.themeName,data:this.props.data,originalData:JSON.parse(this.state.originalData),schema:t,systemConfig:this.state.systemConfig,customs:this.props.customs,dateFormat:this.props.dateFormat,isFloatComma:this.props.isFloatComma,multiEdit:this.props.multiEdit,custom:this.props.custom,customObj:this.props.customObj,instanceObj:this.props.instanceObj,forceUpdate:this.forceUpdate,registerOnForceUpdate:this.registerOnForceUpdate,onChange:this.onChange,onError:function(t,n){return e.onError(t,n)}}):"panel"!==t.type&&t.type?void 0:Object(j.jsx)(v.a,{isParentTab:!0,onCommandRunning:this.onCommandRunning,commandRunning:this.state.commandRunning,socket:this.props.socket,adapterName:this.props.adapterName,instance:this.props.instance,common:this.props.common,alive:this.state.alive,themeType:this.props.themeType,themeName:this.props.themeName,data:this.props.data,originalData:JSON.parse(this.state.originalData),schema:t,systemConfig:this.state.systemConfig,customs:this.props.customs,dateFormat:this.props.dateFormat,isFloatComma:this.props.isFloatComma,multiEdit:this.props.multiEdit,forceUpdate:this.forceUpdate,registerOnForceUpdate:this.registerOnForceUpdate,custom:this.props.custom,customObj:this.props.customObj,instanceObj:this.props.instanceObj,onChange:this.onChange,onError:function(t,n){return e.onError(t,n)}})}},{key:"render",value:function(){return this.state.systemConfig?Object(j.jsx)("div",{className:this.props.classes.root,children:this.renderItem(this.schema)}):Object(j.jsx)(l.a,{})}}],[{key:"getDerivedStateFromProps",value:function(t,e){return JSON.stringify(t.updateData)!==JSON.stringify(e.updateData)?{updateData:t.updateData,originalData:JSON.stringify(t.data)}:null}},{key:"loadI18n",value:function(t,e,n){if(!0===e||e&&"string"===typeof e){var a=u.a.getLanguage(),s="string"===typeof e?e:"i18n";return t.fileExists(n+".admin","".concat(s,"/").concat(a,".json")).then((function(e){return e?"".concat(s,"/").concat(a,".json"):t.fileExists(n+".admin","".concat(s,"/").concat(a,"/translations.json")).then((function(t){return t?"".concat(s,"/").concat(a,"/translations.json"):""}))})).then((function(e){return e?t.readFile(n+".admin",e).then((function(t){try{t=JSON.parse(t),u.a.extendTranslations(t,a)}catch(s){console.error('Cannot parse language file "'.concat(n,".admin/").concat(e,": ").concat(s))}})):(console.warn("Cannot find i18n for ".concat(n," / ").concat(e)),Promise.resolve())}))}return e&&"object"===typeof e?(u.a.extendTranslations(e),Promise.resolve()):Promise.resolve()}}]),n}(c.Component);e.a=Object(p.a)((function(t){return{root:{width:"100%",height:"100%"}}}))(C)},168:function(t,e,n){"use strict";n.r(e);var a=n(758);n.d(e,"default",(function(){return a.a}))},1829:function(t,e,n){"use strict";var a=n(11),s=n(12),o=n(14),r=n(15),i=n(0),c=n.n(i),p=n(8),l=n(631),d=n(153),u=n(633),h=n(758),f=n(80),m=n(278),g=n(79),b=n.n(g),v=n(78),j=n.n(v),O=n(380),y=n.n(O),C=n(29),w=n.n(C),x=n(49),k=n(4),N=n.n(k),S=n(747),E=n(292),D=n.n(E),R=n(1835),F=n.n(R),I=n(121),T=n.n(I),J=n(145),U=n.n(J),A=n(9),_=n.n(A),P=n(1639),H=n(81),z=n(47),B=n(40),W=n(1469),L=n(1471),q=n(1467),M=n(1478),V=n(1470),Y=n(1468),G=n(677),K=n(16),Q=n(3),X=function(t){Object(o.a)(n,t);var e=Object(r.a)(n);function n(){return Object(a.a)(this,n),e.apply(this,arguments)}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(z.a)(Object(B.a)(n.prototype),"componentDidMount",this).call(this),this.props.socket.getAdapterInstances().then((function(e){e=e.filter((function(t){var e;return(null===t||void 0===t||null===(e=t.common)||void 0===e?void 0:e.adminUI)&&("none"!==t.common.adminUI.config||t.common.adminUI.tab)})).map((function(t){return{id:t._id.replace(/^system\.adapter\./,""),config:"none"!==t.common.adminUI.config,adminTab:t.common.adminTab}})).sort((function(t,e){return t.id>e.id?1:t.id<e.id?-1:0})),t.setState({instances:e})}))}},{key:"renderItem",value:function(t,e,n){var a=this;if(this.state.instances){var s=K.a.getValue(this.props.data,"accessAllowedConfigs")||[],o=K.a.getValue(this.props.data,"accessAllowedTabs")||[];return Object(Q.jsx)(M.a,{children:Object(Q.jsxs)(W.a,{className:this.props.classes.table,size:"small",children:[Object(Q.jsx)(V.a,{children:Object(Q.jsxs)(Y.a,{children:[Object(Q.jsx)(q.a,{className:this.props.classes.header,children:_.a.t("Instance")}),Object(Q.jsx)(q.a,{className:this.props.classes.header,children:_.a.t("Config")}),Object(Q.jsx)(q.a,{className:this.props.classes.header,children:_.a.t("Tab")})]})}),Object(Q.jsx)(L.a,{children:this.state.instances.map((function(t){return Object(Q.jsxs)(Y.a,{children:[Object(Q.jsx)(q.a,{component:"th",scope:"row",children:t.id}),Object(Q.jsx)(q.a,{children:t.config?Object(Q.jsx)(G.a,{checked:s.includes(t.id),onClick:function(){var e=Object(H.a)(s),n=e.indexOf(t.id);-1!==n?e.splice(n,1):(e.push(t.id),e.sort()),a.onChange("accessAllowedConfigs",e)}}):null}),Object(Q.jsx)(q.a,{children:t.adminTab?Object(Q.jsx)(G.a,{checked:o.includes(t.id),onClick:function(){var e=Object(H.a)(o),n=e.indexOf(t.id);-1!==n?e.splice(n,1):(e.push(t.id),e.sort()),a.onChange("accessAllowedTabs",e)}}):null})]},t.id)}))})]})})}return null}}]),n}(K.a);X.propTypes={socket:N.a.object.isRequired,themeType:N.a.string,themeName:N.a.string,style:N.a.object,className:N.a.string,data:N.a.object.isRequired,schema:N.a.object,onError:N.a.func,onChange:N.a.func};var Z=Object(p.a)((function(t){return{table:{minWidth:400},header:{fontSize:16,fontWeight:"bold"}}}))(X),$=n(161);function tt(t,e){for(var n="",a=0;a<e.length;a++)n+=String.fromCharCode(t[a%t.length].charCodeAt(0)^e.charCodeAt(a));return n}var et=function(t){Object(o.a)(n,t);var e=Object(r.a)(n);function n(t){var s;return Object(a.a)(this,n),(s=e.call(this,t)).handleFileSelect=function(t){var e=t.target.files[0];if(e){var n=new FileReader;n.onload=function(){var t=Object(x.a)(w.a.mark((function t(e){var n,a;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.target.result;try{a=JSON.parse(n),s.setState({data:a})}catch(o){window.alert(_.a.t("[JsonConfig] Failed to parse JSON file"))}case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),n.readAsText(e)}else window.alert(_.a.t("[JsonConfig] Failed to open JSON File"))},s.componentDidUpdate=function(t,e){e.changed!==s.state.changed&&s.props.configStored(!s.state.changed)},s.state={schema:null,data:null,updateData:0,common:null,changed:!1,confirmDialog:!1,theme:T()(t.themeName)},s.getInstanceObject().then((function(t){return s.getConfigFile().then((function(e){return P.a.loadI18n(s.props.socket,null===e||void 0===e?void 0:e.i18n,s.props.adapterName).then((function(){t?s.setState({schema:e,data:t.native,common:t.common}):window.alert("Instance system.adapter.".concat(s.props.adapterName,".").concat(s.props.instance," not found!"))}))}))})),s}return Object(s.a)(n,[{key:"getExportImportButtons",value:function(){var t=this;return Object(Q.jsxs)("div",{className:this.props.classes.exportImportButtons,children:[Object(Q.jsx)(m.a,{title:this.props.t("Import settings from JSON file"),children:Object(Q.jsx)(u.a,{size:"small",classes:{root:this.props.classes.button},onClick:function(){var e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("id","files"),e.setAttribute("opacity",0),e.addEventListener("change",(function(e){return t.handleFileSelect(e)}),!1),e.click()},children:Object(Q.jsx)(D.a,{})})}),Object(Q.jsx)(m.a,{title:this.props.t("Export setting to JSON file"),children:Object(Q.jsx)(u.a,{size:"small",classes:{root:this.props.classes.button},onClick:function(){$.a.generateFile(t.props.adapterName+"."+t.props.instance+".json",t.state.data)},children:Object(Q.jsx)(D.a,{style:{transform:"rotate(180deg)"}})})})]})}},{key:"getConfigFile",value:function(){return this.props.socket.readFile(this.props.adapterName+".admin","jsonConfig.json").then((function(t){try{return JSON.parse(t)}catch(e){window.alert("[JsonConfig] Cannot parse json config!")}})).catch((function(t){return window.alert("[JsonConfig] Cannot read file: "+t)}))}},{key:"getInstanceObject",value:function(){var t=this;return this.props.socket.getObject("system.adapter.".concat(this.props.adapterName,".").concat(this.props.instance)).then((function(e){return Array.isArray(e.encryptedNative)?t.props.socket.getSystemConfig().then((function(n){return t.secret=n.native.secret,e.encryptedNative.forEach((function(n){e.native[n]&&(e.native[n]=function(t,e){for(var n="",a=0;a<e.length;a++)n+=String.fromCharCode(t[a%t.length].charCodeAt(0)^e.charCodeAt(a));return n}(t.secret,e.native[n]))})),e})):e})).catch((function(t){return window.alert("[JsonConfig] Cannot read instance object: "+t)}))}},{key:"renderConfirmDialog",value:function(){var t=this;return this.state.confirmDialog?Object(Q.jsx)(U.a,{title:_.a.t("Please confirm"),text:_.a.t("Some data are not stored. Discard?"),ok:_.a.t("Discard"),cancel:_.a.t("Cancel"),onClose:function(e){return t.setState({confirmDialog:!1},(function(){return e&&b.a.doNavigate(null)}))}}):null}},{key:"findAttr",value:function(t,e){if((e=e||this.state.schema).items){if(e.items[t])return e.items[t];for(var n=Object.keys(e.items),a=0;a<n.length;a++){var s=this.findAttr(t,e.items[n[a]]);if(s)return s}}}},{key:"onSave",value:function(){var t=Object(x.a)(w.a.mark((function t(e,n){var a,s=this;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=21;break}return t.next=3,this.getInstanceObject();case 3:if(a=t.sent){t.next=8;break}return console.error("Something went wrong: may be no connection?"),window.alert("Something went wrong: may be no connection?"),t.abrupt("return");case 8:return Object.keys(this.state.data).forEach((function(t){var e=s.findAttr(t);e&&e.doNotSave?K.a.setValue(a.native,t,null):K.a.setValue(a.native,t,s.state.data[t])})),t.prev=9,Array.isArray(a.encryptedNative)&&a.encryptedNative.forEach((function(t){a.native[t]&&(a.native[t]=tt(s.secret,a.native[t]))})),t.next=13,this.props.socket.setObject(a._id,a);case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(9),window.alert("[JsonConfig] Cannot set object: ".concat(t.t0));case 18:this.setState({changed:!1,data:a.native,updateData:this.state.updateData+1,originalData:JSON.parse(JSON.stringify(a.native))},(function(){return n&&b.a.doNavigate(null)})),t.next=26;break;case 21:if(!this.state.changed){t.next=25;break}return t.abrupt("return",this.setState({confirmDialog:!0}));case 25:b.a.doNavigate(null);case 26:case"end":return t.stop()}}),t,this,[[9,15]])})));return function(e,n){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this,e=this.props.classes;return this.state.data&&this.state.schema?Object(Q.jsxs)("div",{className:this.props.classes.root,children:[this.renderConfirmDialog(),this.getExportImportButtons(),Object(Q.jsx)(P.a,{className:e.scroll,socket:this.props.socket,theme:this.props.theme,themeName:this.props.themeName,themeType:this.props.themeType,adapterName:this.props.adapterName,instance:this.props.instance,isFloatComma:this.props.isFloatComma,dateFormat:this.props.dateFormat,schema:this.state.schema,common:this.state.common,data:this.state.data,updateData:this.state.updateData,onError:function(e){return t.setState({error:e})},onChange:function(e,n){return t.setState({data:e,changed:n})},customs:{configCustomEasyAccess:Z}}),Object(Q.jsx)(F.a,{isIFrame:!1,dense:!0,paddingLeft:0,theme:this.state.theme,noTextOnButtons:"xs"===this.props.width||"sm"===this.props.width||"md"===this.props.width,changed:this.state.error||this.state.changed,error:this.state.error,onSave:function(){var e=Object(x.a)(w.a.mark((function e(n){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onSave(!0,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onClose:Object(x.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onSave(!1);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))})]}):Object(Q.jsx)(S.a,{})}}]),n}(b.a);et.propTypes={menuPadding:N.a.number,adapterName:N.a.string,instance:N.a.number,isFloatComma:N.a.bool,dateFormat:N.a.string,secret:N.a.string,socket:N.a.object,theme:N.a.object,themeName:N.a.string,themeType:N.a.string};var nt=Object(p.a)({root:{width:"100%",height:"100%",overflow:"hidden",position:"relative"},scroll:{height:"calc(100% - 48px - 48px)",overflowY:"auto"},exportImportButtons:{position:"absolute",top:5,right:0,zIndex:3},button:{marginRight:5}})(et),at=function(t){Object(o.a)(n,t);var e=Object(r.a)(n);function n(t){var s;return Object(a.a)(this,n),(s=e.call(this,t)).state={checkedExist:!1},s.refIframe=c.a.createRef(),s.registered=!1,s}return Object(s.a)(n,[{key:"componentDidUpdate",value:function(t,e,n){!this.registered&&this.refIframe.contentWindow&&(this.registered=!0,this.props.onRegisterIframeRef(this.refIframe))}},{key:"componentDidMount",value:function(){var t=this,e=window.addEventListener?"addEventListener":"attachEvent",n=window[e],a="attachEvent"===e?"onmessage":"message";this.props.tab?this.props.socket.fileExists(this.props.adapter+".admin","tab.html").then((function(e){if(!e)return t.props.socket.fileExists(t.props.adapter+".admin","tab_m.html").then((function(e){return e?t.setState({checkedExist:"tab_m.html"}):window.alert("Cannot find tab(_m).html")}));t.setState({checkedExist:"tab.html"})})):this.setState({checkedExist:!0}),!this.registered&&this.refIframe.contentWindow&&(this.registered=!0,this.props.onRegisterIframeRef(this.refIframe)),n(a,(function(e){return t.closeConfig(e)}),!1)}},{key:"componentWillUnmount",value:function(){var t=this,e=window.removeEventListener?"removeEventListener":"detachEvent";(0,window[e])("detachEvent"===e?"onmessage":"message",(function(e){return t.closeConfig(e)}),!1),this.registered&&this.props.onUnregisterIframeRef(this.refIframe)}},{key:"closeConfig",value:function(t){"close"===t.data||"close"===t.message?this.props.easyMode?b.a.doNavigate("easy"):b.a.doNavigate("tab-instances"):"change"===t.data||"change"===t.message?this.props.configStored(!1):"nochange"!==t.data&&"nochange"!==t.message||this.props.configStored(!0)}},{key:"renderHelpButton",value:function(){var t=this;return this.props.jsonConfig?Object(Q.jsx)("div",{style:{display:"inline-block",position:"absolute",right:0,top:5},children:Object(Q.jsx)(m.a,{size:"small",title:this.props.t("Show help for this adapter"),children:Object(Q.jsx)(u.a,{classes:{root:this.props.classes.button},onClick:function(){var e=t.props.lang;"en"!==e&&"de"!==e&&"ru"!==e&&"zh-cn"!==e&&(e="en"),window.open("https://www.iobroker.net/#".concat(e,"/adapters/adapterref/iobroker.").concat(t.props.adapter,"/README.md"),"help")},children:Object(Q.jsx)(y.a,{})})})}):null}},{key:"getConfigurator",value:function(){var t=this;if(this.props.jsonConfig)return Object(Q.jsx)(nt,{menuPadding:this.props.menuPadding,theme:this.props.theme,width:this.props.width,adapterName:this.props.adapter,instance:this.props.instance,socket:this.props.socket,themeName:this.props.themeName,themeType:this.props.themeType,dateFormat:this.props.dateFormat,isFloatComma:this.props.isFloatComma,configStored:this.props.configStored,t:this.props.t});var e="adapter/".concat(this.props.adapter,"/")+"".concat(this.props.tab?this.state.checkedExist:this.props.materialize?"index_m.html":"index.html","?")+"".concat(this.props.instance||0,"&newReact=true&").concat(this.props.instance||0);return this.state.checkedExist?Object(Q.jsx)("iframe",{ref:function(e){return t.refIframe=e},title:"config",className:this.props.className,src:e}):null}},{key:"render",value:function(){var t=this.props.classes;return this.props.jsonConfig||"3000"!==window.location.port?Object(Q.jsxs)(d.a,{className:t.root,children:[Object(Q.jsx)(l.a,{color:"default",position:"static",children:Object(Q.jsxs)(h.a,{variant:"dense",children:[Object(Q.jsxs)(f.a,{variant:"h6",color:"inherit",children:[this.props.jsonConfig?Object(Q.jsx)(j.a,{src:this.props.icon,className:this.props.classes.instanceIcon}):null,"".concat(this.props.t("Instance settings"),": ").concat(this.props.adapter,".").concat(this.props.instance)]}),this.renderHelpButton()]})}),this.getConfigurator()]}):"Test it in not development mode!"}}]),n}(i.Component);e.a=Object(p.a)((function(t){return{root:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},scroll:{height:"100%",overflowY:"auto"},instanceIcon:{width:42,height:42,marginRight:t.spacing(2),verticalAlign:"middle"},button:{marginRight:5,width:36,height:36}}}))(at)},1835:function(t,e,n){"use strict";function a(t){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=u(n(0)),o=u(n(146)),r=u(n(206)),i=u(n(4)),c=u(n(168)),p=u(n(9)),l=u(n(1548)),d=u(n(48));function u(t){return t&&t.__esModule?t:{default:t}}function h(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=b(t);if(e){var s=b(this).constructor;n=Reflect.construct(a,arguments,s)}else n=a.apply(this,arguments);return g(this,n)}}function g(t,e){if(e&&("object"===a(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var v=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(i,t);var e,n,a,o=m(i);function i(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),e=o.call(this,t);try{e.isIFrame=!t.newReact&&window.self!==window.top}catch(n){e.isIFrame=!t.newReact}return e}return e=i,(n=[{key:"render",value:function(){var t=this,e=this.props.noTextOnButtons,n={borderRadius:this.props.theme.saveToolbar.button.borderRadius||3,height:this.props.theme.saveToolbar.button.height||32},a={bottom:this.isIFrame?38:0,left:this.props.paddingLeft||0,right:0,position:"absolute",background:this.props.theme.saveToolbar.background};return this.props.dense&&(a.minHeight=48),this.props.error&&(n.border="1px solid red"),s.default.createElement(c.default,{position:"absolute",style:a},s.default.createElement(r.default,{variant:"extended","aria-label":"Save",disabled:!this.props.changed||this.props.error,onClick:function(){return t.props.onSave(!1)},style:n},s.default.createElement(l.default,{className:e?"":this.props.classes.buttonIcon}),!e&&p.default.t("ra_Save")),s.default.createElement(r.default,{variant:"extended","aria-label":"Save and close",disabled:!this.props.changed||this.props.error,onClick:function(){return t.props.onSave(!0)},style:Object.assign({},n,{marginLeft:10})},s.default.createElement(l.default,{className:e?"":this.props.classes.buttonIcon}),e?"+":p.default.t("ra_Save and close"),e&&s.default.createElement(d.default,null)),s.default.createElement("div",{style:{flexGrow:1}}),s.default.createElement(r.default,{variant:"extended","aria-label":"Close",onClick:function(){return t.props.onClose()},style:n},s.default.createElement(d.default,{className:e?"":this.props.classes.buttonIcon}),!e&&p.default.t("ra_Close")))}}])&&h(e.prototype,n),a&&h(e,a),i}(s.default.Component);v.propTypes={dense:i.default.bool,paddingLeft:i.default.number,noTextOnButtons:i.default.bool,theme:i.default.object,isIFrame:i.default.bool,changed:i.default.bool.isRequired,error:i.default.bool,onSave:i.default.func.isRequired,onClose:i.default.func.isRequired,newReact:i.default.bool};var j=(0,o.default)((function(t){return{buttonIcon:{marginRight:8}}}))(v);e.default=j}}]);
//# sourceMappingURL=1.961894c5.chunk.js.map
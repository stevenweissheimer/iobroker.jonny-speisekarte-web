(this["webpackJsonpsrc-rx"]=this["webpackJsonpsrc-rx"]||[]).push([[13],{1647:function(t,e,a){"use strict";var n=a(19),i=a(25);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=i(a(0)),r=(0,n(a(27)).default)(s.createElement("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Create");e.default=r},1837:function(t,e,a){"use strict";var n=a(5),i=a(7),s=a(0),r=a(6),o=(a(4),a(35)),c=a(8),l=s.forwardRef((function(t,e){var a=t.animation,o=void 0===a?"pulse":a,c=t.classes,l=t.className,p=t.component,d=void 0===p?"span":p,h=t.height,u=t.variant,m=void 0===u?"text":u,f=t.width,g=Object(i.a)(t,["animation","classes","className","component","height","variant","width"]),v=Boolean(g.children);return s.createElement(d,Object(n.a)({ref:e,className:Object(r.default)(c.root,c[m],l,v&&[c.withChildren,!f&&c.fitContent,!h&&c.heightAuto],!1!==o&&c[o])},g,{style:Object(n.a)({width:f,height:h},g.style)}))}));e.a=Object(c.a)((function(t){return{root:{display:"block",backgroundColor:Object(o.a)(t.palette.text.primary,"light"===t.palette.type?.11:.13),height:"1.2em"},text:{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 60%",transform:"scale(1, 0.60)",borderRadius:t.shape.borderRadius,"&:empty:before":{content:'"\\00a0"'}},rect:{},circle:{borderRadius:"50%"},pulse:{animation:"$pulse 1.5s ease-in-out 0.5s infinite"},"@keyframes pulse":{"0%":{opacity:1},"50%":{opacity:.4},"100%":{opacity:1}},wave:{position:"relative",overflow:"hidden","&::after":{animation:"$wave 1.6s linear 0.5s infinite",background:"linear-gradient(90deg, transparent, ".concat(t.palette.action.hover,", transparent)"),content:'""',position:"absolute",transform:"translateX(-100%)",bottom:0,left:0,right:0,top:0}},"@keyframes wave":{"0%":{transform:"translateX(-100%)"},"60%":{transform:"translateX(100%)"},"100%":{transform:"translateX(100%)"}},withChildren:{"& > *":{visibility:"hidden"}},fitContent:{maxWidth:"fit-content"},heightAuto:{height:"auto"}}}),{name:"MuiSkeleton"})(l)},2021:function(t,e,a){"use strict";a.r(e);var n=a(17),i=a(11),s=a(12),r=a(14),o=a(15),c=a(0),l=a(8),p=a(633),d=a(630),h=a(92),u=a(747),m=a(1837),f=a(139),g=a.n(f),v=a(53),b=a.n(v),j=a(48),k=a.n(j),x=a(1647),O=a.n(x),C=a(82),y=a(52),N=a(211),S=a.n(N),L=a(113),w=a(1473),I=a(1485),T=a(1474),D=a(1472),U=a(1433),J=a(1486),R=a(181),B=a(1484),E=a(80),A=a(252),H=a.n(A),_=a(185),M=a.n(_),W=a(293),F=a.n(W),z=a(534),P=a.n(z),G=a(750),X=a.n(G),Y=a(217),V=a(226),Z=a(227),$=a(228),q=a(277),K=a(3),Q=function(t){Object(r.a)(a,t);var e=Object(o.a)(a);function a(t){var n;return Object(i.a)(this,a),(n=e.call(this,t)).cameraUpdateTimer=null,n.cameraRef=Object(c.createRef)(),n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var t=this;this.props.camera&&"text"!==this.props.camera&&(this.cameraUpdateTimer=setInterval((function(){return t.updateCamera()}),Math.max(parseInt(this.props.interval,10),500)),this.updateCamera())}},{key:"componentWillUnmount",value:function(){this.cameraUpdateTimer&&clearInterval(this.cameraUpdateTimer),this.cameraUpdateTimer=null}},{key:"updateCamera",value:function(){var t=this;if(this.cameraRef.current)if("custom"===this.props.camera){var e=this.props.children;this.props.addTs&&(e.includes("?")?e+="&ts="+Date.now():e+="?ts="+Date.now()),this.cameraRef.current.src=e}else{var a=this.props.camera.split("."),n=a.shift(),i=a.shift();this.props.socket.sendTo(n+"."+i,"image",{name:a.pop(),width:this.cameraRef.current.width}).then((function(e){e&&e.data&&t.cameraRef.current&&(t.cameraRef.current.src="data:image/jpeg;base64,"+e.data)}))}}},{key:"render",value:function(){var t=this,e=this.props.classes;return Object(K.jsxs)(V.a,{onClose:function(){return t.props.onClose()},open:!0,maxWidth:"xl",fullWidth:!0,fullScreen:!0,classes:{paper:e.paper},children:[Object(K.jsx)(q.a,{disableTypography:!0,children:Object(K.jsxs)(E.a,{component:"h2",variant:"h6",classes:{root:e.typography},children:[this.props.name,Object(K.jsx)(R.a,{className:e.closeButton,onClick:function(){return t.props.onClose()},children:Object(K.jsx)(k.a,{})})]})}),Object(K.jsx)($.a,{dividers:!0,children:Object(K.jsx)("img",{className:this.props.classes.img,src:"",alt:"camera",ref:this.cameraRef})}),Object(K.jsx)(Z.a,{children:Object(K.jsx)(L.a,{variant:"contained",autoFocus:!0,onClick:function(e){e.stopPropagation(),t.props.onClose()},color:"primary",startIcon:Object(K.jsx)(k.a,{}),children:this.props.t("Close")})})]})}}]),a}(c.Component),tt=Object(l.a)((function(t){return{rootGrid:{flexGrow:1},closeButton:{position:"absolute",right:t.spacing(1),top:t.spacing(1),color:t.palette.grey[500]},paper:{},typography:{paddingRight:30},img:{width:"100%",height:"100%",objectFit:"contain"}}}))(Q),et="0 2px 2px 0 rgba(0, 0, 0, .14),0 3px 1px -2px rgba(0, 0, 0, .12),0 1px 5px 0 rgba(0, 0, 0, .2)",at="0 8px 17px 0 rgba(0, 0, 0, .2),0 6px 20px 0 rgba(0, 0, 0, .19)",nt=function(t){Object(r.a)(a,t);var e=Object(o.a)(a);function a(t){var n;return Object(i.a)(this,a),(n=e.call(this,t)).state={error:!1,expanded:!1,dialog:!1,loaded:!1},n.cameraRef=Object(c.createRef)(),n.cameraUpdateTimer=null,n.interval=n.props.interval,n.camera=n.props.camera,n.t=t.t,n}return Object(s.a)(a,[{key:"updateCamera",value:function(){var t=this;if(this.cameraRef.current)if("custom"===this.props.camera){var e=this.props.children;this.props.addTs&&(e.includes("?")?e+="&ts="+Date.now():e+="?ts="+Date.now()),this.cameraRef.current.src=e}else{var a=this.props.camera.split("."),n=a.shift(),i=a.shift();this.props.socket.sendTo(n+"."+i,"image",{name:a.pop(),width:this.cameraRef.current.width}).then((function(e){e&&e.data&&t.cameraRef.current&&(t.cameraRef.current.src="data:image/jpeg;base64,"+e.data)})).catch((function(t){return window.alert("Cannot send to instance: "+t)}))}}},{key:"componentDidMount",value:function(){var t=this;this.props.camera&&"text"!==this.props.camera&&(this.cameraUpdateTimer=setInterval((function(){return t.updateCamera()}),Math.max(parseInt(this.props.interval,10),500)),this.updateCamera())}},{key:"componentWillUnmount",value:function(){this.cameraUpdateTimer&&clearInterval(this.cameraUpdateTimer),this.cameraUpdateTimer=null}},{key:"renderCameraDialog",value:function(){var t=this;return this.state.dialog?Object(K.jsx)(tt,{socket:this.props.socket,camera:this.props.camera,name:this.props.title,t:this.props.t,onClose:function(){t.props.camera&&"text"!==t.props.camera&&(t.cameraUpdateTimer&&clearInterval(t.cameraUpdateTimer),t.cameraUpdateTimer=setInterval((function(){return t.updateCamera()}),Math.max(parseInt(t.props.interval,10),500)),t.updateCamera()),t.setState({dialog:!1})},children:this.props.children}):null}},{key:"handleExpandClick",value:function(){this.setState({expanded:!this.state.expanded})}},{key:"handleImageLoad",value:function(){this.state.loaded||this.setState({loaded:!0,error:!1})}},{key:"handleImageError",value:function(){this.state.error||this.setState({loaded:!1,error:!0})}},{key:"renderContent",value:function(){var t=this,e=this.props.classes;if(!this.props.camera||"text"===this.props.camera)return this.props.children;if("custom"===this.props.camera){var a=this.props.children;return this.props.addTs&&(a.includes("?")?a+="&ts="+Date.now():a+="?ts="+Date.now()),Object(K.jsxs)(h.a,{item:!0,container:!0,className:e.imgContainer,justify:"center",alignItems:"center",children:[Object(K.jsx)("img",{ref:this.cameraRef,src:a,alt:"Camera",className:this.state.loaded&&!this.state.error?e.cameraImg:e.hidden,onLoad:function(){return t.handleImageLoad()},onError:function(){return t.handleImageError()}}),!this.state.loaded&&!this.state.error&&Object(K.jsx)(m.a,{height:"100%",width:"100%",animation:"wave",className:e.imgSkeleton}),this.state.error&&Object(K.jsx)(H.a,{fontSize:"large"})]})}return this.props.camera.startsWith("cameras.")?Object(K.jsx)("img",{ref:this.cameraRef,src:"",alt:"camera",className:this.props.classes.cameraImg}):void 0}},{key:"render",value:function(){var t=this,e=this.props.classes,a=this.props.edit?" "+e.edit:"";return this.props.camera&&"text"!==this.props.camera?this.interval!==this.props.interval&&(this.interval=this.props.interval,this.cameraUpdateTimer&&clearInterval(this.cameraUpdateTimer),this.cameraUpdateTimer=setInterval((function(){return t.updateCamera()}),Math.max(parseInt(this.props.interval,10),500))):this.cameraUpdateTimer&&(clearInterval(this.cameraUpdateTimer),this.cameraUpdateTimer=null),Object(K.jsx)(h.a,{item:!0,xs:12,sm:6,md:4,lg:3,className:e.root,children:Object(K.jsx)(B.a,{href:!this.props.edit&&this.props.action&&this.props.action.link?this.props.action.link:null,underline:"none",target:"_blank",rel:"noopener noreferrer",children:Object(K.jsxs)(w.a,{className:e.card,onClick:function(e){e.stopPropagation(),!t.props.edit&&t.props.camera&&"text"!==t.props.camera&&(t.cameraUpdateTimer&&clearInterval(t.cameraUpdateTimer),t.cameraUpdateTimer=null,t.setState({dialog:!0}))},children:[this.props.reveal&&!this.props.offline&&Object(K.jsx)(L.a,{className:e.expand+a,variant:"contained",size:"small",disabled:this.props.disabled,onClick:function(){return t.handleExpandClick()},color:"primary",children:this.props.t("Info")}),Object(K.jsx)("div",{className:e.media+a,style:{backgroundColor:this.props.color},children:Object(K.jsx)(D.a,{className:e.img,component:"img",image:this.props.image})}),Object(K.jsxs)("div",{className:e.contentContainer+a,children:[Object(K.jsx)(T.a,{className:e.content,children:Object(K.jsxs)(h.a,{container:!0,direction:"column",wrap:"nowrap",className:e.contentGrid,children:[Object(K.jsx)(E.a,{gutterBottom:!0,variant:"h5",component:"h5",children:this.props.title}),this.renderContent()]})}),this.props.action&&this.props.action.link&&Object(K.jsx)(J.a,{}),this.props.action&&this.props.action.link&&Object(K.jsx)(I.a,{className:e.action,children:Object(K.jsx)("div",{className:e.colorOrange,children:this.props.action.text||this.props.title||this.props.t("Link")})})]}),this.props.reveal&&Object(K.jsx)(U.a,{className:e.collapse,in:this.state.expanded,timeout:"auto",unmountOnExit:!0,children:Object(K.jsxs)(w.a,{className:e.cardInfo,children:[Object(K.jsxs)("div",{className:e.cardInfoHead,children:[Object(K.jsx)(E.a,{gutterBottom:!0,variant:"h5",component:"h5",children:"Info"}),Object(K.jsxs)("div",{children:[Object(K.jsx)(R.a,{size:"small",onClick:function(){S()(t.props.getHostDescriptionAll()[1],{format:"text/plain"}),t.props.openSnackBarFunc()},children:Object(K.jsx)(F.a,{})}),Object(K.jsx)(R.a,{size:"small",onClick:function(){return t.handleExpandClick()},children:Object(K.jsx)(k.a,{})})]})]}),Object(K.jsx)(T.a,{children:this.props.getHostDescriptionAll()[0]})]})}),this.props.edit&&this.props.toggleActivation&&Object(K.jsx)(R.a,{className:this.props.enabled?e.enabled:e.disabled,onClick:function(){return t.props.toggleActivation()},children:Object(K.jsx)(b.a,{})}),this.props.edit&&this.props.onEdit&&Object(K.jsx)(R.a,{className:e.editButton,onClick:function(){return t.props.onEdit()},children:Object(K.jsx)(O.a,{})}),this.props.edit&&this.props.onRemove&&Object(K.jsx)(R.a,{className:e.deleteButton,onClick:function(){return t.props.onRemove()},children:Object(K.jsx)(M.a,{})}),this.renderCameraDialog()]})})})}}],[{key:"getDerivedStateFromProps",value:function(t){return t.edit?{expanded:!1}:null}}]),a}(c.Component),it=Object(l.a)((function(t){return{root:Object(y.a)({padding:".75rem"},t.breakpoints.up("xl"),{flex:"0 1 20%"}),card:{display:"flex",minHeight:"235px",position:"relative",overflow:"hidden",maxHeight:"235p","&:hover":{overflowY:"auto",boxShadow:at}},cardInfo:{display:"flex",minHeight:"235px",position:"relative",overflow:"initial",maxHeight:"235p",flexDirection:"column","&:hover":{boxShadow:at}},cardInfoHead:{position:"sticky",top:0,background:t.palette.background.default,display:"flex",width:"100%",justifyContent:"space-between",borderBottom:"1px solid",padding:"5px 5px 0px 5px"},edit:{opacity:".6",userSelect:"none",pointerEvents:"none"},media:{backgroundColor:"#e2e2e2",maxWidth:"30%"},img:{width:"120px",height:"auto",padding:"2rem .5rem",maxWidth:"100%"},contentContainer:{display:"flex",flexDirection:"column",flex:1},content:{height:"170px",flexGrow:1,overflowY:"hidden"},action:{minHeight:"49px",padding:"16px 24px"},expand:{position:"absolute",right:"10px",bottom:"10px"},collapse:{minHeight:"100%",backgroundColor:"#ffffff",position:"absolute",width:"100%"},close:{right:"10px"},save:{right:"50px"},enabled:{color:"#ffffff",backgroundColor:P.a[500],position:"absolute",top:t.spacing(1),right:t.spacing(1),boxShadow:et,"&:hover":{backgroundColor:P.a[300]},"&:focus":{backgroundColor:P.a[500]}},disabled:{color:"#ffffff",backgroundColor:X.a[500],position:"absolute",top:t.spacing(1),right:t.spacing(1),boxShadow:et,"&:hover":{backgroundColor:X.a[300]},"&:focus":{backgroundColor:X.a[500]}},editButton:{color:"#ffffff",backgroundColor:X.a[500],position:"absolute",top:t.spacing(2)+48,right:t.spacing(1),boxShadow:et,"&:hover":{backgroundColor:X.a[300]},"&:focus":{backgroundColor:X.a[500]}},deleteButton:{color:"#ffffff",backgroundColor:Y.a[500],position:"absolute",top:t.spacing(3)+48+48,right:t.spacing(1),boxShadow:et,"&:hover":{backgroundColor:Y.a[300]},"&:focus":{backgroundColor:Y.a[500]}},cameraImg:{width:"100%",height:"100%",maxWidth:200,maxHeight:200,objectFit:"contain"},imgContainer:{height:"100%"},hidden:{display:"none"},contentGrid:{height:"100%"},imgSkeleton:{transform:"initial"},colorOrange:{color:"#ffcc80"}}}))(nt),st=a(427),rt=a(521),ot=a(279),ct=a(607),lt=a(677),pt=a(680),dt=a(497),ht=a(331),ut=a(496),mt=a(502),ft=a(538),gt=function(t){Object(r.a)(a,t);var e=Object(o.a)(a);function a(t){var n;Object(i.a)(this,a),n=e.call(this,t);var s=Object.assign({image:"",name:t.t("New link"),link:"http://",linkName:"",color:"",desc:"",enabled:!0,addTs:!0,interval:5e3,camera:"text",cameraList:[]},t.link);return n.state=s,n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.getCamerasInstances()}},{key:"getCamerasInstances",value:function(){var t=this;this.props.socket.getAdapterInstances("cameras",!0).then((function(e){var a=[],n=[];e.forEach((function(e){var i=e._id.replace("system.adapter.","");e.common&&e.common.enabled&&n.push(t.props.socket.getState(e._id+".alive").then((function(e){return e&&e.val&&t.props.socket.sendTo(i,"list",null)})).then((function(t){return t&&t.list&&t.list.forEach((function(t){return a.push({id:t.id,name:"".concat(t.desc," [").concat(i,"/").concat(t.name,"]")})}))})))})),Promise.all(n).then((function(){return t.setState({cameraList:a})}))}))}},{key:"getLinkNameFromLink",value:function(t){var e=t.trim().match(/^https?:\/\/([^/:]+)(:\d+)?/);if(e)return e[1]+(e[2]||"")}},{key:"render",value:function(){var t=this,e=this.props.classes;return Object(K.jsxs)(V.a,{onClose:function(){return t.props.onClose()},open:this.props.open,maxWidth:"md",fullWidth:!0,classes:{paper:e.paper},children:[Object(K.jsx)(q.a,{disableTypography:!0,children:Object(K.jsxs)(E.a,{component:"h2",variant:"h6",classes:{root:e.typography},children:[this.props.isNew?this.props.t("Add new link: "):this.props.t("Edit link"),Object(K.jsx)(R.a,{className:e.closeButton,onClick:function(){return t.props.onClose()},children:Object(K.jsx)(k.a,{})})]})}),Object(K.jsx)($.a,{dividers:!0,children:Object(K.jsxs)(h.a,{className:this.props.classes.rootGrid,container:!0,direction:"row",children:[Object(K.jsx)(h.a,{item:!0,xs:12,sm:6,md:8,lg:9,children:Object(K.jsxs)(h.a,{container:!0,direction:"column",children:[Object(K.jsxs)(ut.a,{className:e.formControl,children:[Object(K.jsx)(dt.a,{id:"select-helper-label",children:this.props.t("Link type")}),Object(K.jsxs)(mt.a,{labelId:"select-helper-label",value:this.state.camera,onChange:function(e){return t.setState({camera:e.target.value})},children:[Object(K.jsx)(ht.a,{value:"text",children:Object(K.jsx)("em",{children:this.props.t("Description")})},"desc"),this.state.cameraList.map((function(t){return Object(K.jsx)(ht.a,{value:t.id,children:t.name},t.id)})),Object(K.jsx)(ht.a,{value:"custom",children:this.props.t("Custom camera URL")},"custom")]})]}),Object(K.jsx)(ot.a,{label:this.props.t("URL"),value:this.state.link,className:this.props.classes.editItem,onChange:function(e){var a=t.getLinkNameFromLink(t.state.link);!a||t.state.linkName&&a!==t.state.linkName?t.setState({link:e.target.value}):t.setState({link:e.target.value,linkName:t.getLinkNameFromLink(e.target.value)})}}),Object(K.jsx)(ot.a,{className:this.props.classes.editItem,label:this.props.t("Name"),value:this.state.name||"",onChange:function(e){return t.setState({name:e.target.value})}}),this.state.link?Object(K.jsx)(ot.a,{className:this.props.classes.editItem,label:this.props.t("Link name"),value:this.state.linkName||"",onChange:function(e){return t.setState({linkName:e.target.value})}}):null,"custom"===this.state.camera||"text"===this.state.camera?Object(K.jsx)(ot.a,{className:this.props.classes.editItem,label:"custom"===this.state.camera?this.props.t("Camera URL"):this.props.t("Description"),value:this.state.desc||"",onChange:function(e){return t.setState({desc:e.target.value})}}):null,"custom"===this.state.camera?Object(K.jsx)(ct.a,{className:this.props.classes.editItem,control:Object(K.jsx)(lt.a,{checked:this.state.addTs,onChange:function(e){return t.setState({addTs:e.target.checked})}}),label:this.props.t("Add timestamp to URL")}):null,"text"!==this.state.camera?Object(K.jsx)(E.a,{className:this.props.classes.labelSlider,gutterBottom:!0,children:"Polling interval in ms"}):null,"text"!==this.state.camera?Object(K.jsx)(pt.a,{className:this.props.classes.editItemSlider,value:this.state.interval,getAriaValueText:function(){return t.state.interval+"ms"},onChange:function(e,a){return t.setState({interval:a})},step:100,min:500,max:6e4,valueLabelDisplay:"on"}):null,Object(K.jsx)("div",{style:{width:50},className:this.props.classes.editItem,children:Object(K.jsx)(ot.a,{fullWidth:!0,label:this.props.t("Color"),className:this.props.editColor,type:"color",value:this.state.color,onChange:function(e){return t.setState({color:e.target.value})}})}),Object(K.jsx)(ft.a,{disabled:!1,crop:!0,maxSize:262144,icon:this.state.image,removeIconFunc:function(){return t.setState({image:""})},onChange:function(e){return t.setState({image:e})},t:this.props.t})]})}),Object(K.jsx)(it,{interval:this.state.interval,camera:this.state.camera,addTs:this.state.addTs,image:this.state.image,title:this.state.name,socket:this.props.socket,action:{link:this.state.link,text:this.state.linkName},t:this.props.t,color:this.state.color,enabled:!0,children:this.state.desc||""})]})}),Object(K.jsxs)(Z.a,{children:[Object(K.jsx)(L.a,{variant:"contained",autoFocus:!0,onClick:function(){t.props.onClose({link:t.state.link,name:t.state.name,desc:t.state.desc,linkName:t.state.linkName,color:t.state.color,image:t.state.image,addTs:t.state.addTs,camera:t.state.camera,interval:t.state.interval})},color:"primary",startIcon:this.props.isNew?Object(K.jsx)(g.a,{}):Object(K.jsx)(b.a,{}),children:this.props.isNew?this.props.t("Add"):this.props.t("Save")}),Object(K.jsx)(L.a,{variant:"contained",onClick:function(){return t.props.onClose()},color:"default",startIcon:Object(K.jsx)(k.a,{}),children:this.props.t("Close")})]})]})}}]),a}(c.Component),vt=Object(l.a)((function(t){return{formControl:{marginTop:t.spacing(4)},rootGrid:{flexGrow:1},closeButton:{position:"absolute",right:t.spacing(1),top:t.spacing(1),color:t.palette.grey[500]},paper:{},typography:{paddingRight:30},editItem:{marginTop:t.spacing(1)},editItemSlider:{marginTop:t.spacing(3)},labelSlider:{marginTop:t.spacing(2),fontSize:"1rem"},editColor:{width:"100%"},dropZone:{width:"100%",height:100,position:"relative"},dropZoneEmpty:{},image:{height:"100%",width:"auto",objectFir:"contain"},uploadDiv:{position:"relative",width:"100%",height:100,opacity:.9},uploadDivDragging:{opacity:1},uploadCenterDiv:{margin:5,border:"3px dashed grey",borderRadius:5,width:"calc(100% - 10px)",height:"calc(100% - 10px)",position:"relative"},uploadCenterIcon:{paddingTop:10,width:48,height:48},uploadCenterText:{fontSize:16},uploadCenterTextAndIcon:{textAlign:"center",position:"absolute",top:0,bottom:0,left:0,right:0}}}))(gt),bt={Uptime:C.a.formatSeconds,"System uptime":C.a.formatSeconds,RAM:C.a.formatRam,Speed:C.a.formatSpeed,"Disk size":C.a.formatBytes,"Disk free":C.a.formatBytes},jt=function(t){Object(r.a)(a,t);var e=Object(o.a)(a);function a(t){var n;return Object(i.a)(this,a),(n=e.call(this,t)).state={instances:null,deactivated:{},edit:!1,introLinks:[],editLink:!1,editLinkIndex:-1,openSnackBar:!1,hasUnsavedChanges:!1},n.promises={},n.introLinksOriginal=null,n.deactivatedOriginal=null,n.t=t.t,n.getData(),n}return Object(s.a)(a,[{key:"activateEditMode",value:function(){var t,e=this;this.props.socket.getSystemConfig(!0).then((function(a){return t=a,e.getInstances(!0,null,t)})).then((function(a){var n=t&&t.native&&t.native.introLinks?t.native.introLinks:[];e.introLinksOriginal=JSON.parse(JSON.stringify(n)),e.deactivatedOriginal=JSON.parse(JSON.stringify(a.deactivated)),e.setState({instances:a.instances,deactivated:a.deactivated,edit:!0,introLinks:n,hasUnsavedChanges:!1})}))}},{key:"deactivateEditMode",value:function(){var t=this;this.state.hasUnsavedChanges,this.setState({deactivated:this.deactivatedOriginal,introLinks:this.introLinksOriginal,hasUnsavedChanges:!1,edit:!1},(function(){t.deactivatedOriginal=null,t.introLinksOriginal=null}))}},{key:"toggleCard",value:function(t,e){if(this.state.instances&&this.state.instances.length){var a=JSON.parse(JSON.stringify(this.state.deactivated)),n=a.indexOf(t+"_"+e);-1!==n?a.splice(n,1):(a.push(t+"_"+e),a.sort());var i=JSON.stringify(a)!==JSON.stringify(this.deactivatedOriginal)||JSON.stringify(this.state.introLinks)!==JSON.stringify(this.introLinksOriginal);this.setState({deactivated:a,hasUnsavedChanges:i})}}},{key:"getInstancesCards",value:function(){var t=this;return this.state.instances.map((function(e){var a=!t.state.deactivated.includes(e.id+"_"+e.linkName);if(a||t.state.edit){var n=e.link?e.link.replace(/^https?:\/\//,""):"",i=n.indexOf("/");-1!==i&&(n=n.substring(0,i));var s=t.state.hostsData?t.state.hostsData[e.id]:null;return Object(K.jsx)(it,{socket:t.props.socket,image:e.image,title:e.name,action:{link:e.link,text:n},t:t.props.t,color:e.color,reveal:e.info,edit:t.state.edit,offline:s&&!1===s.alive,enabled:a,disabled:!s||"object"!==typeof s,getHostDescriptionAll:function(){return t.getHostDescriptionAll(e.id)},toggleActivation:function(){return t.toggleCard(e.id,e.linkName)},openSnackBarFunc:function(){return t.setState({openSnackBar:!0})},children:e.description||t.getHostDescription(e.id)},e.id+"_"+e.link)}return null}))}},{key:"toggleLinkCard",value:function(t){var e=JSON.parse(JSON.stringify(this.state.introLinks));e[t].enabled=!e[t].enabled;var a=JSON.stringify(this.state.deactivated)!==JSON.stringify(this.deactivatedOriginal)||JSON.stringify(e)!==JSON.stringify(this.introLinksOriginal);this.setState({introLinks:e,hasUnsavedChanges:a})}},{key:"getLinkCards",value:function(){var t=this;return this.state.introLinks.map((function(e,a){return e.enabled||t.state.edit?Object(K.jsx)(it,{image:e.image,title:e.name,action:{link:e.link,text:e.linkName},t:t.props.t,socket:t.props.socket,color:e.color,edit:t.state.edit,interval:e.interval,camera:e.camera,addTs:e.addTs,onEdit:function(){return t.setState({editLink:!0,editLinkIndex:a,link:JSON.parse(JSON.stringify(t.state.introLinks[a]))})},onRemove:function(){var e=JSON.parse(JSON.stringify(t.state.introLinks));e.splice(a,1);var n=JSON.stringify(t.state.deactivated)!==JSON.stringify(t.deactivatedOriginal)||JSON.stringify(e)!==JSON.stringify(t.introLinksOriginal);t.setState({introLinks:e,hasUnsavedChanges:n})},enabled:e.enabled,toggleActivation:function(){return t.toggleLinkCard(a)},children:e.desc||""},"link"+a):null}))}},{key:"editLinkCard",value:function(){var t=this;return this.state.editLink?Object(K.jsx)(vt,{open:this.state.editLink,link:this.state.link,socket:this.props.socket,isNew:-1===this.state.editLinkIndex,t:this.props.t,lang:this.props.lang,onClose:function(e){if(e){var a=JSON.parse(JSON.stringify(t.state.introLinks));-1===t.state.editLinkIndex?(e.enabled=!0,a.push(e)):(e.enabled=a[t.state.editLinkIndex].enabled,a[t.state.editLinkIndex]=e);var n=JSON.stringify(t.state.deactivated)!==JSON.stringify(t.deactivatedOriginal)||JSON.stringify(a)!==JSON.stringify(t.introLinksOriginal);t.setState({introLinks:a,editLink:!1,hasUnsavedChanges:n,link:null})}else t.setState({editLink:!1})}}):null}},{key:"getButtons",value:function(t){var e=this,a=[];return this.state.edit?(a.push(Object(K.jsx)(p.a,{color:"primary",className:t.button+" "+t.addButton,onClick:function(){return e.setState({editLink:!0,editLinkIndex:-1,link:{}})},children:Object(K.jsx)(g.a,{})},"add")),a.push(Object(K.jsx)(p.a,{color:"primary",disabled:!this.state.hasUnsavedChanges,className:t.button+" "+t.saveButton,onClick:function(){return e.saveCards()},children:Object(K.jsx)(b.a,{})},"save")),a.push(Object(K.jsx)(p.a,{color:"primary",className:t.button+" "+t.closeButton,onClick:function(){return e.deactivateEditMode()},children:Object(K.jsx)(k.a,{})},"close"))):a.push(Object(K.jsx)(p.a,{color:"primary",className:t.button,onClick:function(){return e.activateEditMode()},children:Object(K.jsx)(O.a,{})},"edit")),a}},{key:"saveCards",value:function(){var t=this;return this.props.socket.getSystemConfig(!0).then((function(e){var a=!1;JSON.stringify(e.common.intro)!==JSON.stringify(t.state.deactivated)&&(e.common.intro=t.state.deactivated,a=!0),a||JSON.stringify(e.native.introLinks)===JSON.stringify(t.state.introLinks)||(a=!0,e.native.introLinks=t.state.introLinks),a?t.props.socket.setSystemConfig(e).then((function(){return t.props.showAlert("Updated","success")})).catch((function(e){console.log(e),t.props.showAlert(e,"error")})).then((function(){return t.setState({edit:!1})})):t.setState({edit:!1})}))}},{key:"getHostsData",value:function(t){var e=this,a=t.map((function(t){return e.props.socket.getState(t._id+".alive").then((function(a){return a&&a.val?e.props.socket.getHostInfo(t._id,!1,1e4):{alive:!1}})).catch((function(t){return console.error(t),t})).then((function(e){return{id:t._id,data:e}}))}));return new Promise((function(t){return Promise.all(a).then((function(e){var a={};e.forEach((function(t){return a[t.id]=t.data})),t(a)}))}))}},{key:"getInstances",value:function(t,e,a){var i=this;return e=e||this.state.hosts,this.props.socket.getAdapterInstances("",t).then((function(t){var s=a.common.intro||[];Array.isArray(s)||(s=Object.keys(s)).sort();var r=[],o={};t.forEach((function(t){return o[t._id]=t})),t.sort((function(t,e){return t=t&&t.common,e=(e=e&&e.common)||{},void 0===(t=t||{}).order&&void 0===e.order?t.name.toLowerCase()>e.name.toLowerCase()?1:t.name.toLowerCase()<e.name.toLowerCase()?-1:0:void 0===t.order?-1:void 0===e.order||t.order>e.order?1:t.order<e.order?-1:t.name.toLowerCase()>e.name.toLowerCase()?1:t.name.toLowerCase()<e.name.toLowerCase()?-1:0})),t.forEach((function(t){if(t){var a=t.common||null,s=t._id.split(".").pop();if((!a.name||"admin"!==a.name||a.localLink!==(i.props.hostname||""))&&(!a.name||"web"!==a.name)&&(!a.name||"vis-web-admin"===a.name||!a.name.match(/^vis-/))&&(!a.name||!a.name.match(/^icons-/))&&a&&(a.enabled||a.onlyWWW)&&(a.localLinks||a.localLink)){var c=a.localLinks||a.localLink||"";"string"===typeof c&&(c={_default:c}),Object.keys(c).forEach((function(l){var p=c[l],d={};"string"===typeof p&&(p={link:p}),d.id=t._id.replace("system.adapter.","")+("_default"===l?"":" "+l),d.name=(a.titleLang?a.titleLang[i.props.lang]:a.title)+("_default"===l?"":" "+l),d.color=p.color||"",d.description=a.desc&&"object"===typeof a.desc?a.desc[i.props.lang]||a.desc.en:a.desc||"",d.image=a.icon?"adapter/"+a.name+"/"+a.icon:"img/no-image.png";var h=C.a.replaceLink(p.link,a.name,s,{objects:o,hostname:i.props.hostname,protocol:i.props.protocol,port:i.props.port,adminInstance:i.props.adminInstance,hosts:e})||[];if(1===h.length){d.link=h[0].url,d.port=h[0].port;var u=r.find((function(t){return t.link===d.link}));u?console.log('Double links: "'.concat(d.id,'" and "').concat(u.id,'"')):r.push(d)}else h.length>1&&h.forEach((function(t){var e=r.find((function(e){return e.link===t.url}));e?console.log('Double links: "'.concat(d.id,'" and "').concat(e.id,'"')):r.push(Object(n.a)(Object(n.a)({},d),{},{link:t.url,port:t.port}))}))}))}}})),r.forEach((function(t){t.link&&(t.linkName=t.link.replace("https://","").replace("http://","").replace(/^[^_]+:/,""))})),Object.keys(e).forEach((function(t){var a=e[t],n=a&&a.common;if(n){var s={};s.id=a._id,s.name=n.name,s.color="",s.image=n.icon||"img/no-image.png",s.info=i.t("Info"),s.linkName="",r.push(s)}}));var c=[];return s.forEach((function(t){r.find((function(e){return t===e.id+"_"+e.linkName}))&&c.push(t)})),{instances:r,deactivated:s=c}})).catch((function(t){return console.log(t),{instances:[],deactivated:[]}}))}},{key:"getHostDescription",value:function(t){var e=this,a=this.props.classes,n=this.state.hostsData?this.state.hostsData[t]:null;return n&&!1===n.alive?Object(K.jsx)("div",{className:this.props.classes.hostOffline,children:this.props.t("Offline")}):Object(K.jsx)("ul",{children:["Platform","RAM","Node.js","NPM"].map((function(t){return Object(K.jsx)("li",{children:n&&"object"===typeof n?Object(K.jsxs)("span",{children:[Object(K.jsxs)("span",{className:a.bold,children:[e.t(t),": "]}),bt[t]?bt[t](n[t]):n[t]||"--"]}):Object(K.jsx)(m.a,{})},t)}))})}},{key:"getHostDescriptionAll",value:function(t){var e=this,a=this.props.classes,n=this.state.hostsData?this.state.hostsData[t]:null;return[Object(K.jsx)("ul",{children:n&&"object"===typeof n&&Object.keys(n).map((function(t){return Object(K.jsx)("li",{children:n&&"object"===typeof n?Object(K.jsxs)("span",{children:[Object(K.jsxs)("span",{className:a.bold,children:[e.t(t),": "]}),bt[t]?bt[t](n[t],e.t):n[t]||"--"]}):Object(K.jsx)(m.a,{})},t)}))}),n&&"object"===typeof n&&Object.keys(n).reduce((function(t,a){return t+"".concat(e.t(a),":").concat(bt[a]?bt[a](n[a],e.t):n[a]||"--","\n")}))]}},{key:"getData",value:function(t){var e,a,n=this;return this.props.socket.getCurrentInstance().then((function(e){return n.adminInstance=e,n.props.socket.getSystemConfig(t)})).then((function(e){return a=e,n.props.socket.getCompactHosts(t)})).then((function(i){return e=i,n.getInstances(t,e,a)})).then((function(t){return n.setState({instances:t.instances,hosts:e,deactivated:t.deactivated,introLinks:a&&a.native&&a.native.introLinks?a.native.introLinks:[]}),n.getHostsData(e)})).then((function(t){return n.setState({hostsData:t})}))}},{key:"render",value:function(){var t=this;if(!this.state.instances)return Object(K.jsx)(u.a,{});var e=this.props.classes;return Object(K.jsxs)(st.a,{elevation:0,overflow:"visible",children:[Object(K.jsx)(d.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:this.state.openSnackBar,autoHideDuration:3e3,onClose:function(){return t.setState({openSnackBar:!1})},message:this.t("copied")}),Object(K.jsxs)(rt.a,{classes:{root:e.container},children:[Object(K.jsxs)(h.a,{container:!0,spacing:2,children:[this.getInstancesCards(),this.getLinkCards()]}),this.getButtons(e),this.editLinkCard()]})]})}}]),a}(c.Component);e.default=Object(l.a)((function(t){return{root:{width:"100%",height:"100%"},button:{position:"absolute",bottom:t.spacing(2),right:t.spacing(2)},saveButton:{backgroundColor:t.palette.success.main,right:t.spacing(10),"&:hover":{backgroundColor:t.palette.success.dark}},addButton:{backgroundColor:t.palette.secondary.main,right:t.spacing(18),"&:hover":{backgroundColor:t.palette.secondary.dark}},closeButton:{backgroundColor:t.palette.error.main,"&:hover":{backgroundColor:t.palette.error.dark}},bold:{fontWeight:"bold"},container:{overflowY:"auto"},hostOffline:{color:"#bb0000"}}}))(jt)}}]);
//# sourceMappingURL=13.7d21ae26.chunk.js.map
{"version":3,"sources":["components/FileViewer.js","components/FileBrowser.js","dialogs/FileEditOfAccessControl.js","tabs/Files.js"],"names":["EXTENSIONS","images","code","txt","FileViewer","props","writeFile64","parts","href","split","data","state","editingValue","splice","adapter","name","join","socket","Buffer","from","toString","then","_","onClose","catch","e","window","alert","ext","Utils","getFileExtension","text","editing","formatEditFile","copyPossible","includes","readFile","el","setState","this","onError","target","onerror","src","NoImage","className","clsx","classes","img","getClassBackgroundImage","alt","mode","getEditFile","width","height","theme","themeName","value","onChange","newValue","readOnly","fontSize","setOptions","enableBasicAutocompletion","enableLiveAutocompletion","enableSnippets","editorProps","$blockScrolling","scrollPaper","dialog","paper","scroll","open","fullWidth","maxWidth","dialogTitle","id","t","color","onClick","setStateBackgroundImage","content","getContent","copyToClipboard","startIcon","disabled","variant","key","Component","withWidth","withStyles","textAlign","textarea","objectFit","justifyContent","display","BUTTON_WIDTH","TILE_HEIGHT","NOT_FOUND","USER_DATA","sortFolders","a","b","folder","getParentDir","dir","length","pop","isFile","path","toLowerCase","match","TABLE","TILE","FileBrowser","array","backgroundImage","indexOf","localStorage","setItem","backgroundImageLight","backgroundImageDark","backgroundImageColored","viewType","expanded","getItem","JSON","parse","showViewTypeButton","selected","currentDir","folders","filterEmpty","expertMode","addFolder","uploadFile","deleteItem","marked","viewer","errorText","modalEditOfAccess","queueLength","loadAllFolders","allFoldersLoaded","imagePrefix","levelPadding","mounted","suppressDeleteConfirm","browseList","browseListRunning","initialReadFinished","browseFolder","browseFolders","Promise","resolve","findItem","scrollToSelected","pathFocus","document","getElementById","scrollIntoView","loadFolders","foldersList","_newFolders","_resolve","Object","keys","forEach","shift","setTimeout","relPath","reject","push","processBrowseList","level","processing","readDir","files","item","folderId","_checkEmpty","all","filter","map","error","readDirSerial","_folders","file","isDir","size","stats","modified","modifiedAt","acl","sort","readMetaItems","objs","userData","obj","_id","title","common","meta","ts","icon","unshift","stopPropagation","pos","stringify","temp","err","lastSelect","Date","now","onSelect","cb","filterFiles","filterByType","Icon","IconOpen","IconClosed","padding","style","marginLeft","select","changeFolder","onDoubleClick","toggleFolder","lang","end","itemSelected","undefined","Hidden","xsDown","formatAcl","allowDownload","allowDelete","startsWith","IconButton","itemFolderIconBack","formatBytes","access","permissions","padStart","getFileIcon","formatSize","download","res","renderBackFolder","renderFolder","renderFile","renderItems","position","CircularProgress","zIndex","top","Toolbar","showExpertButton","edge","menuButton","menuButtonExpertActive","allowCreateFolder","allowUpload","Tooltip","parentFolder","find","findFirstFolder","applyText","cancelText","titleText","promptText","labelText","verify","parent","replace","prevProps","prevState","snapshot","setOpacityTimer","clearTimeout","items","getElementsByClassName","i","opacity","fileName","Fab","uploadCloseButton","onDragEnter","onDragLeave","onDrop","acceptedFiles","count","reader","FileReader","onabort","console","log","onload","result","readAsArrayBuffer","getRootProps","getInputProps","uploadDiv","uploadDivDragging","uploadCenterDiv","uploadCenterTextAndIcon","uploadCenterIcon","uploadCenterText","deleteRecursive","deleteFolder","parentId","f","deleteFile","Dialog","DialogTitle","DialogContent","DialogContentText","DialogActions","Button","autoFocus","info","changed","it","p","part","pathDivBreadcrumbDir","pathDivBreadcrumbSlash","pathDivBreadcrumbFile","pathDiv","pathDivBreadcrumb","Input","onKeyDown","keyCode","changeToPath","onBlur","pathDivInput","renderBreadcrumb","ready","foldersLoading","root","showToolbar","renderToolbar","renderPath","filesDiv","renderInputDialog","renderUpload","renderDeleteDialog","allowView","renderViewDialog","modalEditOfAccessControl","modalEditOfAccessObjData","renderError","LinearProgress","defaultProps","objectAddBoolean","objectEditBoolean","objectStatesView","objectImportExport","objectEditOfAccessControl","modalNewObject","_export","mixins","toolbar","minHeight","overflow","spacing","overflowX","overflowY","filesDivTable","filesDivTile","alignContent","alignItems","flexWrap","flex","itemTile","userSelect","cursor","transition","margin","background","palette","secondary","light","invertColor","main","itemNameFolderTile","fontWeight","itemNameTile","textOverflow","wordBreak","itemFolderIconTile","paddingLeft","left","type","itemSizeTile","itemImageTile","itemIconTile","primary","itemTable","lineHeight","ROW_HEIGHT","itemNameTable","verticalAlign","flexGrow","itemNameFolderTable","itemSizeTable","itemAccessTable","paddingRight","itemImageTable","marginTop","maxHeight","itemIconTable","itemFolderTable","itemFolderTemp","itemFolderIconTable","itemDownloadButtonTable","minWidth","paddingTop","itemAclButtonTable","itemDeleteButtonTable","bottom","right","border","borderRadius","marginRight","whiteSpace","paddingBottom","borderBottom","direction","readWriteArray","Owner","valueNum","Group","Everyone","newValueAccessControl","mask","ObjectRights","setValue","differentValues","applyToChildren","setMask","useEffect","_checkDifferent","newSelected","borderLeft","flexDirection","idx","bool","borderRight","Checkbox","checked","indeterminate","flatList","list","loadPath","aa","ff","DIFFERENT","FileEditOfAccessControl2","onApply","extendObject","objects","themeType","substring","lastIndexOf","object","useState","stateOwnerUser","setStateOwnerUser","stateOwnerGroup","setStateOwnerGroup","users","setUsers","groups","setGroups","setApplyToChildren","childrenCount","setChildrenCount","valueFileAccessControl","setValueFileAccessControl","differentOwner","setDifferentOwner","differentGroup","setDifferentGroup","differentObject","setDifferentObject","maskObject","setMaskObject","ids","setIds","disabledButton","setDisabledButton","progress","setProgress","I18n","getLanguage","_differentObject","_differentOwner","_differentGroup","_stateOwnerUser","_stateOwnerGroup","_valueFileAccessControl","_ids","idWithSlash","objFolder","owner","ownerGroup","keyFolder","_users","_groups","defaultAcl","defaultNewAcl","CustomModal","titleButtonApply","overflowHidden","applyDisabled","defaultAclFile","newAcl","_maskObject","label","different","val","Switch","Files","translate","word","arg1","arg2","wordCache","getObjects","TabContainer","TabContent","context","objData","FileEditOfAccessControl","promise","getObject","oldObj","setObject","chownFile","chmodFile","entries","updateItemsAcl"],"mappings":"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","file":"static/js/14.f5e1a630.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport { withStyles } from '@material-ui/core/styles';\nimport withWidth from '@material-ui/core/withWidth';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\n\nimport AceEditor from 'react-ace';\nimport 'ace-builds/webpack-resolver';\nimport 'ace-builds/src-noconflict/mode-json';\nimport 'ace-builds/src-noconflict/theme-clouds_midnight';\nimport 'ace-builds/src-noconflict/theme-chrome';\nimport 'ace-builds/src-noconflict/ext-language_tools'\n\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport { IconButton } from '@material-ui/core';\n\nimport NoImage from '@iobroker/adapter-react/assets/no_icon.svg';\nimport Utils from '@iobroker/adapter-react/Components/Utils';\n\n// Icons\nimport { FaCopy as CopyIcon } from 'react-icons/fa';\nimport Brightness5Icon from '@material-ui/icons/Brightness6';\nimport CloseIcon from '@material-ui/icons/Close';\nimport SaveIcon from '@material-ui/icons/Save';\n\nconst styles = theme => ({\n    dialog: {\n        height: '100%',\n    },\n    paper: {\n        height: 'calc(100% - 64px)',\n    },\n    content: {\n        textAlign: 'center',\n    },\n    textarea: {\n        width: '100%',\n        height: '100%',\n    },\n    img: {\n        width: 'auto',\n        height: 'calc(100% - 5px)',\n        objectFit: 'contain',\n    },\n    dialogTitle: {\n        justifyContent: 'space-between',\n        display: 'flex'\n    }\n});\n\nexport const EXTENSIONS = {\n    images: ['png', 'jpg', 'svg', 'jpeg', 'jpg', 'bmp'],\n    code:   ['js', 'json', 'md'],\n    txt:    ['log', 'txt', 'html', 'css', 'xml'],\n};\n\nclass FileViewer extends Component {\n    constructor(props) {\n        super(props);\n        this.ext = Utils.getFileExtension(this.props.href);\n\n        this.state = {\n            text: null,\n            code: null,\n            editing: !!this.props.formatEditFile || false,\n            editingValue: null,\n            copyPossible: EXTENSIONS.code.includes(this.ext) || EXTENSIONS.txt.includes(this.ext)\n        };\n\n        if (this.state.copyPossible) {\n            const parts = this.props.href.split('/');\n            parts.splice(0, 2);\n            const adapter = parts[0];\n            const name = parts.splice(1).join('/');\n            this.props.socket.readFile(adapter, name)\n                .then(el => {\n                    if (EXTENSIONS.txt.includes(this.ext)) {\n                        this.setState({ text: el, editingValue: el });\n                    } else if (EXTENSIONS.code.includes(this.ext)) {\n                        this.setState({ code: el, editingValue: el });\n                    }\n                })\n                .catch(e => window.alert('Cannot read file: ' + e));\n        }\n    }\n\n    writeFile64 = () => {\n        const parts = this.props.href.split('/');\n        const data = this.state.editingValue;\n        parts.splice(0, 2);\n        const adapter = parts[0];\n        const name = parts.splice(1).join('/');\n        this.props.socket.writeFile64(adapter, name, Buffer.from(data).toString('base64'))\n            .then(_ => this.props.onClose())\n            .catch(e => window.alert('Cannot write file: ' + e));\n    }\n\n    getEditFile(ext) {\n        switch (ext) {\n            case 'json':\n                return 'json';\n            case 'js':\n                return 'javascript';\n            case 'html':\n                return 'html';\n            case 'txt':\n                return 'html';\n            default:\n                return 'json';\n        }\n    }\n\n    getContent() {\n        if (EXTENSIONS.images.includes(this.ext)) {\n            return <img\n                onError={e => {\n                    e.target.onerror = null;\n                    e.target.src = NoImage\n                }}\n                className={clsx(this.props.classes.img, this.props.getClassBackgroundImage())}\n                src={this.props.href} alt={this.props.href} />;\n        } else if (this.state.code !== null || this.state.text !== null || this.state.editing) {\n            return <AceEditor\n                mode={this.getEditFile(this.props.formatEditFile)}\n                width=\"100%\"\n                height=\"100%\"\n                theme={this.props.themeName === 'dark' ? 'clouds_midnight' : 'chrome'}\n                value={this.state.editingValue || this.state.code || this.state.text}\n                onChange={newValue => this.setState({ editingValue: newValue })}\n                name=\"UNIQUE_ID_OF_DIV\"\n                readOnly={!this.state.editing}\n                fontSize={14}\n                setOptions={{\n                    enableBasicAutocompletion: true,\n                    enableLiveAutocompletion: true,\n                    enableSnippets: true\n                }}\n                editorProps={{ $blockScrolling: true }}\n            />\n        }\n    }\n\n    render() {\n        return <Dialog\n            classes={{ scrollPaper: this.props.classes.dialog, paper: this.props.classes.paper }}\n            scroll=\"paper\"\n            key={this.props.key}\n            open={!!this.props.href}\n            onClose={() => this.props.onClose()}\n            fullWidth={true}\n            maxWidth=\"xl\"\n            aria-labelledby=\"form-dialog-title\"\n        >\n            <div className={this.props.classes.dialogTitle}>\n                <DialogTitle id=\"form-dialog-title\">{this.props.t(this.state.editing ? 'Edit' : 'View') + ': ' + this.props.href}</DialogTitle>\n                {EXTENSIONS.images.includes(this.ext) && <div>\n                    <IconButton\n                        color={'inherit'}\n                        onClick={this.props.setStateBackgroundImage}\n                    >\n                        <Brightness5Icon />\n                    </IconButton>\n                </div>\n                }\n            </div>\n            <DialogContent className={this.props.classes.content}>\n                {this.getContent()}\n            </DialogContent>\n            <DialogActions>\n                {this.state.copyPossible ?\n                    <Button\n                        onClick={e => Utils.copyToClipboard(this.state.text || this.state.code, e)}\n                        startIcon={<CopyIcon />}\n                    >\n                        {this.props.t('Copy content')}\n                    </Button> : null}\n                {this.state.editing ?\n                    <Button\n                        disabled={this.state.editingValue === this.state.code || this.state.editingValue === this.state.text}\n                        variant=\"contained\"\n                        onClick={this.writeFile64}\n                        startIcon={<SaveIcon />}\n                    >\n                        {this.props.t('Save')}\n                    </Button> : null}\n                <Button\n                    variant=\"contained\"\n                    onClick={() => this.props.onClose()}\n                    color=\"primary\"\n                    startIcon={<CloseIcon />}\n                >\n                    {this.props.t('Close')}\n                </Button>\n            </DialogActions>\n        </Dialog>;\n    }\n}\n\nFileViewer.propTypes = {\n    key: PropTypes.string,\n    t: PropTypes.func,\n    lang: PropTypes.string,\n    expertMode: PropTypes.bool,\n    onClose: PropTypes.func,\n    href: PropTypes.string.isRequired\n};\n\nexport default withWidth()(withStyles(styles)(FileViewer));\n","/* This file is temporary here to speed-up the development of this component.\n    Later it will be moved to adapter-react\n */\n/**\n * Copyright 2020-2021, bluefox <dogafox@gmail.com>\n *\n * MIT License\n *\n **/\nimport withWidth from '@material-ui/core/withWidth';\nimport { withStyles } from '@material-ui/core/styles';\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Dropzone from 'react-dropzone'\n\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport Fab from '@material-ui/core/Fab';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport Button from '@material-ui/core/Button';\nimport Input from '@material-ui/core/Input';\nimport { Hidden, Tooltip } from '@material-ui/core';\n\nimport ErrorDialog from '@iobroker/adapter-react/Dialogs/Error';\nimport Utils from '@iobroker/adapter-react/Components/Utils';\nimport TextInputDialog from '@iobroker/adapter-react/Dialogs/TextInput';\nimport { EXTENSIONS } from '@iobroker/adapter-react/Components/FileViewer';\nimport FileViewer from './FileViewer';\n//import FileViewer from '@iobroker/adapter-react/Components/FileViewer';\n\n// Icons\nimport RefreshIcon from '@material-ui/icons/Refresh';\nimport CloseIcon from '@material-ui/icons/Close';\nimport JsonIcon from '@material-ui/icons/Bookmark';\nimport CssIcon from '@material-ui/icons/BookmarkBorder';\nimport HtmlIcon from '@material-ui/icons/Description';\nimport EditIcon from '@material-ui/icons/Edit';\nimport JSIcon from '@material-ui/icons/Code';\nimport FileIcon from '@material-ui/icons/InsertDriveFile';\nimport UploadIcon from '@material-ui/icons/Publish';\nimport MusicIcon from '@material-ui/icons/MusicNote';\nimport DownloadIcon from '@material-ui/icons/SaveAlt';\nimport AddFolderIcon from '@material-ui/icons/CreateNewFolder';\nimport EmptyFilterIcon from '@material-ui/icons/FolderOpen';\nimport IconList from '@material-ui/icons/List';\nimport IconTile from '@material-ui/icons/ViewModule';\nimport IconBack from '@material-ui/icons/ArrowBack';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport Brightness5Icon from '@material-ui/icons/Brightness6';\n\nimport ExpertIcon from '@iobroker/adapter-react/icons/IconExpert';\nimport NoImage from '@iobroker/adapter-react/assets/no_icon.svg';\nimport IconClosed from '@iobroker/adapter-react/icons/IconClosed';\nimport IconOpen from '@iobroker/adapter-react/icons/IconOpen';\n\nconst ROW_HEIGHT   = 32;\nconst BUTTON_WIDTH = 32;\nconst TILE_HEIGHT  = 120;\nconst TILE_WIDTH   = 64;\n\nconst NOT_FOUND = 'Not found';\n\nconst styles = theme => ({\n    dialog: {\n        height: `calc(100% - ${theme.mixins.toolbar.minHeight}px)`,\n    },\n    root: {\n        width: '100%',\n        overflow: 'hidden',\n        height: '100%',\n        position: 'relative',\n    },\n    filesDiv: {\n        width: `calc(100% - ${theme.spacing(2)}px)`,\n        overflowX: 'hidden',\n        overflowY: 'auto',\n        padding: theme.spacing(1),\n    },\n    filesDivTable: {\n        height: `calc(100% - ${48 + theme.spacing(1)}px)`,\n    },\n    filesDivTile: {\n        height: `calc(100% - ${48 * 2 + theme.spacing(1)}px)`,\n        display: 'flex',\n        alignContent: 'flex-start',\n        alignItems: 'stretch',\n        flexWrap: 'wrap',\n        flex: `0 0 ${TILE_WIDTH}px`,\n    },\n\n    itemTile: {\n        position: 'relative',\n        userSelect: 'none',\n        cursor: 'pointer',\n        height: TILE_HEIGHT,\n        width: TILE_WIDTH,\n        display: 'inline-block',\n        textAlign: 'center',\n        opacity: 0.1,\n        transition: 'opacity 1s',\n        margin: 4,\n        '&:hover': {\n            background: theme.palette.secondary.light,\n            color: Utils.invertColor(theme.palette.secondary.main, true),\n        }\n    },\n    itemNameFolderTile: {\n        fontWeight: 'bold',\n    },\n    itemNameTile: {\n        width: '100%',\n        height: 32,\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        fontSize: 12,\n        textAlign: 'center',\n        wordBreak: 'break-all',\n    },\n    itemFolderIconTile: {\n        width: '100%',\n        height: TILE_HEIGHT - 32 - 16 - 8, // name + size\n        display: 'block',\n        paddingLeft: 8,\n        color: theme.palette.secondary.main || '#fbff7d',\n    },\n    itemFolderIconBack: {\n        position: 'absolute',\n        top: 22,\n        left: 18,\n        zIndex: 1,\n        color: theme.palette.type === 'dark' ? '#FFF' : '#000',\n    },\n    itemSizeTile: {\n        width: '100%',\n        height: 16,\n        textAlign: 'center',\n        fontSize: 10,\n    },\n    itemImageTile: {\n        width: 'calc(100% - 8px)',\n        height: TILE_HEIGHT - 32 - 16 - 8, // name + size\n        margin: 4,\n        display: 'block',\n        textAlign: 'center',\n        objectFit: 'contain',\n    },\n    itemIconTile: {\n        width: '100%',\n        height: TILE_HEIGHT - 32 - 16 - 8, // name + size\n        display: 'block',\n        objectFit: 'contain',\n    },\n\n    itemSelected: {\n        background: theme.palette.primary.main,\n        color: Utils.invertColor(theme.palette.primary.main, true),\n    },\n\n    itemTable: {\n        userSelect: 'none',\n        cursor: 'pointer',\n        height: ROW_HEIGHT,\n        display: 'inline-flex',\n        lineHeight: ROW_HEIGHT + 'px',\n        '&:hover': {\n            background: theme.palette.secondary.light,\n            color: Utils.invertColor(theme.palette.secondary.main, true),\n        }\n    },\n    itemNameTable: {\n        display: 'inline-block',\n        paddingLeft: 10,\n        fontSize: '1rem',\n        verticalAlign: 'top',\n        flexGrow: 1,\n    },\n    itemNameFolderTable: {\n        fontWeight: 'bold',\n    },\n    itemSizeTable: {\n        display: 'inline-block',\n        width: 60,\n        verticalAlign: 'top',\n        textAlign: 'right'\n    },\n    itemAccessTable: {\n        // display: 'inline-block',\n        verticalAlign: 'top',\n        width: 60,\n        textAlign: 'right',\n        paddingRight: 5,\n        display: 'flex',\n        justifyContent: 'center'\n    },\n    itemImageTable: {\n        display: 'inline-block',\n        width: 30,\n        marginTop: 1,\n        objectFit: 'contain',\n        maxHeight: 30,\n    },\n    itemIconTable: {\n        display: 'inline-block',\n        marginTop: 1,\n        width: 30,\n        height: 30,\n    },\n    itemFolderTable: {\n\n    },\n    itemFolderTemp: {\n        opacity: 0.4\n    },\n    itemFolderIconTable: {\n        marginTop: 1,\n        marginLeft: theme.spacing(1),\n        display: 'inline-block',\n        width: 30,\n        height: 30,\n        color: theme.palette.secondary.main || '#fbff7d',\n    },\n    itemDownloadButtonTable: {\n        display: 'inline-block',\n        width: BUTTON_WIDTH,\n        height: ROW_HEIGHT,\n        minWidth: BUTTON_WIDTH,\n        verticalAlign: 'top',\n        padding: 0,\n        '& span': {\n            paddingTop: 9\n        },\n        '& svg': {\n            width: 14,\n            height: 14,\n            fontSize: '1rem'\n        }\n    },\n    itemAclButtonTable: {\n        width: BUTTON_WIDTH,\n        height: ROW_HEIGHT,\n        minWidth:BUTTON_WIDTH,\n        verticalAlign: 'top',\n        padding: 0,\n        fontSize: 12,\n        display: 'flex'\n    },\n    itemDeleteButtonTable: {\n        display: 'inline-block',\n        width: BUTTON_WIDTH,\n        height: ROW_HEIGHT,\n        minWidth: BUTTON_WIDTH,\n        verticalAlign: 'top',\n        padding: 0,\n        '& svg': {\n            width: 18,\n            height: 18,\n            fontSize: '1.5rem'\n        }\n    },\n\n    uploadDiv: {\n        top: 0,\n        zIndex: 1,\n        bottom: 0,\n        left: 0,\n        right: 0,\n        position: 'absolute',\n        opacity: 0.9,\n        textAlign: 'center',\n        background: '#FFFFFF',\n    },\n    uploadDivDragging: {\n        opacity: 1,\n    },\n\n    uploadCenterDiv: {\n        margin: 20,\n        border: '3px dashed grey',\n        borderRadius: 30,\n        width: 'calc(100% - 40px)',\n        height: 'calc(100% - 40px)',\n        position: 'relative',\n        color: theme.palette.type === 'dark' ? '#222' : '#CCC'\n    },\n    uploadCenterIcon: {\n        width: '25%',\n        height: '25%',\n    },\n    uploadCenterText: {\n        fontSize: 24,\n        fontWeight: 'bold',\n    },\n    uploadCloseButton: {\n        zIndex: 2,\n        position: 'absolute',\n        top: 30,\n        right: 30,\n    },\n    uploadCenterTextAndIcon: {\n        position: 'absolute',\n        top: '50%',\n        left: '50%',\n        height: '30%',\n        width: '50%',\n        margin: '-15% 0 0 -25%',\n    },\n    menuButtonExpertActive: {\n        color: '#c00000',\n    },\n    pathDiv: {\n        display: 'flex',\n        width: `calc(100% - ${theme.spacing(2)}px)`,\n        marginLeft: theme.spacing(1),\n        marginRight: theme.spacing(1),\n        textOverflow: 'clip',\n        overflow: 'hidden',\n        whiteSpace: 'nowrap'\n    },\n    pathDivInput: {\n        width: '100%',\n    },\n    pathDivBreadcrumb: {\n        paddingTop: 3,\n        paddingBottom: 2,\n        borderBottom: 'solid 1px',\n    },\n    pathDivBreadcrumbDir: {\n        paddingLeft: 4,\n        paddingRight: 4,\n        paddingBottom: 4,\n        cursor: 'pointer',\n        '&:hover': {\n            background: theme.palette.type === 'dark' ? '#333' : '#CCC',\n        },\n    },\n    pathDivBreadcrumbSlash: {\n        paddingLeft: 4,\n        paddingRight: 4,\n        paddingBottom: 4,\n        opacity: 0.7,\n    },\n    pathDivBreadcrumbFile: {\n        cursor: 'pointer',\n        flexGrow: 1,\n    },\n    backgroundImageLight: {\n        background: 'white'\n    },\n    backgroundImageDark: {\n        background: 'black'\n    },\n    backgroundImageColored: {\n        background: 'silver'\n    },\n    '@media screen and (max-width: 500px)': {\n        itemNameTable: {\n            whiteSpace: 'nowrap',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            textAlign: 'end',\n            direction: 'rtl'\n        }\n    },\n});\n\nconst USER_DATA = '0_userdata.0';\n\nfunction sortFolders(a, b) {\n    if (a.folder && b.folder) {\n        return a.name > b.name ? 1 : (a.name < b.name ? -1 : 0);\n    } else if (a.folder) {\n        return -1;\n    } else if (b.folder) {\n        return 1;\n    } else {\n        return a.name > b.name ? 1 : (a.name < b.name ? -1 : 0)\n    }\n}\n\nfunction getParentDir(dir) {\n    const parts = (dir || '').split('/');\n    parts.length && parts.pop();\n    return parts.join('/');\n}\n\nfunction isFile(path) {\n    let ext = Utils.getFileExtension(path);\n    if (ext && ext.toLowerCase().match(/[a-z]+/) && ext.length < 5) {\n        return true;\n    } else {\n        return false;\n    }\n}\n\nconst TABLE = 'Table';\nconst TILE = 'Tile';\n\n/**\n * @extends {React.Component<import('./types').FileBrowserProps>}\n */\nclass FileBrowser extends Component {\n    /**\n     * @param {Readonly<import(\"./types\").FileBrowserProps>} props\n     */\n    constructor(props) {\n        super(props);\n        let expanded = window.localStorage.getItem('files.expanded') || '[]';\n\n        try {\n            expanded = JSON.parse(expanded);\n        } catch (e) {\n            expanded = [];\n        }\n\n        let viewType;\n        if (this.props.showViewTypeButton) {\n            viewType = window.localStorage.getItem('files.viewType') || TABLE;\n        } else {\n            viewType = TABLE;\n        }\n\n        let selected = this.props.selected || window.localStorage.getItem('files.selected') || USER_DATA;\n        let currentDir = '';\n        if (isFile(selected)) {\n            currentDir = getParentDir(selected);\n        } else {\n            currentDir = selected;\n        }\n        let backgroundImage = window.localStorage.getItem('files.backgroundImage') || null;\n\n        this.state = {\n            viewType,\n            folders: {},\n            filterEmpty: window.localStorage.getItem('files.empty') !== 'false',\n            expanded,\n            currentDir,\n            expertMode: this.props.expertMode,\n            addFolder: false,\n            uploadFile: false,\n            deleteItem: '',\n            marked: [],\n            viewer: '',\n            formatEditFile: '',\n            path: selected,\n            selected,\n            errorText: '',\n            modalEditOfAccess: false,\n            backgroundImage,\n            queueLength: 0,\n            loadAllFolders: false,\n            allFoldersLoaded: false,\n        };\n\n        this.imagePrefix = this.props.imagePrefix || './files/';\n\n        this.levelPadding = this.props.levelPadding || 20;\n        this.mounted = true;\n        this.suppressDeleteConfirm = 0;\n\n        this.browseList = [];\n        this.browseListRunning = false;\n        this.initialReadFinished = false;\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        if (props.expertMode !== undefined && props.expertMode !== state.expertMode) {\n            return { expertMode: props.expertMode, loadAllFolders: !state.allFoldersLoaded && props.expertMode };\n        } else {\n            return null;\n        }\n    }\n\n    loadFolders() {\n        this.initialReadFinished = false;\n        return this.browseFolder('/')\n            .then(folders => {\n                return this.state.viewType === TABLE ?\n                    this.browseFolders([...this.state.expanded], folders)\n                    :\n                    (this.state.currentDir && this.state.currentDir !== '/' ? this.browseFolder(this.state.currentDir, folders) : Promise.resolve(folders))\n            })\n            .then(folders => this.setState({ folders }, () => {\n                if (this.state.viewType === TABLE && !this.findItem(this.state.selected)) {\n                    const parts = this.state.selected.split('/');\n                    while (parts.length && !this.findItem(parts.join('/'))) {\n                        parts.pop();\n                    }\n                    let selected;\n                    if (parts.length) {\n                        selected = parts.join('/');\n                    } else {\n                        selected = USER_DATA;\n                    }\n                    this.setState({ selected, path: selected, pathFocus: false }, () => this.scrollToSelected());\n                } else {\n                    this.scrollToSelected();\n                }\n                this.initialReadFinished = true;\n            }))\n    }\n\n    scrollToSelected() {\n        if (this.mounted) {\n            const el = document.getElementById(this.state.selected);\n            el && el.scrollIntoView();\n        }\n    }\n\n    componentDidMount() {\n        this.mounted = true;\n        this.loadFolders();\n    }\n\n    componentWillUnmount() {\n        this.mounted = false;\n        this.browseList = null;\n        this.browseListRunning = false;\n    }\n\n    browseFolders(foldersList, _newFolders, _resolve) {\n        if (!_newFolders) {\n            _newFolders = {};\n            Object.keys(this.state.folders).forEach(folder => _newFolders[folder] = this.state.folders[folder]);\n        }\n\n        if (!_resolve) {\n            return new Promise(resolve => this.browseFolders(foldersList, _newFolders, resolve));\n        }\n\n        if (!foldersList || !foldersList.length) {\n            _resolve(_newFolders);\n        } else {\n            this.browseFolder(foldersList.shift(), _newFolders)\n                .then(()  => setTimeout(() => this.browseFolders(foldersList, _newFolders, _resolve), 0))\n                .catch(() => setTimeout(() => this.browseFolders(foldersList, _newFolders, _resolve), 0))\n        }\n    }\n\n    readDirSerial(adapter, relPath) {\n        return new Promise((resolve, reject) => {\n            if (this.browseList) { // if component still mounted\n                this.browseList.push({resolve, reject, adapter, relPath});\n                !this.browseListRunning && this.processBrowseList();\n            }\n        });\n    }\n\n    processBrowseList(level) {\n        if (!this.browseListRunning && this.browseList && this.browseList.length) {\n            this.browseListRunning = true;\n            if (this.browseList.length > 10) {\n                // not too often\n                if (!(this.browseList.length % 10)) {\n                    this.setState({queueLength: this.browseList.length});\n                }\n            } else {\n                this.setState({queueLength: this.browseList.length});\n            }\n\n            this.browseList[0].processing = true;\n            this.props.socket.readDir(this.browseList[0].adapter, this.browseList[0].relPath)\n                .then(files => {\n                    if (this.browseList) { // if component still mounted\n                        const item = this.browseList.shift();\n                        if (item) {\n                            const resolve = item.resolve;\n                            item.resolve = null;\n                            item.reject  = null;\n                            item.adapter = null;\n                            item.relPath = null;\n                            resolve(files);\n                            this.browseListRunning = false;\n                            if (this.browseList.length) {\n                                if (level < 5) {\n                                    this.processBrowseList(level + 1);\n                                } else {\n                                    setTimeout(() => this.processBrowseList(0), 0);\n                                }\n                            } else {\n                                this.setState({queueLength: 0});\n                            }\n                        } else {\n                            this.setState({queueLength: 0});\n                        }\n                    }\n\n                })\n                .catch(e => {\n                    if (this.browseList) { // if component still mounted\n                        const item = this.browseList.shift();\n                        if (item) {\n                            const reject = item.reject;\n                            item.resolve = null;\n                            item.reject = null;\n                            item.adapter = null;\n                            item.relPath = null;\n                            reject(e);\n                            this.browseListRunning = false;\n                            if (this.browseList.length) {\n                                if (level < 5) {\n                                    this.processBrowseList(level + 1);\n                                } else {\n                                    setTimeout(() => this.processBrowseList(0), 0);\n                                }\n                            } else {\n                                this.setState({queueLength: 0});\n                            }\n                        } else {\n                            this.setState({queueLength: 0});\n                        }\n                    }\n                });\n        }\n    }\n\n    browseFolder(folderId, _newFolders, _checkEmpty) {\n        if (!_newFolders) {\n            _newFolders = {};\n            Object.keys(this.state.folders).forEach(folder =>\n                _newFolders[folder] = this.state.folders[folder]);\n        }\n\n        if (_newFolders[folderId]) {\n            if (!_checkEmpty) {\n                return new Promise((resolve, reject) =>\n                    Promise.all(_newFolders[folderId].filter(item => item.folder).map(item =>\n                        this.browseFolder(item.id, _newFolders, true)\n                            .catch(error => { })))\n                        .then(() => resolve(_newFolders))\n                        .catch(error => reject(error)));\n            } else {\n                return Promise.resolve(_newFolders);\n            }\n        }\n\n        if (!folderId || folderId === '/') {\n            return this.props.socket.readMetaItems()\n                .then(objs => {\n                    const _folders = [];\n                    let userData = null;\n\n                    // load only adapter.admin and not other meta files like hm-rpc.0.devices.blablabla\n                    objs = objs.filter(obj => {\n                        if (!this.state.expertMode) {\n                            return obj._id === '0_userdata.0' || obj._id === 'vis.0';\n                        } else {\n                            return obj._id.split('.').length <= 2;\n                        }\n                    });\n\n                    // remember, that all folders are loaded\n                    if (this.state.expertMode) {\n                        this.setState({allFoldersLoaded: true, loadFolders: false});\n                    }\n\n                    objs.forEach(obj => {\n                        const item = {\n                            id:     obj._id,\n                            name:   obj._id,\n                            title:  (obj.common && obj.common.name) || obj._id,\n                            meta:   true,\n                            from:   obj.from,\n                            ts:     obj.ts,\n                            color:  obj.common && obj.common.color,\n                            icon:   obj.common && obj.common.icon,\n                            folder: true,\n                            acl:    obj.acl,\n                            level:  0\n                        };\n                        if (item.id === USER_DATA) {\n                            // user data must be first\n                            userData = item;\n                        } else {\n                            _folders.push(item);\n                        }\n                    });\n                    _folders.sort((a, b) => a.id > b.id ? 1 : (a.id < b.id ? -1 : 0));\n                    _folders.unshift(userData);\n\n                    _newFolders[folderId || '/'] = _folders;\n\n                    if (!_checkEmpty) {\n                        return Promise.all(_folders.filter(item => item.folder).map(item =>\n                            this.browseFolder(item.id, _newFolders, true).catch(error => { })))\n                            .then(() => _newFolders)\n                    } else {\n                        return _newFolders;\n                    }\n                })\n                .catch(e => this.initialReadFinished && window.alert('Cannot read meta items: ' + e));\n        } else {\n            const parts   = folderId.split('/');\n            const level   = parts.length;\n            const adapter = parts.shift();\n            const relPath = parts.join('/');\n\n            // make all requests here serial\n            return this.readDirSerial(adapter, relPath)\n                .then(files => {\n                    const _folders = [];\n                    files.forEach(file => {\n                        const item = {\n                            id:       folderId + '/' + file.file,\n                            ext:      Utils.getFileExtension(file.file),\n                            folder:   file.isDir,\n                            name:     file.file,\n                            size:     file.stats && file.stats.size,\n                            modified: file.modifiedAt,\n                            acl:      file.acl,\n                            level\n                        };\n                        _folders.push(item);\n                    });\n\n                    _folders.sort(sortFolders);\n                    _newFolders[folderId] = _folders;\n\n                    if (!_checkEmpty) {\n                        return Promise.all(_folders.filter(item => item.folder).map(item => this.browseFolder(item.id, _newFolders, true)))\n                            .then(() => _newFolders);\n                    } else {\n                        return _newFolders;\n                    }\n                })\n                .catch(e => {\n                    this.initialReadFinished && window.alert(`Cannot read ${adapter}${relPath ? '/' + relPath : ''}: ${e}`);\n                    _newFolders[folderId] = [];\n                    return _newFolders;\n                });\n        }\n    }\n\n    toggleFolder(item, e) {\n        e && e.stopPropagation();\n        const expanded = [...this.state.expanded];\n        const pos = expanded.indexOf(item.id);\n        if (pos === -1) {\n            expanded.push(item.id);\n            expanded.sort();\n\n            window.localStorage.setItem('files.expanded', JSON.stringify(expanded));\n\n            if (!item.temp) {\n                return this.browseFolder(item.id)\n                    .then(folders => this.setState({ expanded, folders }))\n                    .catch(err => window.alert(err === NOT_FOUND ? this.props.t('re_Cannot find \"%s\"', item.id) : this.props.t('re_Cannot read \"%s\"', item.id)));\n            } else {\n                this.setState({ expanded });\n            }\n        } else {\n            expanded.splice(pos, 1);\n            window.localStorage.setItem('files.expanded', JSON.stringify(expanded));\n            this.setState({ expanded });\n        }\n    }\n\n    changeFolder(e, folder) {\n        e && e.stopPropagation();\n\n        this.lastSelect = Date.now();\n\n        folder = folder || getParentDir(this.state.currentDir);\n\n        if (folder === '/') {\n            folder = '';\n        }\n\n        window.localStorage.setItem('files.currentDir', folder);\n\n        if (folder && !this.state.folders[folder]) {\n            return this.browseFolder(folder)\n                .then(folders =>\n                    this.setState({ folders, path: folder, currentDir: folder, selected: folder, pathFocus: false }, () => this.props.onSelect && this.props.onSelect('')));\n        } else {\n            this.setState({ currentDir: folder, selected: folder, path: folder, pathFocus: false }, () => this.props.onSelect && this.props.onSelect(''));\n        }\n    }\n\n    select(id, e, cb) {\n        if (typeof e === 'function') {\n            cb = e;\n            e = null;\n        }\n        e && e.stopPropagation();\n        this.lastSelect = Date.now();\n        window.localStorage.setItem('files.selected', id);\n        this.setState({ selected: id, path: id, pathFocus: false }, () => {\n            if (this.props.onSelect) {\n                const ext = Utils.getFileExtension(id);\n                if ((!this.props.filterFiles || this.props.filterFiles.includes(ext)) &&\n                    (!this.props.filterByType || EXTENSIONS[this.props.filterByType].includes(ext))\n                ) {\n                    this.props.onSelect(id);\n                } else {\n                    this.props.onSelect('');\n                }\n            }\n            cb && cb();\n        });\n    }\n\n    renderFolder(item, expanded) {\n        if (this.state.filterEmpty && (!this.state.folders[item.id] || !this.state.folders[item.id].length) && item.id !== USER_DATA && !item.temp) {\n            return null;\n        }\n        const Icon = expanded ? IconOpen : IconClosed;\n        const padding = this.state.viewType === TABLE ? item.level * this.levelPadding : 0;\n        return <div key={item.id}\n            id={item.id}\n            style={this.state.viewType === TABLE ? { marginLeft: padding, width: 'calc(100% - ' + padding + 'px' } : {}}\n            onClick={e => this.state.viewType === TABLE ? this.select(item.id, e) : this.changeFolder(e, item.id)}\n            onDoubleClick={e => this.state.viewType === TABLE && this.toggleFolder(item, e)}\n            title={item.title && typeof item.title === 'object' ? item.title[this.props.lang] || item.title.end || '' : item.title || null}\n            className={Utils.clsx(\n                'browserItem',\n                this.props.classes['item' + this.state.viewType],\n                this.props.classes['itemFolder' + this.state.viewType],\n                this.state.selected === item.id && this.props.classes.itemSelected,\n                item.temp && this.props.classes['itemFolderTemp'],\n            )}>\n            <Icon className={this.props.classes['itemFolderIcon' + this.state.viewType]} onClick={this.state.viewType === TABLE ? e => this.toggleFolder(item, e) : undefined} />\n\n            <div className={Utils.clsx(this.props.classes['itemName' + this.state.viewType], this.props.classes['itemNameFolder' + this.state.viewType])}\n            >{item.name === USER_DATA ? this.props.t('ra_User files') : item.name}</div>\n\n            <Hidden xsDown>\n                {<div className={this.props.classes['itemSize' + this.state.viewType]}>{this.state.viewType === TABLE && this.state.folders[item.id] ? this.state.folders[item.id].length : ''}</div>}\n            </Hidden>\n\n            <Hidden xsDown>\n                {this.state.viewType === TABLE ? this.formatAcl(item.acl) : null}\n            </Hidden>\n            <Hidden xsDown>\n                {this.state.viewType === TABLE && this.props.expertMode && <div className={this.props.classes['itemDeleteButton' + this.state.viewType]} />}\n            </Hidden>\n            {this.state.viewType === TABLE && this.props.allowDownload ? <div className={this.props.classes['itemDownloadButton' + this.state.viewType]} /> : null}\n\n            {this.state.viewType === TABLE && this.props.allowDelete && this.state.folders[item.id] && this.state.folders[item.id].length && (this.state.expertMode || item.id.startsWith(USER_DATA) || item.id.startsWith('vis.0/')) ?\n                <IconButton aria-label=\"delete\"\n                    onClick={e => {\n                        e.stopPropagation();\n                        if (this.suppressDeleteConfirm > Date.now()) {\n                            this.deleteItem(item.id);\n                        } else {\n                            this.setState({ deleteItem: item.id });\n                        }\n                    }}\n                    className={this.props.classes['itemDeleteButton' + this.state.viewType]}\n                >\n                    <DeleteIcon fontSize=\"small\" />\n                </IconButton>\n                :\n                (this.state.viewType === TABLE && this.props.allowDelete ? <div className={this.props.classes['itemDeleteButton' + this.state.viewType]} /> : null)\n            }\n        </div>;\n    }\n\n    renderBackFolder() {\n        return <div key={this.state.currentDir}\n            id={this.state.currentDir}\n            onClick={e => this.changeFolder(e)}\n            title={this.props.t('re_Back to %s', getParentDir(this.state.currentDir))}\n            className={Utils.clsx(\n                'browserItem',\n                this.props.classes['item' + this.state.viewType],\n                this.props.classes['itemFolder' + this.state.viewType],\n            )}>\n            <IconClosed className={this.props.classes['itemFolderIcon' + this.state.viewType]} />\n            <IconBack className={this.props.classes.itemFolderIconBack} />\n\n            <div\n                className={Utils.clsx(this.props.classes['itemName' + this.state.viewType], this.props.classes['itemNameFolder' + this.state.viewType])}\n            >..</div>\n        </div>;\n    }\n\n    formatSize(size) {\n        return <div className={this.props.classes['itemSize' + this.state.viewType]}>{size || size === 0 ? Utils.formatBytes(size) : ''}</div>;\n    }\n\n    formatAcl(acl) {\n        let access = acl && (acl.permissions || acl.file);\n        if (access) {\n            access = access.toString(16).padStart(3, '0');\n        }\n\n        return <div className={this.props.classes['itemAccess' + this.state.viewType]}> <IconButton\n            onClick={() => this.setState({ modalEditOfAccess: true })}\n            className={this.props.classes['itemAclButton' + this.state.viewType]}>{access || '---'}</IconButton></div>;\n    }\n\n    getFileIcon(ext) {\n        switch (ext) {\n            case 'json':\n                return (<JsonIcon className={this.props.classes['itemIcon' + this.state.viewType]} />);\n\n            case 'css':\n                return (<CssIcon className={this.props.classes['itemIcon' + this.state.viewType]} />);\n\n            case 'js':\n            case 'ts':\n                return (<JSIcon className={this.props.classes['itemIcon' + this.state.viewType]} />);\n\n            case 'html':\n            case 'md':\n                return (<HtmlIcon className={this.props.classes['itemIcon' + this.state.viewType]} />);\n\n            case 'mp3':\n            case 'ogg':\n            case 'wav':\n            case 'm4a':\n            case 'mp4':\n            case 'flac':\n                return (<MusicIcon className={this.props.classes['itemIcon' + this.state.viewType]} />);\n\n            default:\n                return (<FileIcon className={this.props.classes['itemIcon' + this.state.viewType]} />);\n        }\n    }\n\n    getEditFile(ext) {\n        switch (ext) {\n            case 'json':\n            case 'js':\n            case 'html':\n            case 'txt':\n                return true;\n            default:\n                return false;\n        }\n    }\n\n    setStateBackgroundImage = () => {\n        let array = ['light', 'dark', 'colored', 'delete'];\n        this.setState(({ backgroundImage }) => {\n            if (array.indexOf(backgroundImage) !== -1 && array.length - 1 !== array.indexOf(backgroundImage)) {\n                window.localStorage.setItem('files.backgroundImage', array[array.indexOf(backgroundImage) + 1]);\n                return { backgroundImage: array[array.indexOf(backgroundImage) + 1] }\n            } else {\n                window.localStorage.setItem('files.backgroundImage', array[0]);\n                return { backgroundImage: array[0] }\n            }\n        })\n    }\n\n    getClassBackgroundImage = () => {\n        //['light', 'dark', 'colored', 'delete']\n        switch (this.state.backgroundImage) {\n            case 'light':\n                return this.props.classes.backgroundImageLight;\n            case 'dark':\n                return this.props.classes.backgroundImageDark;\n            case 'colored':\n                return this.props.classes.backgroundImageColored;\n            case 'delete':\n                return null;\n            default:\n                return null;\n        }\n    }\n\n    renderFile(item) {\n        const padding = this.state.viewType === TABLE ? item.level * this.levelPadding : 0;\n        const ext = Utils.getFileExtension(item.name);\n\n        return <div\n            key={item.id}\n            id={item.id}\n            onDoubleClick={() => {\n                if (!this.props.onSelect) {\n                    this.setState({ viewer: this.imagePrefix + item.id });\n                } else if (\n                    (!this.props.filterFiles || this.props.filterFiles.includes(item.ext)) &&\n                    (!this.props.filterByType || EXTENSIONS[this.props.filterByType].includes(item.ext))\n                ) {\n                    this.props.onSelect(item.id, true);\n                }\n            }}\n            onClick={e => this.select(item.id, e)}\n            style={this.state.viewType === TABLE ? { marginLeft: padding, width: 'calc(100% - ' + padding + 'px)' } : {}}\n            className={Utils.clsx(\n                'browserItem',\n                this.props.classes['item' + this.state.viewType],\n                this.props.classes['itemFile' + this.state.viewType],\n                this.state.selected === item.id && this.props.classes.itemSelected\n            )}\n        >\n            {EXTENSIONS.images.includes(ext) ?\n                <img\n                    onError={e => { e.target.onerror = null; e.target.src = NoImage }}\n                    className={Utils.clsx(this.props.classes['itemImage' + this.state.viewType], this.getClassBackgroundImage())}\n                    src={this.imagePrefix + item.id} alt={item.name}\n                />\n                :\n                this.getFileIcon(ext)}\n            <div className={this.props.classes['itemName' + this.state.viewType]}>{item.name}</div>\n            <Hidden xsDown>{this.formatSize(item.size)}</Hidden>\n            <Hidden xsDown>{this.state.viewType === TABLE ? this.formatAcl(item.acl) : null}</Hidden>\n            <Hidden xsDown>{this.state.viewType === TABLE && this.props.expertMode && this.getEditFile(ext) ?\n                <IconButton aria-label=\"delete\"\n                    onClick={(e) => {\n                        e.stopPropagation();\n                        if (!this.props.onSelect) {\n                            this.setState({ viewer: this.imagePrefix + item.id, formatEditFile: ext });\n                        } else if (\n                            (!this.props.filterFiles || this.props.filterFiles.includes(item.ext)) &&\n                            (!this.props.filterByType || EXTENSIONS[this.props.filterByType].includes(item.ext))\n                        ) {\n                            this.props.onSelect(item.id, true);\n                        }\n                    }}\n                    className={this.props.classes['itemDeleteButton' + this.state.viewType]}\n                >\n                    <EditIcon fontSize=\"small\" />\n                </IconButton>\n                :\n                <div className={this.props.classes['itemDeleteButton' + this.state.viewType]} />}\n                </Hidden>\n            {this.state.viewType === TABLE && this.props.allowDownload ? <IconButton\n                download\n                href={this.imagePrefix + item.id}\n                className={this.props.classes['itemDownloadButton' + this.state.viewType]}\n                onClick={e => e.stopPropagation()}\n            ><DownloadIcon /></IconButton> : null}\n\n            {this.state.viewType === TABLE &&\n                this.props.allowDelete &&\n                item.id !== 'vis.0/' &&\n                item.id !== USER_DATA &&\n                (this.state.expertMode || item.id.startsWith(USER_DATA) || item.id.startsWith('vis.0/'))\n                ?\n                <IconButton aria-label=\"delete\"\n                    onClick={e => {\n                        e.stopPropagation();\n                        if (this.suppressDeleteConfirm > Date.now()) {\n                            this.deleteItem(item.id);\n                        } else {\n                            this.setState({ deleteItem: item.id });\n                        }\n                    }}\n                    className={this.props.classes['itemDeleteButton' + this.state.viewType]}\n                >\n                    <DeleteIcon fontSize=\"small\" />\n                </IconButton>\n                :\n                (this.state.viewType === TABLE && this.props.allowDelete ?\n                    <div className={this.props.classes['itemDeleteButton' + this.state.viewType]} />\n                    :\n                    null\n                )\n            }\n        </div>;\n    }\n\n    renderItems(folderId) {\n        if (folderId &&\n            folderId !== '/' &&\n            !this.state.expertMode &&\n            folderId !== USER_DATA && !folderId.startsWith(USER_DATA) &&\n            folderId !== 'vis.0'   && !folderId.startsWith('vis.0/')\n        ) {\n            return null;\n        }\n\n        // tile\n        if (this.state.folders && this.state.folders[folderId]) {\n            if (this.state.viewType === TILE) {\n                const res = [];\n                if (folderId && folderId !== '/') {\n                    res.push(this.renderBackFolder())\n                }\n                this.state.folders[folderId].forEach(item => {\n                    if (!this.state.expertMode &&\n                        item.id !== USER_DATA && !item.id.startsWith(USER_DATA) &&\n                        item.id !== 'vis.0'   && !item.id.startsWith('vis.0/')\n                    ) {\n                        return;\n                    }\n                    if (item.folder) {\n                        res.push(this.renderFolder(item));\n                    } else if (\n                        (!this.props.filterFiles || this.props.filterFiles.includes(item.ext)) &&\n                        (!this.props.filterByType || EXTENSIONS[this.props.filterByType].includes(item.ext))\n                    ) {\n                        res.push(this.renderFile(item));\n                    }\n                });\n                return res;\n            } else {\n                return this.state.folders[folderId].map(item => {\n                    const res = [];\n                    if (item.id &&\n                        item.id !== '/' &&\n                        !this.state.expertMode &&\n                        item.id !== USER_DATA &&\n                        !item.id.startsWith(USER_DATA) &&\n                        item.id !== 'vis.0' &&\n                        !item.id.startsWith('vis.0/')) {\n                        return null;\n                    }\n\n                    if (item.folder) {\n                        const expanded = this.state.expanded.includes(item.id);\n\n                        res.push(this.renderFolder(item, expanded));\n                        if (this.state.folders[item.id] && expanded) {\n                            res.push(this.renderItems(item.id))\n                        }\n                    } else if (\n                        (!this.props.filterFiles || this.props.filterFiles.includes(item.ext)) &&\n                        (!this.props.filterByType || EXTENSIONS[this.props.filterByType].includes(item.ext))\n                    ) {\n                        res.push(this.renderFile(item));\n                    } else {\n                        return null;\n                    }\n\n                    return res;\n                });\n            }\n        } else {\n            return <div style={{position: 'relative'}}>\n                <CircularProgress key={folderId} color=\"secondary\" size={24}/>\n                <div style={{position: 'absolute', zIndex: 2, top: 4, width: 24, textAlign: 'center'}} >{this.state.queueLength}</div>\n            </div>;\n        }\n    }\n\n    renderToolbar() {\n        return <Toolbar key=\"toolbar\" variant=\"dense\">\n            {this.props.showExpertButton ? <IconButton\n                edge=\"start\"\n                title={this.props.t('ra_Toggle expert mode')}\n                className={Utils.clsx(this.props.classes.menuButton, this.state.expertMode && this.props.classes.menuButtonExpertActive)}\n                aria-label=\"expert mode\"\n                onClick={() => this.setState({ expertMode: !this.state.expertMode })}\n            ><ExpertIcon /></IconButton> : null}\n            {this.props.showViewTypeButton ? <IconButton\n                edge=\"start\"\n                title={this.props.t('ra_Toggle view mode')}\n                className={this.props.classes.menuButton}\n                aria-label=\"view mode\"\n                onClick={() => {\n                    const viewType = this.state.viewType === TABLE ? TILE : TABLE;\n                    window.localStorage.setItem('files.viewType', viewType);\n                    let currentDir = this.state.selected;\n                    if (isFile(currentDir)) {\n                        currentDir = getParentDir(currentDir)\n                    }\n                    this.setState({ viewType, currentDir }, () => {\n                        if (this.state.viewType === TABLE) {\n                            this.scrollToSelected();\n                        }\n                    });\n                }}\n            >{this.state.viewType !== TABLE ? <IconList /> : <IconTile />}</IconButton> : null}\n            <IconButton\n                edge=\"start\"\n                title={this.props.t('ra_Hide empty folders')}\n                className={this.props.classes.menuButton}\n                color={this.state.filterEmpty ? 'secondary' : 'inherit'}\n                aria-label=\"filter empty\"\n                onClick={() => {\n                    window.localStorage.setItem('file.empty', !this.state.filterEmpty);\n                    this.setState({ filterEmpty: !this.state.filterEmpty });\n                }}\n            ><EmptyFilterIcon /></IconButton>\n            <IconButton\n                edge=\"start\"\n                title={this.props.t('ra_Reload files')}\n                className={this.props.classes.menuButton}\n                color={'inherit'}\n                aria-label=\"reload files\"\n                onClick={() => this.setState({ folders: {} }, () => this.loadFolders())}\n            ><RefreshIcon /></IconButton>\n            {this.props.allowCreateFolder ? <IconButton\n                edge=\"start\"\n                disabled={this.state.expertMode ? !this.state.selected : !this.state.selected.startsWith('vis.0') && !this.state.selected.startsWith(USER_DATA)}\n                title={this.props.t('ra_Create folder')}\n                className={this.props.classes.menuButton}\n                color={'inherit'}\n                aria-label=\"add folder\"\n                onClick={() => this.setState({ addFolder: true })}\n            ><AddFolderIcon /></IconButton> : null}\n            {this.props.allowUpload ? <IconButton\n                edge=\"start\"\n                disabled={this.state.expertMode ? !this.state.selected : !this.state.selected.startsWith('vis.0') && !this.state.selected.startsWith(USER_DATA)}\n                title={this.props.t('ra_Upload file')}\n                className={this.props.classes.menuButton}\n                color={'inherit'}\n                aria-label=\"upload file\"\n                onClick={() =>\n                    this.setState({uploadFile: true})}\n            ><UploadIcon /></IconButton> : null}\n            <Tooltip title={this.props.t('Background image')}>\n                <IconButton\n                    color={'inherit'}\n                    edge=\"start\"\n                    className={this.props.classes.menuButton}\n                    onClick={this.setStateBackgroundImage}\n                >\n                    <Brightness5Icon />\n                </IconButton>\n            </Tooltip>\n        </Toolbar>;\n    }\n\n    findItem(id, folders) {\n        folders = folders || this.state.folders;\n        if (!folders) {\n            return null;\n        }\n        const parts = id.split('/');\n        parts.pop();\n        const parentFolder = parts.join('/') || '/';\n        if (!folders[parentFolder]) {\n            return null;\n        }\n        return folders[parentFolder].find(item => item.id === id);\n    }\n\n    renderInputDialog() {\n        if (this.state.addFolder) {\n            let parentFolder = this.findFirstFolder(this.state.selected);\n\n            if (!parentFolder) {\n                return window.alert(this.props.t('ra_Invalid parent folder!'));\n            }\n\n            return <TextInputDialog\n                key=\"inputDialog\"\n                applyText={this.props.t('ra_Create')}\n                cancelText={this.props.t('ra_Cancel')}\n                titleText={this.props.t('ra_Create new folder in %s', this.state.selected)}\n                promptText={this.props.t('ra_If no file will be created in the folder, it will disappear after the browser closed')}\n                labelText={this.props.t('ra_Folder name')}\n                verify={text => this.state.folders[parentFolder].find(item => item.name === text) ? '' : this.props.t('ra_Duplicate name')}\n                onClose={name => {\n                    if (name) {\n                        const folders = {};\n                        Object.keys(this.state.folders).forEach(folder => folders[folder] = this.state.folders[folder]);\n                        const parent = this.findItem(parentFolder);\n                        const id = parentFolder + '/' + name;\n                        folders[parentFolder].push({\n                            id: id,\n                            level: parent.level + 1,\n                            name,\n                            folder: true,\n                            temp: true,\n                        });\n\n                        folders[parentFolder].sort(sortFolders);\n\n                        folders[id] = [];\n                        const expanded = [...this.state.expanded];\n                        if (!expanded.includes(parentFolder)) {\n                            expanded.push(parentFolder);\n                            expanded.sort();\n                        }\n                        window.localStorage.setItem('files.expanded', JSON.stringify(expanded));\n                        this.setState({ addFolder: false, folders, expanded }, () =>\n                            this.select(id));\n                    } else {\n                        this.setState({ addFolder: false });\n                    }\n                }}\n                replace={text => text.replace(/[^-_\\w\\d]/, '_')}\n            />;\n        } else {\n            return null;\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        this.setOpacityTimer && clearTimeout(this.setOpacityTimer);\n        this.setOpacityTimer = setTimeout(() => {\n            this.setOpacityTimer = null;\n            const items = window.document.getElementsByClassName('browserItem');\n            for (let i = 0; i < items.length; i++) {\n                items[i].style.opacity = 1;\n            }\n        }, 100);\n    }\n\n    uploadFile(fileName, data) {\n        const parts = fileName.split('/');\n        const adapter = parts.shift();\n        return this.props.socket.writeFile64(adapter, parts.join('/'), data)\n            .catch(e => window.alert('Cannot write file: ' + e));\n    }\n\n    findFirstFolder(id) {\n        let parentFolder = id;\n        let item = this.findItem(parentFolder);\n        // find folder\n        if (item && !item.folder) {\n            const parts = parentFolder.split('/');\n            parts.pop();\n            parentFolder = '';\n            while (parts.length) {\n                const item = this.findItem(parts.join('/'));\n                if (item && item.folder) {\n                    parentFolder = parts.join('/');\n                    break;\n                }\n            }\n        }\n\n        return parentFolder;\n    }\n\n    renderUpload() {\n        if (this.state.uploadFile) {\n            return [\n                <Fab key=\"close\" color=\"primary\" aria-label=\"close\" className={this.props.classes.uploadCloseButton}\n                    onClick={() => this.setState({ uploadFile: false })}>\n                    <CloseIcon />\n                </Fab>,\n                <Dropzone\n                    key=\"dropzone\"\n                    onDragEnter={() => this.setState({ uploadFile: 'dragging' })}\n                    onDragLeave={() => this.setState({ uploadFile: true })}\n                    onDrop={acceptedFiles => {\n                        let count = acceptedFiles.length;\n                        acceptedFiles.forEach(file => {\n                            const reader = new FileReader();\n\n                            reader.onabort = () => console.log('file reading was aborted');\n                            reader.onerror = () => console.log('file reading has failed');\n                            reader.onload  = () => {\n                                let parentFolder = this.findFirstFolder(this.state.selected);\n\n                                if (!parentFolder) {\n                                    return window.alert(this.props.t('ra_Invalid parent folder!'));\n                                }\n                                const id = parentFolder + '/' + file.name;\n                                this.uploadFile(id, reader.result)\n                                    .then(() => {\n                                        if (!--count) {\n                                            const folders = {};\n                                            Object.keys(this.state.folders).forEach(name => {\n                                                if (name !== parentFolder && !name.startsWith(parentFolder + '/')) {\n                                                    folders[name] = this.state.folders[name];\n                                                }\n                                            });\n                                            this.setState({ uploadFile: false, folders }, () =>\n                                                this.browseFolders([...this.state.expanded], folders)\n                                                    .then(folders => {\n                                                        // open current folder\n                                                        const expanded = [...this.state.expanded];\n                                                        if (!expanded.includes(parentFolder)) {\n                                                            expanded.push(parentFolder);\n                                                            expanded.sort();\n                                                            window.localStorage.setItem('files.expanded', JSON.stringify(expanded));\n                                                        }\n                                                        this.setState({ folders, expanded }, () =>\n                                                            this.select(id))\n                                                    }));\n                                        }\n                                    });\n                            };\n\n                            reader.readAsArrayBuffer(file);\n                        });\n                    }}\n                >\n                    {({ getRootProps, getInputProps }) => (\n                        <div className={Utils.clsx(this.props.classes.uploadDiv, this.state.uploadFile === 'dragging' && this.props.classes.uploadDivDragging)}\n                            {...getRootProps()}>\n                            <input {...getInputProps()} />\n                            <div className={this.props.classes.uploadCenterDiv}>\n                                <div className={this.props.classes.uploadCenterTextAndIcon}>\n                                    <UploadIcon className={this.props.classes.uploadCenterIcon} />\n                                    <div className={this.props.classes.uploadCenterText}>{\n                                        this.state.uploadFile === 'dragging' ? this.props.t('ra_Drop file here') :\n                                            this.props.t('ra_Place your files here or click here to open the browse dialog')}</div>\n                                </div>\n                            </div>\n                        </div>)}\n                </Dropzone>\n            ];\n        } else {\n            return null;\n        }\n    }\n\n    deleteRecursive(id) {\n        const item = this.findItem(id);\n        if (item.folder) {\n            return (this.state.folders[id] ? Promise.all(this.state.folders[id].map(item =>\n                    this.deleteRecursive(item.id))) : Promise.resolve())\n                .then(() => {\n                    // If it is folder of second level\n                    if (item.level >= 1) {\n                        const parts = id.split('/');\n                        const adapter = parts.shift();\n                        this.props.socket.deleteFolder(adapter, parts.join('/'))\n                            .then(() => {\n                                // remove this folder\n                                const folders = JSON.parse(JSON.stringify(this.state.folders));\n                                delete folders[item.id];\n                                // delete folder from parent item\n                                const parentId = getParentDir(item.id);\n                                const parentFolder = folders[parentId];\n                                if (parentFolder) {\n                                    const pos = parentFolder.indexOf(parentFolder.find(f => f.id === item.id));\n                                    if (pos !== -1) {\n                                        parentFolder.splice(pos, 1);\n                                    }\n\n                                    this.select(parentId, () =>\n                                        this.setState({folders}));\n                                }\n                            });\n                    }\n                });\n        } else {\n            const parts = id.split('/');\n            const adapter = parts.shift();\n            if (parts.length) {\n                return this.props.socket.deleteFile(adapter, parts.join('/'))\n                    .catch(e => window.alert('Cannot delete file: ' + e));\n            } else {\n                return Promise.resolve();\n            }\n        }\n    }\n\n    deleteItem(deleteItem) {\n        deleteItem = deleteItem || this.state.deleteItem;\n\n        this.setState({ deleteItem: '' }, () =>\n            this.deleteRecursive(deleteItem)\n                .then(() => {\n                    const pos = this.state.expanded.indexOf(deleteItem);\n                    if (pos !== -1) {\n                        const expanded = [...this.state.expanded];\n                        expanded.splice(pos, 1);\n                        window.localStorage.setItem('files.expanded', JSON.stringify(expanded));\n                        this.setState({ expanded });\n                    }\n                    /*let parentFolder = this.findFirstFolder(deleteItem);\n                    const folders = {};\n                    Object.keys(this.state.folders).forEach(name => {\n                        if (name !== parentFolder && !name.startsWith(parentFolder + '/')) {\n                            folders[name] = this.state.folders[name];\n                        }\n                    });\n                    this.setState({ folders }, () =>\n                        this.browseFolders([...this.state.expanded], folders)\n                            .then(folders => this.setState({ folders })));*/\n                })\n        );\n    }\n\n    renderDeleteDialog() {\n        if (this.state.deleteItem) {\n            return <Dialog key=\"deleteDialog\" open={true} onClose={() => this.setState({ deleteItem: '' })} aria-labelledby=\"form-dialog-title\">\n                <DialogTitle id=\"form-dialog-title\">{this.props.t('ra_Confirm deletion of %s', this.state.deleteItem.split('/').pop())}</DialogTitle>\n                <DialogContent>\n                    <DialogContentText>\n                        {this.props.t('ra_Are you sure?')}\n                    </DialogContentText>\n                </DialogContent>\n                <DialogActions>\n                    <Button variant=\"contained\" onClick={() => {\n                        this.suppressDeleteConfirm = Date.now() + 60000 * 5;\n                        this.deleteItem();\n                    }} >{this.props.t('ra_Delete (no confirm for 5 mins)')}</Button>\n                    <Button variant=\"contained\" onClick={() => this.deleteItem()} color=\"primary\" autoFocus>{this.props.t('ra_Delete')}</Button>\n                    <Button variant=\"contained\" onClick={() => this.setState({ deleteItem: '' })} >{this.props.t('ra_Cancel')}</Button>\n                </DialogActions>\n            </Dialog>;\n        } else {\n            return false;\n        }\n    }\n\n    renderViewDialog() {\n        return this.state.viewer ? <FileViewer\n            key={this.state.viewer}\n            href={this.state.viewer}\n            formatEditFile={this.state.formatEditFile}\n            themeName={this.props.themeName}\n            setStateBackgroundImage={this.setStateBackgroundImage}\n            getClassBackgroundImage={this.getClassBackgroundImage}\n            t={this.props.t}\n            socket={this.props.socket}\n            lang={this.props.lang}\n            expertMode={this.state.expertMode}\n            onClose={() => this.setState({ viewer: '', formatEditFile: '' })}\n        /> : null;\n    }\n\n    renderError() {\n        if (this.state.errorText) {\n            return <ErrorDialog key=\"errorDialog\" text={this.state.errorText} onClose={() => this.setState({ errorText: '' })} />;\n        } else {\n            return null;\n        }\n    }\n\n    updateItemsAcl(info) {\n        const folders = JSON.parse(JSON.stringify(this.state.folders));\n        let changed;\n        info.forEach(it => {\n            const item = this.findItem(it.id, folders);\n            if (item && JSON.stringify(item.acl) !== JSON.stringify(it.acl)) {\n                item.acl = it.acl;\n                changed = true;\n            }\n        });\n        changed && this.setState({ folders });\n    }\n\n    changeToPath() {\n        setTimeout(() => {\n            if (this.state.path !== this.state.selected && (!this.lastSelect || Date.now() - this.lastSelect > 100)) {\n                let folder = this.state.path;\n                if (isFile(this.state.path)) {\n                    folder = getParentDir(this.state.path);\n                }\n                return new Promise(resolve => {\n                    if (!this.state.folders[folder]) {\n                        return this.browseFolder(folder)\n                            .then(folders => this.setState({ folders }, () => resolve(true)))\n                            .catch(err => this.setState({ errorText: err === NOT_FOUND ? this.props.t('re_Cannot find \"%s\"', folder) : this.props.t('re_Cannot read \"%s\"', folder) }));\n                    } else {\n                        return resolve(true);\n                    }\n                })\n                    .then(result =>\n                        result && this.setState({ selected: this.state.path, currentDir: folder, pathFocus: false }));\n            } else if (!this.lastSelect || Date.now() - this.lastSelect > 100) {\n                this.setState({ pathFocus: false });\n            }\n        }, 100);\n    }\n\n    renderBreadcrumb() {\n        const parts = this.state.selected.startsWith('/') ? this.state.selected.split('/') : ('/' + this.state.selected).split('/');\n        const p = [];\n        return parts.map((part, i) => {\n            part && p.push(part);\n            const path = p.join('/');\n            if (i < parts.length - 1) {\n                return [\n                    <div key={this.state.selected + '_' + i} className={this.props.classes.pathDivBreadcrumbDir} onClick={e => this.changeFolder(e, path || '/')}>\n                        {part || this.props.t('re_Root')}\n                    </div>,\n                    <span key={this.state.selected + '_s_' + i} className={this.props.classes.pathDivBreadcrumbSlash}>{'>'}</span>];\n            } else {\n                return <div key={this.state.selected + '_' + i} className={this.props.classes.pathDivBreadcrumbFile} onClick={() => this.setState({ pathFocus: true })}>{part}</div>;\n            }\n        });\n    }\n\n    renderPath() {\n        return <div key=\"path\" className={Utils.clsx(this.props.classes.pathDiv, !this.state.pathFocus && this.props.classes.pathDivBreadcrumb)}>\n            {this.state.pathFocus ?\n                <Input\n                    value={this.state.path}\n                    onKeyDown={e => e.keyCode === 13 && this.changeToPath()}\n                    onBlur={e => this.changeToPath()}\n                    onChange={e => this.setState({ path: e.target.value })}\n                    className={this.props.classes.pathDivInput}\n                />\n                :\n                this.renderBreadcrumb()\n            }\n        </div>;\n    }\n\n    render() {\n        if (!this.props.ready) {\n            return <LinearProgress key={this.props.key ? this.props.key + '_c' : 'c'} />;\n        }\n\n        if (this.state.loadAllFolders && !this.foldersLoading) {\n            this.foldersLoading = true;\n            setTimeout(() => {\n                this.setState({loadAllFolders: false, folders: {}}, () => {\n                    this.foldersLoading = false;\n                    this.loadFolders();\n                });\n            }, 300);\n        }\n\n\n        return <div key={this.props.key} style={this.props.style} className={Utils.clsx(this.props.classes.root, this.props.className)}>\n            {this.props.showToolbar ? this.renderToolbar() : null}\n            {this.state.viewType === TILE ? this.renderPath() : null}\n            <div key=\"items\" className={Utils.clsx(this.props.classes.filesDiv, this.props.classes['filesDiv' + this.state.viewType])}>\n                {this.state.viewType === TABLE ? this.renderItems('/') : this.renderItems(this.state.currentDir || '/')}\n            </div>\n            {this.props.allowUpload ? this.renderInputDialog() : null}\n            {this.props.allowUpload ? this.renderUpload() : null}\n            {this.props.allowDelete ? this.renderDeleteDialog() : null}\n            {this.props.allowView ? this.renderViewDialog() : null}\n            {this.state.modalEditOfAccess && this.props.modalEditOfAccessControl && this.props.modalEditOfAccessControl(this, this.state.modalEditOfAccessObjData)}\n            {this.renderError()}\n        </div>;\n    }\n}\n\nFileBrowser.defaultProps = {\n    objectAddBoolean: false,\n    objectEditBoolean: false,\n    objectStatesView: false,\n    objectImportExport: false,\n    objectEditOfAccessControl: false,\n    modalNewObject: () => { },\n    modalEditOfAccessControl: () => { },\n}\n\nFileBrowser.propTypes = {\n    key: PropTypes.string,\n    style: PropTypes.object,\n    className: PropTypes.string,\n    t: PropTypes.func,\n    lang: PropTypes.string,\n    socket: PropTypes.object,\n    ready: PropTypes.bool,\n    expertMode: PropTypes.bool,\n    showToolbar: PropTypes.bool,\n    allowUpload: PropTypes.bool,\n    allowDownload: PropTypes.bool,\n    allowCreateFolder: PropTypes.bool,\n    allowDelete: PropTypes.bool,\n    allowView: PropTypes.bool,\n    imagePrefix: PropTypes.string,\n    showExpertButton: PropTypes.bool,\n    viewType: PropTypes.string,\n    showViewTypeButton: PropTypes.bool,\n\n    selected: PropTypes.string,\n    tileView: PropTypes.bool,\n    filterFiles: PropTypes.array, // like ['png', 'svg', 'bmp', 'jpg', 'jpeg']\n    filterByType: PropTypes.string, // images, code or txt from FileViewer.EXTENSIONS\n    onSelect: PropTypes.func, // function (id, isDoubleClick)\n};\n\n/** @type {typeof FileBrowser} */\nconst _export = withWidth()(withStyles(styles)(FileBrowser));\nexport default _export;","import React, { useEffect, useState } from 'react';\nimport { Checkbox, LinearProgress, Switch } from '@material-ui/core';\n\nimport I18n from '@iobroker/adapter-react/i18n';\n\nimport Utils from '../Utils';\nimport CustomModal from '../components/CustomModal';\nimport SelectWithIcon from '@iobroker/adapter-react/Components/SelectWithIcon';\n\nconst readWriteArray = [\n    {\n        Owner: [\n            { name: 'read', valueNum: 0x400, title: 'read owner' },\n            { name: 'write', valueNum: 0x200, title: 'write owner' }\n        ]\n    },\n    {\n        Group: [\n            { name: 'read', valueNum: 0x40, title: 'read group' },\n            { name: 'write', valueNum: 0x20, title: 'write group' }\n        ]\n    },\n    {\n        Everyone: [\n            { name: 'read', valueNum: 0x4, title: 'read everyone' },\n            { name: 'write', valueNum: 0x2, title: 'write everyone' }\n        ]\n    },\n];\n\nconst newValueAccessControl = (value, newValue, mask) => {\n    value |= newValue & mask;\n    value &= newValue | (~mask & 0xFFFF);\n    return value;\n}\n\nconst ObjectRights = ({ value, setValue, t, differentValues, applyToChildren, mask, setMask, disabled }) => {\n    useEffect(() => {\n        if (applyToChildren) {\n            let _checkDifferent = 0;\n            for (let e = 0; e < differentValues.length; e++) {\n                _checkDifferent |= value ^ differentValues[e];\n            }\n            setMask(_checkDifferent);\n        } else {\n            setMask(0);\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [differentValues, applyToChildren]);\n\n    let newSelected = value;\n\n    return <div style={{\n        display: 'flex',\n        width: 'fit-content',\n        margin: 20,\n        border: '1px solid',\n        borderLeft: 0\n    }}>\n        {readWriteArray.map(el => {\n            const name = Object.keys(el)[0];\n            return <div style={{\n                width: 150,\n                height: 150,\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n                borderLeft: '1px solid'\n            }} key={name} >\n                <div style={{\n                    height: 50,\n                    display: 'flex',\n                    alignItems: 'center',\n                    fontSize: 18,\n                    borderBottom: '1px solid silver',\n                    width: '100%',\n                    justifyContent: 'center'\n                }}>{t(name)}</div>\n                <div style={{\n                    display: 'flex',\n                    width: '100%'\n                }}>\n                    {el[name].map((obj, idx) => {\n                        let bool = false;\n                        if (newSelected - obj.valueNum >= 0) {\n                            newSelected = newSelected - obj.valueNum;\n                            bool = true;\n                        }\n                        return <div style={{\n                            display: 'flex',\n                            flexDirection: 'column',\n                            flex: 1,\n                            alignItems: 'center',\n                            borderRight: idx === 0 ? '1px solid' : 0\n                        }} key={obj.valueNum}>\n                            <div style={{\n                                height: 50,\n                                borderBottom: '1px solid',\n                                width: '100%',\n                                justifyContent: 'center',\n                                display: 'flex',\n                                alignItems: 'center',\n                                color: 'silver'\n                            }}>{t(obj.name)}</div>\n                            <div style={{ height: 50, display: 'flex' }}>\n                                <Checkbox\n                                    disabled={disabled}\n                                    checked={bool}\n                                    color={mask & obj.valueNum ? 'primary' : 'secondary'}\n                                    indeterminate={!!(mask & obj.valueNum)}\n                                    style={mask & obj.valueNum ? { opacity: 0.5 } : null}\n                                    onChange={e => {\n                                        if (mask & obj.valueNum) {\n                                            mask &= (~obj.valueNum) & 0xFFFF;\n                                            setMask(mask);\n                                        }\n                                        let newValue = value;\n                                        if (!e.target.checked) {\n                                            newValue &= (~obj.valueNum) & 0xFFFF;\n                                        } else {\n                                            newValue |= obj.valueNum;\n                                        }\n                                        setValue(newValue);\n                                    }}\n                                />\n                            </div>\n                        </div>\n                    })}\n                </div>\n            </div>\n        })}\n    </div>;\n}\n\nasync function loadFolders(folderId, folders, socket) {\n    let files = folders[folderId];\n    if (!files) {\n        const parts = folderId.split('/');\n        const level = parts.length;\n        const adapter = parts.shift();\n        const relPath = parts.join('/');\n        files = await socket.readDir(adapter, relPath);\n        folders[folderId] = [];\n        for (let f = 0; f < files.length; f++) {\n            const file = files[f];\n            const item = {\n                id: folderId + '/' + file.file,\n                ext: Utils.getFileExtension(file.file),\n                folder: file.isDir,\n                name: file.file,\n                size: file.stats && file.stats.size,\n                modified: file.modifiedAt,\n                acl: file.acl,\n                level\n            };\n            folders[folderId].push(item);\n        }\n    }\n\n    for (let f = 0; f < files.length; f++) {\n        const item = files[f];\n        if (item.folder) {\n            await loadFolders(item.id, folders, socket);\n        }\n    }\n}\n\nfunction flatList(folders) {\n    const list = {};\n\n    Object.keys(folders)\n        .forEach(key => {\n            list[key] = {\n                folder: true\n            };\n            folders[key].forEach(item => {\n                list[item.id] = item;\n            });\n        });\n\n    return list;\n}\n\nasync function loadPath(socket, folders, path, adapter, part, level) {\n    if (typeof path === 'string') {\n        path = path.split('/');\n        level = 0;\n        adapter = path.shift();\n        part = '';\n    }\n\n    if (path.length >= level) {\n        return;\n    }\n\n    if (folders[adapter + part]) {\n        if (path.length - 1 === level) {\n            // try to find file\n            const aa = adapter + part + '/' + path[level];\n            const ff = folders[adapter + part].find(item => item.id === aa);\n            if (ff && ff.folder) {\n                // load all\n                await loadFolders(adapter + part, folders, socket);\n            }\n            return;\n        }\n        part += '/' + path[level];\n\n        await loadPath(socket, folders, path, adapter, part, level + 1);\n    } else {\n        // load path\n        const files = await socket.readDir(adapter, part);\n        folders[adapter + part] = [];\n        files.forEach(file => {\n            const item = {\n                id:       part + '/' + file.file,\n                ext:      Utils.getFileExtension(file.file),\n                folder:   file.isDir,\n                name:     file.file,\n                size:     file.stats && file.stats.size,\n                modified: file.modifiedAt,\n                acl:      file.acl,\n                level\n            };\n\n            folders[adapter + part].push(item);\n        });\n\n        await loadPath(socket, folders, path, adapter, part, level + 1);\n    }\n}\n\nconst DIFFERENT = 'different';\n\nconst FileEditOfAccessControl2 = ({ onClose, onApply, open, selected, extendObject, objects, t, themeType, folders, socket }) => {\n    const select = selected.substring(0, selected.lastIndexOf('/')) || selected;\n    const object = selected.split('/').length === 1 ? folders['/'].find(({ id }) => id === selected) : folders[select].find(({ id }) => id === selected);\n    const [stateOwnerUser, setStateOwnerUser] = useState(null);\n    const [stateOwnerGroup, setStateOwnerGroup] = useState(null);\n    const [users, setUsers] = useState([]);\n    const [groups, setGroups] = useState([]);\n    const [applyToChildren, setApplyToChildren] = useState(false);\n    const [childrenCount, setChildrenCount] = useState(0);\n    const [valueFileAccessControl, setValueFileAccessControl] = useState(null);\n    const [differentOwner, setDifferentOwner] = useState(false);\n    const [differentGroup, setDifferentGroup] = useState(false);\n    const [differentObject, setDifferentObject] = useState([]);\n    const [maskObject, setMaskObject] = useState(0);\n    const [ids, setIds] = useState([]);\n    const [disabledButton, setDisabledButton] = useState(true);\n    const [progress, setProgress] = useState(false);\n\n    const lang = I18n.getLanguage();\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    useEffect(async () => {\n        let _differentObject = [];\n\n        let id = object.id;\n\n        let _differentOwner = false;\n        let _differentGroup = false;\n        let _stateOwnerUser = null;\n        let _stateOwnerGroup = null;\n        let _valueFileAccessControl = null;\n        const _ids = [];\n        let count = 0\n\n        await loadPath(socket, folders, id);\n\n        const list = flatList(folders);\n\n        let idWithSlash = id + '/';\n\n        Object.keys(list).forEach(key => {\n            if (key === '/') {\n                return;\n            }\n\n            if (key === id || key.startsWith(idWithSlash)) {\n                if (!key.includes('/') && objects[key]) { // it is object\n                    const objFolder = objects[key];\n                    count++;\n                    _ids.push(objFolder);\n\n                    if (_valueFileAccessControl === null && objFolder.acl.file !== undefined) {\n                        _valueFileAccessControl = objFolder.acl.file;\n                    }\n                    if (_stateOwnerUser === null && objFolder.acl.owner !== undefined) {\n                        _stateOwnerUser = objFolder.acl.owner;\n                    }\n                    if (_stateOwnerGroup === null && objFolder.acl.ownerGroup !== undefined) {\n                        _stateOwnerGroup = objFolder.acl.ownerGroup;\n                    }\n\n                    if (!differentOwner && _stateOwnerUser !== objFolder.acl.owner && objFolder.acl.owner !== undefined) {\n                        _differentOwner = true;\n                    }\n                    if (!differentGroup && _stateOwnerGroup !== objFolder.acl.ownerGroup && objFolder.acl.ownerGroup !== undefined) {\n                        _differentGroup = true;\n                    }\n                    if (objFolder.acl.file !== undefined && _valueFileAccessControl !== objFolder.acl.file && !_differentObject.includes(objFolder.acl.file)) {\n                        _differentObject.push(objFolder.acl.file);\n                    }\n                } else if (!list[key].folder) {\n                    count++;\n                    const keyFolder = list[key];\n                    _ids.push(keyFolder);\n                    if (_valueFileAccessControl === null && keyFolder.acl.permissions !== undefined) {\n                        _valueFileAccessControl = keyFolder.acl.permissions;\n                    }\n                    if (_stateOwnerUser === null && keyFolder.acl.owner !== undefined) {\n                        _stateOwnerUser = keyFolder.acl.owner;\n                    }\n                    if (_stateOwnerGroup === null && keyFolder.acl.ownerGroup !== undefined) {\n                        _stateOwnerGroup = keyFolder.acl.ownerGroup;\n                    }\n\n                    if (!differentOwner && _stateOwnerUser !== keyFolder.acl.owner && keyFolder.acl.owner !== undefined) {\n                        _differentOwner = true;\n                    }\n                    if (!differentGroup && _stateOwnerGroup !== keyFolder.acl.ownerGroup && keyFolder.acl.ownerGroup !== undefined) {\n                        _differentGroup = true;\n                    }\n                    if (keyFolder.acl.permissions !== undefined && _valueFileAccessControl !== keyFolder.acl.permissions && !_differentObject.includes(keyFolder.acl.permissions)) {\n                        _differentObject.push(keyFolder.acl.permissions);\n                    }\n                }\n            }\n        });\n\n        const _users = [];\n        const _groups = [];\n        // Get users and groups\n        Object.keys(objects).forEach(_id => {\n            const obj = objects[_id];\n            if (_id.startsWith('system.group.') && obj?.type === 'group') {\n                _groups.push(obj);\n            } else\n            if (_id.startsWith('system.user.') && obj?.type === 'user') {\n                _users.push(obj);\n            }\n        });\n\n        const defaultAcl = objects['system.config'].common.defaultNewAcl;\n\n        _stateOwnerUser = _stateOwnerUser || defaultAcl.owner;\n        _stateOwnerGroup = _stateOwnerGroup || defaultAcl.ownerGroup;\n        _valueFileAccessControl = _valueFileAccessControl || defaultAcl.file;\n        setValueFileAccessControl(_valueFileAccessControl);\n\n        setStateOwnerUser(_stateOwnerUser);\n        setStateOwnerGroup(_stateOwnerGroup);\n\n        setDifferentOwner(_differentOwner);\n        setDifferentGroup(_differentGroup);\n\n        setUsers(_users);\n        setGroups(_groups);\n\n        object.folder && setApplyToChildren(true);\n        setChildrenCount(count);\n\n        setDifferentObject(_differentObject);\n\n        setIds(_ids);\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [objects, selected]);\n\n    useEffect(() => {\n        if (applyToChildren) {\n            if (differentOwner) {\n                stateOwnerUser !== DIFFERENT && setStateOwnerUser(DIFFERENT);\n            }\n\n            if (differentGroup) {\n                stateOwnerGroup !== DIFFERENT && setStateOwnerGroup(DIFFERENT);\n            }\n        } else {\n            if (stateOwnerUser && stateOwnerUser === DIFFERENT) {\n                setStateOwnerUser(objects[selected].acl.owner);\n            }\n            if (stateOwnerGroup && stateOwnerGroup === DIFFERENT) {\n                setStateOwnerGroup(objects[selected].acl.ownerGroup);\n            }\n        }\n        console.log('stateOwnerUser ' +stateOwnerUser)\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [applyToChildren, stateOwnerUser, stateOwnerGroup, differentOwner, differentGroup]);\n\n    if (!ids.length) {\n        return <LinearProgress />;\n    } else {\n        return <CustomModal\n            open={open}\n            titleButtonApply=\"apply\"\n            overflowHidden\n            applyDisabled={disabledButton}\n            progress={progress}\n            onClose={onClose}\n            onApply={() => {\n                setProgress(true);\n                setTimeout(async () => {\n                    const defaultAclFile = objects['system.config'].common?.defaultNewAcl?.file || 0x664;\n\n                    if (!applyToChildren) {\n                        const parts = object.id.split('/');\n                        const adapter = parts.shift();\n                        const path = parts.join('/');\n                        let newAcl = {};\n                        let changed = false;\n                        if (!object.folder) {\n                            if (object.acl?.permissions !== valueFileAccessControl) {\n                                newAcl.permissions = valueFileAccessControl;\n                                changed = true;\n                            }\n                            if (object.acl?.owner !== stateOwnerUser) {\n                                newAcl.owner = stateOwnerUser;\n                                changed = true;\n                            }\n                            if (object.acl?.ownerGroup !== stateOwnerGroup) {\n                                newAcl.ownerGroup = stateOwnerGroup;\n                                changed = true;\n                            }\n                            changed && (await extendObject(adapter, path, newAcl));\n                        } else if (!parts.length && objects[object.id]) {\n                            // setObject(acl)\n                            const obj = objects[object.id];\n                            if (obj.acl?.file !== valueFileAccessControl) {\n                                obj.acl = obj.acl || {};\n                                obj.acl.file = valueFileAccessControl;\n                                changed = true;\n                            }\n                            if (obj.acl?.owner !== stateOwnerUser) {\n                                obj.acl = obj.acl || {};\n                                obj.acl.owner = stateOwnerUser;\n                                changed = true;\n                            }\n                            if (obj.acl?.ownerGroup !== stateOwnerGroup) {\n                                obj.acl = obj.acl || {};\n                                obj.acl.ownerGroup = stateOwnerGroup;\n                                changed = true;\n                            }\n                            changed && (await extendObject(obj._id, obj));\n                        }\n                    }\n                    else {\n                        let _maskObject = ~maskObject & 0xFFFF;\n                        for (let i = 0; i < ids.length; i++) {\n                            const item = ids[i];\n                            let changed = false;\n\n                            if (item._id) {\n                                // it is object\n                                const permissions = newValueAccessControl(item.acl?.file || defaultAclFile, valueFileAccessControl, _maskObject);\n                                if (permissions !== item.acl?.file) {\n                                    item.acl = item.acl || {};\n                                    item.acl.file = permissions;\n                                    changed = true;\n                                }\n                                if (stateOwnerUser !== DIFFERENT && stateOwnerUser !== item.acl?.owner) {\n                                    item.acl = item.acl || {};\n                                    item.acl.owner = stateOwnerUser;\n                                    changed = true;\n                                }\n                                if (stateOwnerGroup !== DIFFERENT && stateOwnerGroup !== item.acl?.ownerGroup) {\n                                    item.acl = item.acl || {};\n                                    item.acl.ownerGroup = stateOwnerGroup;\n                                    changed = true;\n                                }\n                                changed && (await extendObject(item._id, item));\n                            } else {\n                                if (item && !item.folder) {\n                                    const newAcl = {};\n                                    const permissions = newValueAccessControl(item.acl?.permissions || defaultAclFile, valueFileAccessControl, _maskObject);\n                                    if (permissions !== item.acl?.permissions) {\n                                        newAcl.permissions = permissions;\n                                        changed = true;\n                                    }\n                                    if (stateOwnerUser !== DIFFERENT && stateOwnerUser !== item.acl?.owner) {\n                                        newAcl.owner = stateOwnerUser;\n                                        changed = true;\n                                    }\n                                    if (stateOwnerGroup.value !== DIFFERENT && stateOwnerGroup !== item.acl?.ownerGroup) {\n                                        newAcl.ownerGroup = stateOwnerGroup;\n                                        changed = true;\n                                    }\n                                    if (changed) {\n                                        const parts = item.id.split('/');\n                                        const adapter = parts.shift();\n                                        const path = parts.join('/');\n                                        changed && (await extendObject(adapter, path, newAcl));\n                                    }\n                                }\n                            }\n                        }\n                    }\n\n                    setProgress(false);\n                    onApply();\n                }, 200);\n            }}\n        >\n            <div style={{ display: 'flex', flexDirection: 'column' }}>\n                <div style={{\n                    margin: 10,\n                    fontSize: 20\n                }}>{t('Access control list: %s', selected)}</div>\n\n                <div style={{ display: 'flex' }}>\n                    <SelectWithIcon\n                        fullWidth\n                        style={{ marginRight: 10 }}\n                        label={t('Owner user')}\n                        lang={lang}\n                        list={users}\n                        t={t}\n                        disabled={progress}\n                        value={stateOwnerUser}\n                        themeType={themeType}\n                        different={differentOwner ? DIFFERENT : false}\n                        onChange={val => {\n                            setDifferentOwner(false);\n                            setStateOwnerUser(val);\n                            setDisabledButton(false);\n                        }}\n                    />\n                    <SelectWithIcon\n                        fullWidth\n                        label={t('Owner group')}\n                        lang={lang}\n                        list={groups}\n                        t={t}\n                        disabled={progress}\n                        value={stateOwnerGroup}\n                        themeType={themeType}\n                        different={differentGroup ? DIFFERENT : false}\n                        onChange={val => {\n                            setDifferentGroup(false);\n                            setStateOwnerGroup(val);\n                            setDisabledButton(false);\n                        }}\n                    />\n                </div>\n\n                <div style={{\n                    display: 'flex',\n                    margin: 10,\n                    alignItems: 'center',\n                    fontSize: 10,\n                    marginLeft: 0,\n                    color: 'silver'\n                }}>\n                    <div style={(!object.folder || !applyToChildren) ? { color: 'green' } : null}>{t('to apply one item')}</div>\n                    <Switch\n                        disabled={ids.length === 1 || progress}\n                        checked={(!objects[object.id] && !!object.folder) || applyToChildren}\n                        onChange={e => {\n                            setApplyToChildren(e.target.checked);\n                            setDisabledButton(false);\n                        }}\n                        color=\"primary\"\n                    />\n                    <div style={(object.folder || applyToChildren) ? { color: 'green' } : null}>{t('to apply with children')} {(object.folder || childrenCount > 1) ? `(${childrenCount} ${t('object(s)')})` : ''}</div>\n                </div>\n\n                {progress && <LinearProgress/>}\n\n                <div style={{ overflowY: 'auto' }}>\n                    <div>\n                        <h2>{t('File rights')}</h2>\n                        <ObjectRights\n                            disabled={progress}\n                            mask={maskObject}\n                            setMask={setMaskObject}\n                            applyToChildren={applyToChildren}\n                            differentValues={differentObject}\n                            t={t}\n                            setValue={e => {\n                                setValueFileAccessControl(e);\n                                setDisabledButton(false);\n                            }}\n                            value={valueFileAccessControl} />\n                    </div>\n                </div>\n            </div>\n        </CustomModal>;\n    }\n}\n\nexport default FileEditOfAccessControl2;","import { Component } from 'react';\n\nimport PropTypes from 'prop-types';\nimport LinearProgress from '@material-ui/core/LinearProgress';\n\nimport FileBrowser from '../components/FileBrowser';\n\nimport TabContainer from '../components/TabContainer';\nimport TabContent from '../components/TabContent';\nimport FileEditOfAccessControl from '../dialogs/FileEditOfAccessControl';\n\nclass Files extends Component {\n    constructor(props) {\n        super(props);\n        this.t = this.translate;\n        this.wordCache = {};\n        this.objects = {};\n    }\n\n    componentDidMount() {\n        this.props.socket.getObjects(true, true)\n            .then(objects =>\n                this.objects = objects)\n    }\n\n    translate = (word, arg1, arg2) => {\n        if (arg1 !== undefined) {\n            return this.props.t(word, arg1, arg2);\n        }\n\n        if (!this.wordCache[word]) {\n            this.wordCache[word] = this.props.t(word);\n        }\n\n        return this.wordCache[word];\n    }\n\n    render() {\n        if (!this.props.ready) {\n            return <LinearProgress />;\n        }\n\n        return <TabContainer>\n            <TabContent overflow=\"auto\">\n                <FileBrowser\n                    showViewTypeButton={true}\n                    ready={this.props.ready}\n                    socket={this.props.socket}\n                    themeName={this.props.themeName}\n                    lang={this.props.lang}\n                    t={this.props.t}\n                    showToolbar={true}\n                    allowUpload={true}\n                    allowView={true}\n                    allowDownload={true}\n                    allowCreateFolder={true}\n                    allowDelete={true}\n                    expertMode={this.props.expertMode}\n                    modalEditOfAccessControl={(context, objData) =>\n                        <FileEditOfAccessControl\n                            open={context.state.modalEditOfAccess}\n                            themeType={this.props.themeType}\n                            extendObject={async (adapter, file, data) => {\n                                let promise;\n                                if (file && typeof file === 'object') {\n                                    const obj = file;\n                                    // it is setObject\n                                    promise = this.props.socket.getObject(obj._id)\n                                        .then(oldObj => {\n                                            oldObj.acl = obj.acl;\n                                            return this.props.socket.setObject(oldObj._id, oldObj)\n                                                .then(() => oldObj);\n                                        });\n                                } else if (file) {\n                                    if ((data.owner || data.ownerGroup) && data.permissions) {\n                                        promise = this.props.socket.chownFile(adapter, file, {owner: data.owner, ownerGroup: data.ownerGroup})\n                                            .then(() => this.props.socket.chmodFile(adapter, file, {mode: data.permissions}));\n                                    } else\n                                    if (data.permissions) {\n                                        promise = this.props.socket.chmodFile(adapter, file, {mode: data.permissions});\n                                    } else if (data.owner || data.ownerGroup) {\n                                        promise = this.props.socket.chownFile(adapter, file, {owner: data.owner, ownerGroup: data.ownerGroup});\n                                    }\n                                }\n\n                                if (promise) {\n                                    const result = await promise;\n                                    if (result.entries) {\n                                        if (result?.entries) {\n                                            for ( let i = 0; i < result?.entries.length; i++) {\n                                                await context.updateItemsAcl([{id: adapter + '/' + (result.entries[i].path ? result.entries[i].path + '/' : '') + result.entries[i].file, acl: result.entries[i].acl}]);\n                                            }\n                                        }\n                                    } else if (result) {\n                                        await context.updateItemsAcl([{id: result._id, acl: result.acl}]);\n                                    }\n                                }\n                            }}\n                            selected={context.state.selected}\n                            folders={context.state.folders}\n                            objects={this.objects}\n                            socket={this.props.socket}\n                            t={this.t}\n                            onClose={() => context.setState({ modalEditOfAccess: false, modalEditOfAccessObjData: null })}\n                            onApply={() => context.setState({ modalEditOfAccess: false, modalEditOfAccessObjData: null })} />\n                    }\n                />\n            </TabContent>\n        </TabContainer>;\n    }\n}\n\nFiles.propTypes = {\n    t: PropTypes.func,\n    lang: PropTypes.string,\n    socket: PropTypes.object,\n    ready: PropTypes.bool,\n    expertMode: PropTypes.bool,\n    themeType: PropTypes.string,\n};\n\nexport default Files;"],"sourceRoot":""}